<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <title>行列ゲーム</title>
  <style type="text/css">code{white-space: pre;}</style>
  <link rel="stylesheet" href="../resources/css/c.css">
  <link rel="stylesheet" href="resources/index.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<h1 style="font-size:1em; position:absolute; left:0; top:-0.8em; font-size:2.0em !important">
    <a href='index.html'>
    <img src="../resources/img/identicon.png" style="position:relative; top:0.4em; width:1.3em;border-radius:0.8em;" /> aiura/
    </a>
</h1>
<header>
<h1 class="title">行列ゲーム</h1>
</header>
<p class="date" style="text-align: right">
2017-06-17 (Sat.)
</p>
<div class="tags" style="text-align: right">
<p><a class=tag href=index.html#数学>数学</a> <a class=tag href=index.html#ゲーム理論>ゲーム理論</a></p>
</div>
<h2 id="index">index</h2>
<div id="toc">

</div>
<h2 id="行列ゲームとは何か">行列ゲームとは何か</h2>
<p>ここでは次のようなゲームを考える.</p>
<ol style="list-style-type: decimal">
<li>プレイヤーは2人</li>
<li>プレイヤー <span class="math inline">\(1,2\)</span> に対し、戦略の選択肢の集合 <span class="math inline">\(I, J\)</span> がある
<ul>
<li><span class="math inline">\(I, J\)</span> は 有限集合 - <span class="math inline">\(I = \{ 1,2, \ldots, |I| \}\)</span>, <span class="math inline">\(J = \{ 1,2, \ldots, |J| \}\)</span> とする</li>
</ul></li>
<li>プレイヤー <span class="math inline">\(k\)</span> に対し <strong>利得関数</strong> <span class="math inline">\(f_k\)</span> がある
<ul>
<li><span class="math inline">\(f_1 : I \times J \to \mathbb{R}\)</span></li>
<li><span class="math inline">\(f_2 : I \times J \to \mathbb{R}\)</span></li>
<li>これを評価関数や損失関数と呼んだりする</li>
</ul></li>
<li>プレイヤー <span class="math inline">\(1\)</span> は <span class="math inline">\(\max f_1(i, j)\)</span> を目指して戦略 <span class="math inline">\(i (\in I)\)</span> を選び、プレイヤー <span class="math inline">\(2\)</span> は同様に <span class="math inline">\(\max f_2(i, j)\)</span> を目指して戦略 <span class="math inline">\(j\)</span> を選ぶ</li>
<li>互いのプレイヤーは相手のプレイヤーの戦略を知ることはできない</li>
</ol>
<p>特に最後のルールが特別で、同時に (唯一つの) 手を見せ合ってポイントを分け合うようなゲームを考えている.</p>
<h2 id="ゼロ和ゲームとは何か">ゼロ和ゲームとは何か</h2>
<p>互いの利得関数の和が常にゼロであるようなゲーム: <span class="math display">\[\forall i, j .~ f_1(i, j) + f_2(i, j) = 0\]</span> のことを <strong>ゼロ和ゲーム</strong> という. 後述するが (実は) ゼロでなく定数であっても本質は変わらない (戦略的同値) ので、そういう場合もゼロ和ゲームという.</p>
<p>とりあえずは利得の和がゼロになるようなゼロ和ゲームだけのことを考える.</p>
<p><span class="math inline">\(a_{ij} = f_1(i, j) = - f_2(i, j)\)</span> とすると、行列 <span class="math inline">\((a_{ij})\)</span> が描けて、これを利得行列という. プレイヤー <span class="math inline">\(1, 2\)</span> はそれぞれ、</p>
<ul>
<li>プレイヤー <span class="math inline">\(1\)</span>: <span class="math inline">\(\max_i a_{ij}\)</span></li>
<li>プレイヤー <span class="math inline">\(2\)</span>: <span class="math inline">\(\min_j a_{ij}\)</span></li>
</ul>
<p>を目指す.</p>
<p>単に行列ゲームという時、ゼロ和ゲームのことを指し、利得行列 <span class="math inline">\(A=(a_{ij})\)</span> のことを言う.</p>
<h2 id="純粋戦略">純粋戦略</h2>
<p>互いに相手の手は分からないが、お互い最善を尽くして戦略を考えることを仮定して戦略を考える. 適当な考えの下で、唯一つの戦略を選択することを <strong>純粋戦略</strong> と言う. (実際にプレイできる戦略はただ一つなのだから唯一つの戦略を選択するのは当たり前に思える.)</p>
<h3 id="純粋戦略のミニマックス原理">純粋戦略のミニマックス原理</h3>
<p>ゼロ和ゲームの純粋戦略を考える. ゼロ和では相手の最善は自分の最悪であるので、相手は自分にとって常に悪い手を取ると考えたほうが良い. 具体的には、相手が自分にとって最悪の手を取ったとしても最もマシな利得が得られるような戦略を考える.</p>
<p>例えば次のような利得行列について <span class="math display">\[A = \left(\begin{array}{ccc}
1 &amp; 1 &amp; -1 \\
2 &amp; -2 &amp; 0 \\
1 &amp; 1 &amp; -2 \\
\end{array}\right)\]</span> プレイヤー <span class="math inline">\(1\)</span> が 1 を選ぶとき、第<span class="math inline">\(1\)</span>行ベクトル <span class="math display">\[a_{1\cdot} = \left(\begin{array}{ccc}
1 &amp; 1 &amp; -1 \\
\end{array}\right)\]</span> が選ばれる. プレイヤー <span class="math inline">\(1\)</span> にとっての最悪の事態とはこの中の最小が選ばれることで、すなわち プレイヤーが <span class="math inline">\(3\)</span> を選ぶことによって利得 <span class="math display">\[a_{13} = -1\]</span> が得られることである.</p>
<p>同様に、<span class="math inline">\(2\)</span> を選んだ場合は <span class="math display">\[a_{22}=-2\]</span> が最悪. <span class="math inline">\(3\)</span> を選んだ場合は <span class="math display">\[a_{33}-2\]</span> が最悪.</p>
<p>というわけで <span class="math inline">\(1\)</span> を選んでいれば、最低でも <span class="math inline">\(-1\)</span> の利得が得られることが分かるので、最もマシな純粋戦略は <span class="math inline">\(1\)</span> だということが分かる.</p>
<p>以上のようにプレイヤー <span class="math inline">\(1\)</span> の指針は <span class="math display">\[\max_i \min_j a_{ij}\]</span> によって <span class="math inline">\(i\)</span> を選ぶこと.</p>
<p>逆も同様で、プレイヤー <span class="math inline">\(2\)</span> の指針は <span class="math display">\[\min_j \max_i a_{ij}\]</span> によって <span class="math inline">\(j\)</span> を選ぶこと.</p>
<div class="thm">
<h4 id="定義">定義</h4>
<p>利得行列 <span class="math inline">\((a_{ij})\)</span> について <span class="math display">\[\max_i \min_j a_{ij} = \min_j \max_i a_{ij} ~~(=v)\]</span> が成立するとき、このゲームは厳密に決定されるといい、これが成立する <span class="math inline">\(i, j\)</span> を <span class="math inline">\(i^*, j^*\)</span> と書いて、<span class="math inline">\((i^*, j^*)\)</span> を <strong>均衡点</strong> という. 均衡点が存在するときに <span class="math inline">\(v\)</span> を <strong>ゲームの値</strong> という.</p>
</div>
<div class="thm">
<h4 id="定理">定理</h4>
<p>実行列 <span class="math inline">\((a_{ij})\)</span> について <span class="math display">\[\max_i \min_j a_{ij} \leq \min_j \max_i a_{ij}\]</span> が常に成り立つ.</p>
<h4 id="証明">証明</h4>
<p><span class="math inline">\(v_1 = \max_i \min_j a_{ij}\)</span> とおく. この値は行列 <span class="math inline">\((a_{ij})\)</span> の各行ベクトルの最小値の最大値. すなわち、ある第 <span class="math inline">\(i\)</span> 行目において、成分の値は全て <span class="math inline">\(v_1\)</span> 以上. これがあるので、各列ベクトルにおける最大値は <span class="math inline">\(v_1\)</span> 以上. 列ベクトルの最大値の最小値も <span class="math inline">\(v_1\)</span> 以上. それはまさに <span class="math inline">\(v_2 = \min_j \max_i a_{ij}\)</span> のことである. というわけで <span class="math inline">\(v_1 \leq v_2\)</span> が成立する.</p>
</div>
<p>ゲームが厳密に定まらないような行列ゲームはいくらでもある. 厳密に定まるかどうかを判定するための定理がある.</p>
<div class="thm">
<h4 id="定理-鞍点定理">定理 (鞍点定理)</h4>
<p>利得行列に鞍点があることが厳密に定まることの必要十分条件.</p>
<p>ここで鞍点とはある <span class="math inline">\((i^*, j^*)\)</span> のことで, <span class="math display">\[\forall i, j .~ a_{i j^*} \leq a_{i^* j^*} \leq a_{i^* j}\]</span> が成立する点のこと. 鞍点があるとき、明らかにその鞍点自体が均衡点となる.</p>
<p>証明は地道に確かめるだけなので略.</p>
</div>
<div class="thm">
<h4 id="定理-1">定理</h4>
<p>鞍点として <span class="math inline">\((i_1, j_1)\)</span> と <span class="math inline">\((i_2, j_2)\)</span> とがあるとき、 <span class="math inline">\((i_1, j_2)\)</span> と <span class="math inline">\((i_2, j_1)\)</span> もまた鞍点である.</p>
</div>
<p>さてゲームが厳密に定まらない、すなわち鞍点が存在しない例としてじゃんけんがある. <span class="math display">\[A = \left(\begin{array}{ccc}
0 &amp; 1 &amp; -1 \\
-1 &amp; 0 &amp; 1 \\
1 &amp; -1 &amp; 0
\end{array}\right)\]</span></p>
<p>マックスミニ値 <span class="math inline">\((v_1 = \max_i \min_j a_{ij})\)</span> は <span class="math inline">\(-1\)</span> でミニマックス値 <span class="math inline">\((v_2 = \min_j \max_i a_{ij})\)</span> は <span class="math inline">\(1\)</span> である. もちろん鞍点も存在しない.</p>
<p>これが純粋戦略の限界.</p>
<h2 id="混合戦略">混合戦略</h2>
<p>純粋戦略がまずかったのは確定的に唯一つの戦略を選ぼうとしたことだった. 次は複数の戦略を混ぜることを考える. すなわち、戦略集合の上の確率分布を戦略だと考えこれを <strong>混合戦略</strong> と呼ぶ.</p>
<p>戦略集合 <span class="math inline">\(I\)</span> に対して</p>
<ul>
<li><span class="math inline">\(p = ( p_i : i \in I, p_i &gt; 0 )\)</span></li>
<li><span class="math inline">\(\sum_i p_i = 1\)</span></li>
</ul>
<p>このような行ベクトル <span class="math inline">\(p\)</span> が混合戦略.</p>
<p>実際に戦略を選択する場合に、<span class="math inline">\(p\)</span> に従って <span class="math inline">\(i \in I\)</span> を選択してプレイする. 何度も繰り返しプレイする場合は明らかにこの混合戦略の考え方が有効そうだが、ただ一回きりのプレイにおいても (あなたが期待値というものを信用するのなら) 有効な考え方である. また純粋戦略は混合戦略の特別な場合 (ある <span class="math inline">\(i\)</span> についてのみ <span class="math inline">\(p_i=1\)</span> なる混合戦略) だと言える.</p>
<p>利得行列 <span class="math inline">\((a_{ij})\)</span> の代わりにその期待値、 <strong>期待利得</strong> <span class="math inline">\(E\)</span> というものを考えるべきである. プレイヤー <span class="math inline">\(1, 2\)</span> が混合戦略 <span class="math inline">\(p, q\)</span> を取る場合の期待利得は <span class="math display">\[E(p, q) = \sum_i \sum_j p_i q_i a_{ij}\]</span> と計算できる.</p>
<p>ところで <span class="math inline">\(p, q\)</span> を行ベクトルとして定義してるのでこれは <span class="math display">\[E(p, q) = p A q^T\]</span> とも書ける (<span class="math inline">\(A = (a_{ij})\)</span>).</p>
<p>略記法として、<span class="math inline">\(E\)</span> の引数に <span class="math inline">\(I, J\)</span> を渡すことを許して <span class="math display">\[E : I \times \mathcal{Q} \to \mathbb{R}\]</span> <span class="math display">\[E(i, q) = \sum_j q_j a_{ij}\]</span> <span class="math display">\[E : \mathcal{P} \times J \to \mathbb{R}\]</span> <span class="math display">\[E(p, j) = \sum_i p_i a_{ij}\]</span> も定義する. <span class="math inline">\(E(p, q) = \sum_i p_i E(i, q) = \sum_j q_j E(p, j)\)</span> である.</p>
<h3 id="混合戦略のミニマックス原理">混合戦略のミニマックス原理</h3>
<p>純粋戦略の時と同様にミニマックス原理を混合戦略に当てはめる. すなわち、 プレイヤー <span class="math inline">\(1\)</span> は <span class="math display">\[v_1 = \max_p \min_q E(p, q)\]</span> を指標にし、プレイヤー <span class="math inline">\(2\)</span> は <span class="math display">\[v_2 = \min_q \max_p E(p, q)\]</span> を指標にする. また同様に <span class="math display">\[\max_p \min_q E(p, q) = \min_q \max_p E(p, q) ~~(=v)\]</span> のとき、<span class="math inline">\(v\)</span> をゲームの値といい、そのときの <span class="math inline">\((p, q)\)</span> を <span class="math inline">\((p^*, q^*)\)</span> と書いて最適戦略と呼ぶ. これら <span class="math inline">\(((p^*, q^*), v)\)</span> をまとめてゲームの解などという.</p>
<p>純粋戦略のときに成立する性質がほぼほぼ成り立つことを見ていく.</p>
<div class="thm">
<h4 id="補題">補題</h4>
<p><span class="math inline">\(E(p,q) = pAq^T\)</span> について <span class="math display">\[\max_p \min_q E(p, q) \leq \min_q \max_p E(p, q)\]</span></p>
<p>純粋戦略のときと全く同様.</p>
<h4 id="定理-混合戦略の鞍点定理">定理 (混合戦略の鞍点定理)</h4>
<p>最適戦略が <span class="math inline">\((p^*, q^*)\)</span> であることは次と同値. <span class="math display">\[\forall p, q .~ E(p, q^*) \leq E(p^*, q^*) \leq E(p^*, q)\]</span></p>
<h4 id="証明-1">証明</h4>
<p>純粋戦略のときは鞍点の存在として紹介した.</p>
<p><span class="math inline">\((\Rightarrow)\)</span> <span class="math inline">\((p^*, q^*)\)</span> が最適戦略だとする.<br />
仮に <span class="math inline">\(E(p, q^*) &gt; E(p^*, q^*)\)</span> とすると <span class="math inline">\(E(p^*, q^*) = \max_p \min_q E(p, q)\)</span> に矛盾し、<span class="math inline">\(p^*\)</span> の代わりに <span class="math inline">\(p\)</span> を使ったほうがより最適になる. 従って、 <span class="math inline">\(E(p, q^*) \leq E(p^*, q^*)\)</span>. <span class="math inline">\(q\)</span> についても同様.</p>
<p><span class="math inline">\((\Leftarrow)\)</span> <span class="math inline">\(E(p, q^*) \leq E(p^*, q^*)\)</span> とは <span class="math display">\[\max_p E(p, q^*) = E(p^*, q^*)\]</span> ということ. そして一般に <span class="math display">\[\min_q \max_p E(p, q) \leq \max_p E(p, q^*)\]</span> は成立するので、<span class="math inline">\(q\)</span> についても同様に考えると <span class="math display">\[\min_q \max_p E(p, q) \leq (E(p^*, q^*) \leq) \max_p \min_q E(p, q)\]</span> が得られる.</p>
<p>先の補題と組み合わせると <span class="math display">\[\min_q \max_p E(p, q) = (E(p^*, q^*) =) \max_p \min_q E(p, q)\]</span> を得る.</p>
</div>
<div class="thm">
<h4 id="定理-2">定理</h4>
<p>最適戦略として <span class="math inline">\((p_1, q_1)\)</span> と <span class="math inline">\((p_2, q_2)\)</span> とがあるとき、 <span class="math inline">\((p_1, q_2)\)</span> と <span class="math inline">\((p_2, q_1)\)</span> もまた最適戦略である.</p>
</div>
<p>混合戦略の場合、確率分布どうしの鞍点みたいなものを探す必要がありそうだが、次の定理によって、もう少し探索範囲が小さくできる.</p>
<div class="thm">
<h4 id="定理-3">定理</h4>
<p>ゲームの解が <span class="math inline">\(((p^*, q^*), v)\)</span> であることは次と同値. <span class="math display">\[\forall i, j .~ E(i, q^*) \leq v \leq E(p^*, j)\]</span></p>
<p>すなわち、混合戦略 vs 純粋戦略での利得だけを考慮すればよい.</p>
<h4 id="証明-2">証明</h4>
<p>先ほどの定理から <span class="math display">\[\forall p, q .~ E(p, q^*) \leq v \leq E(p^*, q)\]</span> と同値であることは言える.</p>
<p><span class="math inline">\(\max_i E(i, q^*)\)</span> を考えた時、そのような <span class="math inline">\(i\)</span> が <span class="math inline">\(i_0\)</span> とすると、 <span class="math inline">\(\max_p E(p, q^*) = E(i_0, q^*)\)</span> である (すなわち <span class="math inline">\(p_{i_0} = 1\)</span>).</p>
<blockquote>
<p>なぜなら <span class="math inline">\(p_{i_0} &lt; 1\)</span> とする <span class="math inline">\(p&#39;\)</span> を用いると、 <span class="math display">\[\begin{align*}
E(i_0, q^*) - E(p&#39;, q^*)
&amp; = E(i_0, q^*) - \sum_i p&#39;_i E(i, q^*) \\
&amp; \geq E(i_0, q^*) - \sum_i p&#39;_i E(i_0, q^*) \\
&amp; = E(i_0, q^*) - E(i_0, q^*) \\
&amp; = 0
\end{align*}\]</span> だから <span class="math inline">\(E(i_0, q^*) \geq E(p&#39;, q^*)\)</span> を得る. 当たり前.</p>
</blockquote>
<p>つまり <span class="math inline">\(\max_p E(p, q^*) = \max_i E(i, q^*)\)</span> である.</p>
<p>というわけで、 <span class="math inline">\(\forall p. E(p, q^*) \leq v\)</span> は <span class="math inline">\(\forall i. E(i, q^*) \leq v\)</span> と言い換えても構わない.</p>
<p>どういうに <span class="math inline">\(q\)</span> も <span class="math inline">\(j\)</span> で言い換えられる.</p>
<h4 id="定理-4">定理</h4>
<p>ゲームの解が <span class="math inline">\(((p^*, q^*), v)\)</span> であるとき、 <span class="math display">\[\max_i E(i, q^*) = v = \min_j E(p^*, j)\]</span></p>
</div>
<p>で、重要な次の定理がある.</p>
<div class="thm">
<h4 id="ミニマックス定理">ミニマックス定理</h4>
<p>任意の行列ゲームに対して必ず解が存在する.</p>
<p>つまり実行列 <span class="math inline">\(A\)</span> に対して <span class="math display">\[\max_p \min_q pAq^T = \min_q \max_p pAq^T\]</span> が常に成立する.</p>
<h4 id="証明-3">証明</h4>
<p>後でより一般的な場合 (双行列ゲーム) で示す.</p>
</div>
<h3 id="対称行列">対称行列</h3>
<p>利得行列が歪対称行列になっている、すなわち <span class="math display">\[A = -A^T\]</span> となるような行列ゲームを <strong>対称行列</strong> という. 歪対称行列の特性として正方行列であること. 従って2人のプレイヤーの取れる戦略は同じ集合だと見なせる. また対角成分はゼロである. 例えばじゃんけんが対称ゲームの例である.</p>
<div class="thm">
<h4 id="定理-5">定理</h4>
<p>対称ゲームのゲームの値はゼロである.</p>
<h4 id="証明-4">証明</h4>
<p>ミニマックス定理からゲームの解 <span class="math inline">\(((p^*, q^*), v)\)</span> の存在は保証されている.</p>
<p>これが解であることと同値な条件は前述した鞍点定理から、任意の <span class="math inline">\(p, q\)</span> について <span class="math display">\[pAq^{*T} \leq p^*Aq^{*T} \leq p^*Aq^T\]</span> が成立することであった.</p>
<p>これの各項の転置を取って <span class="math display">\[q^*A^Tp^{*T} \leq q^* A^T p^{*T} \leq q A^T p^{*T}\]</span></p>
<p><span class="math inline">\(A^T=-A\)</span> を代入して <span class="math display">\[q^*Ap^{*T} \geq q^* A p^{*T} \geq q A p^{*T}\]</span></p>
<p>鞍点定理より、<span class="math inline">\((q^*, p^*)\)</span> もまた最適戦略であることが示された. 即ち、プレイヤー <span class="math inline">\(1\)</span> にとっての最適戦略はプレイヤー <span class="math inline">\(2\)</span> にとってもそのまま最適戦略となっており、逆も然りであることが分かる. 各プレイヤーの最適戦略の集合というものを考えた時、対称ゲームにおいてそれらは一致する.</p>
<p>というわけで、ゲームの値は <span class="math display">\[v = p^* A q ^{*T} = q^* A p^{*T}\]</span> となる. 最後のを転置すると <span class="math display">\[v (= v^T) = (q^* A p^{*T})^T = p^* A^T q^{*T} = - p^* A q^{*T} = - v\]</span> 従って <span class="math display">\[v=0\]</span> を得る.</p>
</div>
<h2 id="双行列ゲーム-非ゼロ和ゲーム">双行列ゲーム (非ゼロ和ゲーム)</h2>
<p>プレイヤー2人の利得の和がゼロ (或いは、定数) とは限らないゲームを考える. 2種類の利得を管理する必要があるので行列は2つ必要である. 従って双行列で管理する.</p>
<ul>
<li>プレイヤー <span class="math inline">\(1\)</span> の利得: <span class="math inline">\(f_1(i, j)\)</span></li>
<li>プレイヤー <span class="math inline">\(2\)</span> の利得: <span class="math inline">\(f_2(i, j)\)</span></li>
</ul>
<p>に対して、</p>
<ul>
<li><span class="math inline">\(n \times m\)</span> 行列 <span class="math inline">\(A = (a_{ij} = f_1(i, j))\)</span></li>
<li><span class="math inline">\(n \times m\)</span> 行列 <span class="math inline">\(B = (b_{ij} = f_2(i, j))\)</span></li>
</ul>
<p>ゼロ和ゲームでは <span class="math inline">\(B = -A\)</span> という関係があったので単に <span class="math inline">\(A\)</span> だけを持っていれば良かったが今は2つを持っておく. 2つの行列のタプル、または成分を2つの成分のタプルにした行列を双行列という. <span class="math display">\[(A, B) = \left( (a_{ij}, b_{ij}) \right)\]</span></p>
<p>これによって表現される2人非ゼロ和ゲームを <strong>双行列ゲーム (bimatrix game)</strong> という. 初めに説明した行列ゲームの1つだとして、同様に</p>
<ol style="list-style-type: decimal">
<li>プレイヤー <span class="math inline">\(1\)</span> は <span class="math inline">\(\max f_1(i, j)\)</span> を目指して戦略 <span class="math inline">\(i\)</span> を選び、プレイヤー <span class="math inline">\(2\)</span> は同様に <span class="math inline">\(\max f_2(i, j)\)</span> を目指して戦略 <span class="math inline">\(j\)</span> を選ぶ</li>
<li>互いのプレイヤーは相手のプレイヤーの戦略を知ることはできない</li>
</ol>
<p>これらを仮定する. またプレイ (各々が戦略を選ぶ行為) は一回きりのものとする.</p>
<h3 id="例.-囚人のジレンマ">例. 囚人のジレンマ</h3>
<p>囚人のジレンマ <a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a> は双行列ゲームの典型例. 参考文献の Wikipedia では懲役年数が行列になっているが今は最大化を目標にしたいので、これのマイナスを利得だと思えば良い. <span class="math display">\[(A, B) = \left[\begin{array}{cc}
(-2, -2) &amp; (-10, 0) \\
(0, -10) &amp; (-5, -5)
\end{array}\right]\]</span></p>
<p>ジレンマの囚人のストーリーではこの一列一行目のことを「協力」、二列二行目のことを「裏切り」などとして説明されている.</p>
<p>ところで囚人のジレンマは <span class="math inline">\((2,2)\)</span> 成分 (二人共裏切り) に落ち着くしか無い. なぜなら、相手がどちらの戦略を選択するにしても、自分は裏切りを選択したほうが利得が上がるからである (<span class="math inline">\(-2 \mapsto 0; -10 \mapsto -5\)</span>).</p>
<h2 id="ナッシュ均衡-非協力均衡点">ナッシュ均衡 (非協力均衡点)</h2>
<p>基本的には今まで言ってた均衡点と同じ概念.</p>
<p><span class="math inline">\(f_1, f_2\)</span> の引数に混合戦略を渡すことを許して期待利得を表現する.</p>
<p>2人の混合戦略の集合 <span class="math inline">\(\mathcal{P}, \mathcal{Q}\)</span> のある点 <span class="math inline">\((p^*, q^*)\)</span> が <strong>ナッシュ均衡</strong> であるとは</p>
<ul>
<li><span class="math inline">\(f_1(p^*, q^*) = \max_p f_1(p, q^*)\)</span></li>
<li><span class="math inline">\(f_2(p^*, q^*) = \max_q f_2(p^*, q)\)</span></li>
</ul>
<p>を満たすこと. また <span class="math inline">\(v = (f_1(p^*, q^*), f_2(p^*, q^*))\)</span> を <strong>均衡利得</strong> という.</p>
<h3 id="最適反応">最適反応</h3>
<p>今考えるゲームは相手の手を知らずに自分の手を決めているが、仮に、相手の戦略を知ってから自分の最適な戦略を考えるとする.</p>
<p>プレイヤー <span class="math inline">\(1\)</span> の <strong>最適反応</strong> とはプレイヤー <span class="math inline">\(2\)</span> が用いる混合戦略 <span class="math inline">\(q\)</span> に対する最適戦略の集合のことで <span class="math inline">\(R_1(q)\)</span> と書く. 同様にプレイヤー <span class="math inline">\(2\)</span> の最適反応はプレイヤー <span class="math inline">\(1\)</span> の混合戦略 <span class="math inline">\(p\)</span> に対して <span class="math inline">\(R_2(p)\)</span> と書く.</p>
<p>具体的な定義は大体分かるでしょうけど</p>
<ul>
<li><span class="math inline">\(R_1(q) = \{ p : f_1(p, q) = \max_p f_1(p, q) \}\)</span></li>
<li><span class="math inline">\(R_2(p) = \{ q : f_2(p, q) = \max_q f_2(p, q) \}\)</span></li>
</ul>
<p>明らかにナッシュ均衡 <span class="math inline">\((p^*, q^*)\)</span> について</p>
<ul>
<li><span class="math inline">\(p^* \in R_1(q^*)\)</span></li>
<li><span class="math inline">\(q^* \in R_2(p^*)\)</span></li>
</ul>
<p>ということ.</p>
<div class="thm">
<h4 id="定理-6">定理</h4>
<p><span class="math inline">\((p^*, q^*)\)</span> がナッシュ均衡であることと、 写像 <span class="math inline">\(T(p, q) = (R_1(q), R_2(p))\)</span> の不動点であることは同値.</p>
<p>最適反応の定義から明らか.</p>
<p>また次のように言い換えることも出来る.</p>
<h4 id="定理-7">定理</h4>
<p>ナッシュ均衡の集合 <span class="math inline">\(D=\{(p^*, q^*)\}\)</span> 及び最適反応の集合</p>
<ul>
<li><span class="math inline">\(D_1 = \{(p, q) : p \in R_1(q), q \in \mathcal{Q}\}\)</span></li>
<li><span class="math inline">\(D_2 = \{(p, q) : q \in R_2(p), p \in \mathcal{P}\}\)</span></li>
</ul>
<p>を用いて <span class="math display">\[D = D_1 \cap D_2\]</span> が言える.</p>
</div>
<p>ここらへんの定理を用いて、頑張ってナッシュ均衡が求められる.</p>
<p>行列ゲームのときと同様の言い方も出来る.</p>
<div class="thm">
<h4 id="補題-双行列ゲームの鞍点定理">補題 (双行列ゲームの鞍点定理)</h4>
<p>双行列ゲームについて <span class="math inline">\((p^*, q^*)\)</span> がナッシュ均衡であることは次の同値.</p>
<p>任意の <span class="math inline">\(p, q\)</span> に対して <span class="math display">\[f_1(p^*, q^*) \geq f_1(p, q^*)\]</span> <span class="math display">\[f_2(p^*, q^*) \geq f_2(p^*, q)\]</span></p>
<p><span class="math inline">\(B=-A\)</span> を代入して以前の鞍点定理が出てくる.</p>
<h4 id="定理-8">定理</h4>
<p>前回も混合戦略と純粋戦略を比較すればよかったように、今回もそれが成り立つ.</p>
<p>双行列ゲーム <span class="math inline">\((A, B)\)</span> について <span class="math inline">\((p^*, q^*)\)</span> がナッシュ均衡であることは次の同値.</p>
<p>任意の <span class="math inline">\(p, q\)</span> に対して <span class="math display">\[\forall i .~ f_1(p^*, q^*) \geq f_1(i, q^*)\]</span> <span class="math display">\[\forall j .~ f_2(p^*, q^*) \geq f_2(p^*, j)\]</span></p>
</div>
<div class="thm">
<h4 id="定理-9">定理</h4>
<p>双行列ゲームは均衡点を1つ以上持つ.</p>
<p>もちろんゼロ和ゲームは双行列ゲームの特別な場合だから、これが成り立つなら先ほどのミニマックス定理が示されたことに成る.</p>
<h4 id="証明-5">証明</h4>
<p>証明は2つ前の不動点で均衡点を表現する定理を使う. なんか Brower の不動点定理ってのと組み合わせると出来るらしいけどわからん.</p>
</div>
<h2 id="参考文献リスト">参考文献リスト</h2>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p><a href="https://ja.wikipedia.org/wiki/%E5%9B%9A%E4%BA%BA%E3%81%AE%E3%82%B8%E3%83%AC%E3%83%B3%E3%83%9E">囚人のジレンマ - Wikipedia</a><a href="#fnref1">↩</a></p></li>
</ol>
</div>
<!--

  HTML として pandoc -B で include する.

  <H2> を列挙してそれらにリンクを貼った toc を id='toc' に埋め込む.
  markdown で書いてるだろうから例として次のような段落を書けばよい.

```
## INDEX
<div id=toc></div>
```

  used in
  - /memo/gnuplot
  - /memo/linux
  - /memo/imagemagick

-->
<script>
(function() {
  var sections = document.getElementsByTagName('h2');
  var i;
  var OL = document.createElement('ol');
  for (i=0; i < sections.length; ++i) {
    var LI = document.createElement('li');
    var A = document.createElement('a');
    A.innerHTML = sections[i].innerHTML;
    if (A.innerHTML.toUpperCase() == 'INDEX') continue;
    A.href = '#' + i;
    LI.appendChild(A);
    OL.appendChild(LI);

    var PREF = document.createElement('a');
    PREF.name = i;
    sections[i].appendChild(PREF);
  }

  var done = false;
  function work() {
    if (done) return;
    if ( document.getElementById('toc') === null) return; // no toc element
    document.getElementById('toc').appendChild(OL);
    done = true;
  };

  window.onload = work;
  setTimeout(work,800);
}());
</script>
</body>
</html>
