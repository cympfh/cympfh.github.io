<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="description" content="2019年11月24日試験" />
  <meta property="og:url" content="http://cympfh.cc/taglibro">
  <meta property="og:title" content="Tue Oct 13 2020" />
  <meta property="og:description" content="2019年11月24日試験" />
  <meta property="og:image" content="http://cympfh.cc/resources/img/identicon.png" />
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@cympfh" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Tue Oct 13 2020</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <link rel="stylesheet" href="../../../resources/css/c.css" />
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
</head>
<body>
<header class="page-header">
    <a href='../../index.html'><i class="fa fa-save" style="position:absolute; left:0.4em; top:0.4em; width:1.3em;border-radius:0.8em;"></i></a>
</header>
<header>
<h1 class="title">Tue Oct 13 2020</h1>
</header>
<p>統計検定2級の勉強をする. 参考書を持ってないのでひたすら過去問を解いてみる.</p>
<h2 id="年11月24日試験">2019年11月24日試験</h2>
<ul>
<li><a href="https://www.toukei-kentei.jp/wp-content/uploads/201911grade2.pdf">問題</a></li>
<li><a href="https://www.toukei-kentei.jp/wp-content/uploads/ans2019n_grade2.pdf">正解</a></li>
</ul>
<p>このリンクは次の試験が始まると消されてしまう. ところで <a href="https://web.archive.org/web/20201012162418/https://www.toukei-kentei.jp/wp-content/uploads/201911grade2.pdf">こんなの</a> がある. 正解はこれの一番最後のページにある.</p>
<h3 id="問1">問1</h3>
<p>データ点を数直線上 <span class="math inline">\(\mathbb R\)</span> に載せる. 点の数が四等分になるように重ならない4区間に数直線を分割すると, 3つの境値が手に入る. これを小さいものから <strong>第一四分位数 (first quartile, <span class="math inline">\(Q_1\)</span>)</strong>, <strong>中央値 (second quartile, <span class="math inline">\(Q_2\)</span>)</strong>, <strong>第三四分位数 (third quartile, <span class="math inline">\(Q_3\)</span>)</strong> という. さらに第3四分位数と第1の四分位数との差を <strong>四分位範囲</strong> という.</p>
<h4 id="section">(1)</h4>
<p>与えられた箱ひげ図によれば, 東京は <span class="math inline">\(Q_1=6, Q_2=8, Q_3=9.8\)</span> くらい. したがって, <span class="math inline">\([Q_1,Q_2], [Q_2,Q_3]\)</span> に入ってる点数が同じ. 一方でこの階級に照らし合わせると, <span class="math inline">\([Q_1,Q_2)\)</span> はあるけど, <span class="math inline">\([Q_2,Q_3]\)</span> というのがなくて, 近いのは <span class="math inline">\([Q_2, 10)\)</span>. したがって, 6~8 の度数より, 8~10 の度数のが多いはず. 答えは A,C,D のどれか.</p>
<p>それと, 外れ値を見ると, 次の3つのことが言える。</p>
<ol type="1">
<li>3.8くらい未満の点はない</li>
<li>13.8 くらい以上 16.2 未満の点はない</li>
<li>16.2 以上についてはちょうど2つの点がある
<ul>
<li>だいたい 17 くらいと, 17.8 くらい</li>
</ul></li>
</ol>
<p>この 2 と 3 の条件だけから A であることが分かる.</p>
<h4 id="section-1">(2)</h4>
<ol type="1">
<li>箱ひげ図はデータ全体の最小最大を必ずしも表現しないので, 範囲は分からない.</li>
<li>四分位範囲とはこの図で言うところの四角形の高さのこと. 東京が一番小さそう.</li>
<li>第一四分位数とは四角形の下辺のこと. 確かに福岡が一番高い.</li>
<li>中央地は四角形真ん中にある太い線のこと. これが一番低いのは名古屋で高いのが福岡.</li>
<li>最大値は表現されていないので必ずしも分からない.</li>
</ol>
<h3 id="問2">問2</h3>
<h4 id="section-2">(1)</h4>
<ol type="1">
<li>いいえ</li>
<li>いいえ</li>
<li>1990/2015年の図で, 都道府県の対応は書かれてないので分からない</li>
<li>x=y の線を引くとだいぶ左上に来ていて, ただしそう</li>
<li>いいえ</li>
</ol>
<h4 id="section-3">(2)</h4>
<p>具体的な数字が与えられてないので大体で考える. x=y の上にのってれば 1. 1990年はだいぶ載っていそう. 選択肢を見ると 0.38 か 0.71 かだが, こんくらいのってれば 0.71 はあるだろう. 答えは 4 または 5 に絞れる. とすると 2015 年の相関係数は 0.4 または 0.74. 2015年はこれもある程度は相関してるが, y切片がだいぶずれていて, 1990年よりは低いはず. したがって 0.71 より小さくあるべきなので 0.4 だとわかる. 答えは 4.</p>
<h4 id="section-4">(3)</h4>
<p>外れ値を見る. 18%以上は1点. 10%未満は2点. とすると答えは1なんだけど, ちょうど10%くらいの点もあって, もしかしたら3が答えかも. 1と3を区別するために10~12の点を数える. いっぱいありそう. というわけで答えは3だった.</p>
<h3 id="問3">問3</h3>
<p>賃金指数が何かは問題文に書いてある. 何か分からんがそういう数字だと思うことにする. 変化率は大体そのまんま.</p>
<h4 id="section-5">(1)</h4>
<p>H30/1 の賃金指数が <span class="math inline">\(X_0\)</span>, H31/1 の賃金指数が <span class="math inline">\(X_1\)</span> だとする. この変化率が <span class="math inline">\(r = -0.97\)</span> であるとは, <span class="math display">\[r = \frac{X_1 - X_0}{X_0}\]</span> ということ. こういう状況のときに, H30/12 の賃金指数 <span class="math inline">\(Y\)</span> に対して, <span class="math display">\[r&#39; = \frac{X_1 - Y}{Y}\]</span> を求めよという問題.</p>
<p>面倒なので % に関する 100 で割ったり掛けたりは無視する.</p>
<p>一式目を <span class="math inline">\(X_1\)</span> について解けば <span class="math display">\[X_1 = X_0 r + X_0\]</span> これを二式目に代入して, <span class="math display">\[r&#39; = \frac{X_0 r + X_0 - Y}{Y} = \frac{X_0 (1+r)}{Y} - 1\]</span> ここで <span class="math inline">\(r\)</span> がマイナスの値であることには注意.</p>
<p>この形式をしているのは, 1と3だけど分母が <span class="math inline">\(Y=104.1\)</span> なのに注意すれば 1 が答え.</p>
<h4 id="section-6">(2)</h4>
<p>平均変化率とは何かが問題に書いてある. 各々前月からの変化率を考えていることに注意.</p>
<p>ところで, ここで与えられる数字は 102.6, 105.6 なので, これ以外の値が突然出てきてる答えは除外していいに決まってる. それから今考えてるのは複利なので, 4 に決まってるな.</p>
<h3 id="問4">問4</h3>
<p>術語の問題.</p>
<ul>
<li><a href="https://bellcurve.jp/statistics/glossary/1281.html">傾向変動</a></li>
<li><a href="https://bellcurve.jp/statistics/glossary/889.html">季節変動</a>
<ul>
<li>12ヶ月周期の変動</li>
</ul></li>
<li><a href="https://bellcurve.jp/statistics/glossary/1099.html">不規則変動</a>
<ul>
<li>周期変動のうち, 傾向, 循環, 季節変動を除いたもの</li>
<li>観測誤差など</li>
</ul></li>
<li><a href="https://bellcurve.jp/statistics/glossary/1996.html">循環変動</a>
<ul>
<li>周期は一定でないけど周期的に見える変動のこと</li>
</ul></li>
</ul>
<p>というわけで,</p>
<ul>
<li>I: 直線とは限らなさそう</li>
<li>II: あってる</li>
<li>III: 含む</li>
</ul>
<p>答えは2.</p>
<h3 id="問5">問5</h3>
<p>時系列データ <span class="math inline">\(X = \{x_t\}\)</span> について, ラグ <span class="math inline">\(d\)</span> として, <span class="math inline">\(X^d = \{(x_d, x_{t+d}) \}\)</span> という自己相関データを作る. <span class="math inline">\(d=1,2,\ldots\)</span> に対して <span class="math inline">\(X^d\)</span> の中での相関係数を棒グラフで図示したものを <strong>コレログラム</strong> という.</p>
<p>これは時系列データが周期を持つかを調べることが出来る. <span class="math inline">\(X\)</span> が周期 <span class="math inline">\(\ell\)</span> を持っていた場合, コレログラフは <span class="math inline">\(d=0, \ell, 2\ell, 3\ell, \ldots\)</span> で極端に高い値を取るはず. (<span class="math inline">\(d=0\)</span> のときは自明に相関係数 <span class="math inline">\(1\)</span> を取る.)</p>
<p>さて問5の初めの時系列データを見ると, 明らかに周期性を持っていそうで, その周期はちょうど1年くらい. コレログラムは 1,2,3 のときに高くてその逆位相 (0.5, 1.5, 2.5) のときに最低になってるはず.</p>
<p>選択肢だが, 横軸の単位がないがたぶん, 月だろう. 12,24,36 で高くて, 6,18,30 で低いのは 2 だけ.</p>
<h3 id="問6">問6</h3>
<p>術語覚えゲーム.</p>
<ul>
<li><a href="https://bellcurve.jp/statistics/glossary/1449.html">単純無作為抽出法, Simple Random Sampling</a>
<ul>
<li>母集団から必要な点数だけ毎回無作為に選ぶ</li>
</ul></li>
<li><a href="https://bellcurve.jp/statistics/course/8007.html">層化抽出法</a>
<ul>
<li>母集団をいくつかの層（例えば性別）でグループわけする</li>
<li>それぞれの層から必要な点数だけ無作為抽出する</li>
</ul></li>
<li><a href="https://bellcurve.jp/statistics/glossary/1283.html">系統抽出法, Systematic Sampling</a>
<ul>
<li>データにまず添字を与える.</li>
<li>無作為に一点を抽出してから, 添字を等間隔にとってく
<ul>
<li><span class="math inline">\(i \leftarrow \mathrm{Random}\)</span></li>
<li>Choose <span class="math inline">\(i,i+d, i+2d, \ldots\)</span></li>
</ul></li>
</ul></li>
<li><a href="https://bellcurve.jp/statistics/glossary/3657.html">クラスター抽出法, 集落抽出法, Cluster Sampling</a>
<ul>
<li>グループに分けて, 一つのグループをランダムに選ぶ</li>
<li>そのグループの中の点を全て使う</li>
<li>例えば各学校をグループだとして, 学校を無作為に選ぶ</li>
</ul></li>
<li><a href="https://bellcurve.jp/statistics/course/8007.html">多段抽出法</a>
<ul>
<li>階層構造になっているクラスターを見つけて, 再帰的にクラスター抽出をする</li>
<li>例えば
<ol type="1">
<li>ランダムに都道府県を選ぶ</li>
<li>選ばれた中でランダムに市区町村を選ぶ</li>
<li>...</li>
</ol></li>
</ul></li>
</ul>
<p>さて選択肢.</p>
<ul>
<li>I: 全体から無作為に選ぶので単純無作為抽出法</li>
<li>II: 午前/午後を層化してる</li>
<li>III: 便をクラスター（集落）として利用している</li>
</ul>
<p>答えは2.</p>
<h3 id="問7">問7</h3>
<p>単に標準誤差 (Standard Error of the Mean; SEM) という場合, 次のようなもの.</p>
<p><span class="math inline">\(n\)</span> 点をサンプリングしてきて, 標準偏差が <span class="math inline">\(\sigma\)</span> のとき, <span class="math display">\[\mathrm{SEM} = \frac{\sigma}{\sqrt{n}}\]</span></p>
<p>したがって今の場合, <span class="math inline">\(\hat{\sigma} = 4.0\)</span> に注意して, 0.4 が答え.</p>
<h3 id="問8">問8</h3>
<h4 id="section-7">(1)</h4>
<p>同時確率. <span class="math inline">\(20\% \times 70\%\)</span> が答え.</p>
<h4 id="section-8">(2)</h4>
<p>条件付き確率.</p>
<p><span class="math inline">\(\def\gokaku{\mathrm{合格}}\def\jukou{\mathrm{受講}}\)</span> 知りたいのは <span class="math inline">\(P(\jukou \mid \gokaku)\)</span>. ベイズすれば, <span class="math display">\[P(\jukou \mid \gokaku) = P(\gokaku, \jukou) / P(\gokaku)\]</span> ただし <span class="math inline">\(P(\gokaku) = P(\gokaku, \jukou) + P(\gokaku, \lnot\jukou)\)</span> (周辺化)</p>
<p>以上から, <span class="math display">\[\begin{align*}
P(\jukou \mid \gokaku)
&amp; = 1 / \left( 1 + \frac{P(\gokaku, \lnot\jukou) }{ P(\gokaku, \jukou) } \right. \\
&amp; = 1 / \left(1 + \frac{0.8 \times 0.3 }{ 0.2 \times 0.7 } \right) \\
&amp; = 1 / \left(1 + \frac{0.8 \times 0.3 }{ 0.2 \times 0.7 } \right) \\
&amp; = 1 / (1 + \frac{12}{7}) \\
&amp; = \frac{7}{19} \\
&amp; = 0.368421 \\
\end{align*}\]</span></p>
<p>答えは 0.37.</p>
<h3 id="問9">問9</h3>
<h4 id="section-9">(1)</h4>
<p><span class="math inline">\(f\)</span> を全体で積分すると 1 になってるはず. <span class="math inline">\(f\)</span> の様子を考えればよくて, 見たところ直線になってるようなので <span class="math inline">\(f(0)\)</span> と <span class="math inline">\(f(20)\)</span> を直線で繋げばいい. <span class="math inline">\(f(0) = a\)</span>, <span class="math inline">\(f(20) = 0\)</span>. これを積分するとは三角形の面積を求めることで, <span class="math display">\[\int_X f(x) dx = a \times 20 / 2 = 10a\]</span> これが <span class="math inline">\(1\)</span> なので, <span class="math inline">\(a=1/10\)</span>.</p>
<h4 id="section-10">(2)</h4>
<p>期待値は <span class="math display">\[\int_X x f(x) dx = \int dx a(x-x^2/20) = \left[ a(x^2/2 - x^3/60) + C \right] = 20/3\]</span></p>
<p>三角形なのでだいたい重点が期待値になるに決まってて, それで考えても解ける.</p>
<h4 id="section-11">(3)</h4>
<p>使用料金に関する次の確率は密度関数の積分から計算出来て （あるいは三角形の面積から）,</p>
<ul>
<li><span class="math inline">\(P(0 &lt; x &lt; 10) = \int_0^{10} dx f(x) = 3/4\)</span></li>
<li><span class="math inline">\(P(10 &lt; x &lt; 15) = 3/16\)</span></li>
<li><span class="math inline">\(P(15 &lt; x &lt; 20) = 1/16\)</span></li>
</ul>
<p>使用料金の期待値は, <span class="math display">\[1000 \times P(0&lt;x&lt;10) + 1120 \times P(10&lt;x&lt;15) + 1280 \times P(15&lt;x&lt;20)\]</span> ぱっとみて比重が <span class="math inline">\(P(0&lt;x&lt;10)\)</span> なので大体1000くらいでこれより大きいくらいの値. 1250 だとでかすぎるので 1040 が答えだろう.</p>
<h3 id="問10">問10</h3>
<p>累積分布関数のことを分布関数と呼んでそう.</p>
<h4 id="section-12">(1)</h4>
<p>選択肢を見ると, <span class="math inline">\(F_X(x=0)\)</span> の値だけ調べれば良さそう. <span class="math display">\[F_X(0) = P[X \leq 0] = P[X=0] = P[Z&gt;100] = 1 - P[Z \leq 100] = 0.04\]</span> また <span class="math inline">\(F_Z(0) = P[X \leq 0] = 0\)</span> 以上に合致する答えは 3.</p>
<h4 id="section-13">(2)</h4>
<p>下側95%点が <span class="math inline">\(x\)</span> であるとはつまり, <span class="math display">\[F_X(x) = 0.95\]</span> であること. (1) の解答より, <span class="math inline">\(F_Z(x) = F_X(x) - 0.04 = 0.91\)</span>. よって <span class="math inline">\(x=5\)</span>.</p>
<h4 id="section-14">(3)</h4>
<p><span class="math inline">\(X\)</span> の密度関数を <span class="math inline">\(f_X\)</span> とも書くことにすれば, <span class="math inline">\(X\)</span> の期待値は <span class="math inline">\(\int x f_X(x) dx\)</span>. これを <span class="math inline">\(F_Z, f_Z\)</span> で表現すればいい.</p>
<ul>
<li><span class="math inline">\(F_Z(x) = \int f_Z(x) dx\)</span></li>
<li><span class="math inline">\(F_X(x) = \int f_X(x) dx\)</span></li>
<li><span class="math inline">\(F_X(x) = F_Z(x) + 0.04\)</span></li>
</ul>
<p>最後の式の両辺を微分すれば, <span class="math inline">\(f_Z = f_X\)</span>. というわけで <span class="math inline">\(X\)</span> の期待値は <span class="math display">\[\int z f_Z(z) dz\]</span></p>
<h3 id="問11">問11</h3>
<p><a href="https://bellcurve.jp/statistics/course/17950.html">歪度と尖度</a></p>
<p>データ <span class="math inline">\(\{x_i\}\)</span> の歪度（わいど）とは <span class="math display">\[\frac{n}{(n-1)(n-2)} \sum_i \left( \frac{x_i - \bar{x}}{\sigma} \right)^3\]</span> ヒストグラムをかいたとき, 完全に左右対称だと歪度はゼロで, 平均が左に寄ってるとき正の値, 右に寄ってるとき負の値をとる.</p>
<p>さて選択肢.</p>
<ul>
<li>I: 平均の値は関係ない</li>
<li>II: 逆で正の値をとる</li>
<li>III: 関係ない</li>
</ul>
<p>というわけで全部誤り.</p>
<h3 id="問12">問12</h3>
<p>真の値 <span class="math inline">\(\theta\)</span> に対して, 推定量 <span class="math inline">\(\theta&#39;\)</span> が不偏であるとは, <span class="math display">\[\mathbb E[\theta&#39;] = \theta\]</span> であること.</p>
<p>一方で, サンプル数 <span class="math inline">\(n\)</span> のときに <span class="math inline">\(\theta^n\)</span> を推定する場合に, これが一致推定量であるとは, <span class="math display">\[\lim_{n \to \infty} P[ \| \theta^n - \theta \| &lt; \epsilon ] = 1\]</span> であること.</p>
<p>平均的に正しければ不偏. サンプル数を十分大きくすると真に正しくなるのが一致推定量.</p>
<p>平均の推定. 普通にサンプルの全部の平均を取る標本平均は一致かつ不偏.</p>
<p>分散の推定. 普通の標本分散は一致ではあるが, 不偏でない. <span class="math inline">\(n\)</span> で割る代わりに <span class="math inline">\(n-1\)</span> で割ったものは一致かつ不偏になる (<span class="math inline">\(\frac{1}{n-1} (x_i - \bar{x})^2\)</span>).</p>
<p>さてこの問題だが, <span class="math inline">\(\hat{\mu_1}\)</span> はその平均はつまり <span class="math inline">\(X_i\)</span> の平均であり, これは真の平均なので, 不偏ではある. しかし有限個の平均をとってるだけなので, サンプル数を増やしても一致はしない. <span class="math inline">\(\hat{\mu_2}\)</span> は普通の標本平均なので, 一致かつ不偏.</p>
<p>というわけで, I, III, IV が正しい.</p>
<h3 id="問13">問13</h3>
<p>標準正規分布 <span class="math inline">\(\mathcal N(0,1)\)</span> の95%信頼区間を調べる. 付表の初めに具体的な値の表があるのでこれを使う. 95%信頼区間とは中央から左右対称にとってきて確率が95%の区間のことを言う. すなわち <span class="math inline">\(Q(u) = 2.5\%\)</span> な点を探せばよくて, <span class="math inline">\(u=1.96\)</span> （ぴったりな点が用意されている！）. <span class="math inline">\([-1.96, 1.96]\)</span> が95%信頼区間である.</p>
<p>今考えている100点サンプルによる分布は正規分布であるとしているので, <span class="math inline">\(\mathcal N(0,1)\)</span> を期待値の分だけ横に平行移動して, 横方向に拡大または縮小したものだ. 期待値は明らかに 0.54 と分かっているので, 横方向の拡大率を調べればいい.</p>
<p>実は, 分布を標準化するには, <span class="math display">\[x \mapsto \frac{x - \mu}{\sigma / \sqrt{n}}\]</span> とするとよい. <span class="math inline">\(\mu= 0.54\)</span>. そしてこの分母はさっきでてきた SEM のことである.</p>
<p>今考えているのはAに投票するかしないかの二項分布で, これを正規分布だと思うことにしている. これの分散は, <span class="math inline">\(V= E[X^2] - E[X]^2 = 1/2-(1/2)^2=1/4\)</span>. したがって <span class="math inline">\(\sigma = 1/2\)</span>. 今サンプル数は <span class="math inline">\(n=100\)</span>. これらを代入すれば, SEM は <span class="math inline">\(1/20\)</span>.</p>
<p>このサンプルが作る分布は標準正規分布を平行移動して 1/20 倍に縮小したもの.</p>
<p>信頼区間も <span class="math inline">\(1.96 / 20 = 0.098\)</span> から, <span class="math inline">\([-0.098, 0.098]\)</span> だと分かる.</p>
<p>答えは5.</p>
<h3 id="問14">問14</h3>
<h4 id="section-15">(1)</h4>
<p>まず中央値を探す. 低い階級の度数から順に累積して足していくことで,</p>
<ul>
<li>100万未満: 6.2%</li>
<li>200万未満: 19.6%</li>
<li>300万未満: 33.3%</li>
<li>400万未満: 46.5%</li>
<li>500万未満: 56.9%</li>
</ul>
<p>したがって, 中央値は 400万以上 500万未満のところにあることが分かった. 「中央値の半分」というのは 200万以上 250万未満のことである. 「中央値の半分に満たない」とは「200万未満」または「250万未満」のこと. したがって, 19.6% 以上 33.3% 以下が正解.</p>
<h4 id="section-16">(2)</h4>
<p>さっきも登場したこの <span class="math inline">\(Z\)</span> が何かということ, これは <span class="math inline">\(n \to \infty\)</span> の極限を取ると <span class="math inline">\(\mathcal N(0,1)\)</span> になるというもの. したがって正解は3.</p>
<p>選択肢2はほとんど正しいが, 母集団は正規分布でないといけないので誤り.</p>
<h3 id="問15">問15</h3>
<h4 id="section-17">(1)</h4>
<p>事前分布としては, 支持する/しないが当確率だとしておけばいい. これを確率変数 <span class="math inline">\(X=0,1\)</span> に割り当てておくと, <span class="math inline">\(EX=1/2, VX=1/4\)</span>. サンプル数 <span class="math inline">\(n\)</span> として, <span class="math inline">\(X\)</span> の標準化標本統計量 <span class="math inline">\(Z\)</span> は <span class="math display">\[Z_i = \frac{X_i - 1/2}{\sqrt{VX / n}}\]</span></p>
<p>さっきも見たように標準正規分布で95%信頼区間は <span class="math inline">\([-1.96, 1.96]\)</span>. これを 6% 未満, つまり <span class="math inline">\([-0.03, 0.03]\)</span> にしたいということは, <span class="math inline">\(0.03/1.96 = 0.015306\)</span> 倍にしたいということ. <span class="math inline">\(\sqrt{VX/n} = 0.015306\)</span> 未満程度になればいい.</p>
<p>両辺の2乗を取っておいて <span class="math inline">\(VX/n = 0.00023427\)</span> 未満程度としておく.</p>
<p><span class="math inline">\(VX=1/2\)</span> と <span class="math inline">\(n\)</span> として選択肢の数字を代入してみれば,</p>
<ul>
<li><span class="math inline">\(VX / 900 = 1 / 3600 = 0.0002777777\)</span></li>
<li><span class="math inline">\(VX / 1100 = 1 / 4400 = 0.0002272727\)</span></li>
</ul>
<p>というわけで1100人は必要みたい.</p>
<h4 id="section-18">(2)</h4>
<p>分散が変わる. <span class="math inline">\(EX=0.8\)</span> であるといっているので <span class="math inline">\(VX = E(X^2) - (EX)^2 = 0.8 - 0.8 \times 0.8 = 0.16\)</span>.</p>
<ul>
<li><span class="math inline">\(VX / 300 = 0.000533333\)</span></li>
<li><span class="math inline">\(VX / 700 = 0.000228571\)</span></li>
</ul>
<p>700人でいいみたい.</p>
<h3 id="問16">問16</h3>
<h4 id="section-19">(1)</h4>
<p>正規分布 <span class="math inline">\(\mathcal N(\mu, \sigma^2)\)</span> に従う <span class="math inline">\(n\)</span> 点データ <span class="math inline">\(\{X_i\}\)</span> の標本平均 <span class="math inline">\(\bar{X}\)</span>, 不偏分散 (<span class="math inline">\((n-1)\)</span> で割るやつ) を <span class="math inline">\(S^2\)</span> とする. このとき <span class="math display">\[t = \frac{\bar{X} - \mu}{S / \sqrt{n}}\]</span> これは自由度 <span class="math inline">\(n-1\)</span> の t 分布に従う. t分布は <span class="math inline">\(n \to \infty\)</span> のとき, 標準正規分布と一致する.</p>
<ul>
<li><a href="https://ja.wikipedia.org/wiki/T%E5%88%86%E5%B8%83">t分布</a></li>
</ul>
<p>答えは自由度 <span class="math inline">\(n-1\)</span> の t 分布</p>
<h4 id="section-20">(2)</h4>
<p>仮説検定</p>
<ul>
<li>有意差があるかどうかを調べたい</li>
<li>仮説を建てる
<ul>
<li><strong>帰無仮説</strong> ：差が無いという主張命題</li>
<li><strong>対立仮説</strong> ：初めに主張したかった命題（一方が一方より良い）</li>
</ul></li>
<li>帰無仮説が成り立つ確率を計算する</li>
<li>その計算が一定未満なら帰無仮説を <strong>棄却</strong> する
<ul>
<li>有意差があったとする</li>
</ul></li>
<li>さもなくば有意差なしとする</li>
</ul>
<p>今の場合は体重の変化なしとするのが帰無仮説で, 体重の減少があったとするのが対立仮説. それぞれは <span class="math inline">\(\mu = 0\)</span>, <span class="math inline">\(\mu &gt; 0\)</span> と表される.</p>
<h4 id="section-21">(3)</h4>
<p>母集団が正規分布に従うことにしているので, t 検定をする. <span class="math inline">\(\mu=0\)</span> に関する <span class="math inline">\(t\)</span> 値は, <span class="math display">\[t = \frac{\bar{X} - \mu}{\sqrt{S^2 / n}} = \frac{0.5 - 0}{1.5 / \sqrt{16}} = 4/3 = 1.333\]</span></p>
<p>今からしたいのが <a href="https://bellcurve.jp/statistics/course/9319.html">両側検定なのか片側検定なのか</a> によって見る点 <span class="math inline">\(t_\alpha(\nu)\)</span> は違う. 対立仮説が左右対称（イコールかノットイコールか）なら両側、 左右非対称（大小比較）であれば片側をする. 今の場合, 一方は一方より大きいという左右非対称なことを確かめたいので片側検定.</p>
<p>片側での5%有意な点というのはつまり上側 5% の点を見ればよくて, また自由度 <span class="math inline">\(\nu\)</span> は <span class="math inline">\(n-1=15\)</span> に注意して <span class="math inline">\(t_{0.05}(15) = 1.753\)</span> であることが付表2から読み取れる.</p>
<p>棄却するかの判定はこの点より左にあるか右にあるかどうかだけを見れば良くて, 今の場合 <span class="math inline">\(t &lt; 1.753\)</span> なので棄却はされず, 「効果があるとは言えない」が結論になる.</p>
<p>「効果がない」ではなくて「効果があるとは言えない」という結論づけであることに注意.</p>
<h3 id="問17">問17</h3>
<p>3群以上のデータについて平均の差を検討する手法として分散分析がある. 次のように行う.</p>
<p><span class="math inline">\(N\)</span> 点データ <span class="math inline">\(\{X_i\}\)</span> が <span class="math inline">\(K\)</span> 個のグループに分割されているとする: <span class="math display">\[\{ X_i \}_N = \{ X_i^1 \}_{N_1} \cup \{ X_i^2 \}_{N_2} \cup \ldots \cup \{ X_i^K \}_{N_K}\]</span> ここで群はある要因によって分割されているとする. この問題なら「何月」というのが要因で, データをこれによって分割している.</p>
<p>平均を計算する.</p>
<ul>
<li>全体の平均: <span class="math inline">\(\bar{X} = \frac{1}{N} \sum_i X_i\)</span></li>
<li>要因ごとの平均（群ごとの平均）: <span class="math inline">\(\bar{X^k} = \frac{1}{N_k} \sum_i^{N_k} X_i^k\)</span></li>
</ul>
<p>次に不偏分散を計算する. これは次のように順序立てて計算することになっているらしい.</p>
<ol type="1">
<li>平方和の計算
<ul>
<li>全体の平方和: <span class="math inline">\(G_0 = \sum_i^N (X_i - \bar{X})^2\)</span>
<ul>
<li>データ全体で分散を計算する</li>
</ul></li>
<li>要因の平方和: <span class="math inline">\(G_1 = \sum_k^K N_k (\bar{X^k} - \bar{X})^2\)</span>
<ul>
<li>二種類の平均同士で比較する</li>
</ul></li>
<li>残差: <span class="math inline">\(G_2 = G_0 - G_1 = \sum_k^K \sum_i^{N_k} (X_k^k - \bar{X^k})^2\)</span>
<ul>
<li>その要因（群）の中での分散を計算するもの</li>
<li><span class="math inline">\(G_0, G_1\)</span> の差であること, 一番右の式の形, 両方覚えておいたほうがいい</li>
</ul></li>
</ul></li>
<li>自由度
<ul>
<li>全体の自由度: <span class="math inline">\(\nu_0 = N-1\)</span></li>
<li>要因の自由度: <span class="math inline">\(\nu_1 = K - 1\)</span></li>
<li>残差の自由度: <span class="math inline">\(\nu_2 = \nu - \nu_1 = (N-1) - (K-1) = N - K\)</span></li>
</ul></li>
<li>平均平方（平方和を自由度で割る）
<ul>
<li>要因: <span class="math inline">\(V_1 = \frac{G_1}{K - 1}\)</span></li>
<li>残差: <span class="math inline">\(V_2 = \frac{G_2}{N - K}\)</span></li>
</ul></li>
</ol>
<p>最後に統計量 <span class="math inline">\(F\)</span> 値を計算する. これは <span class="math display">\[F = \frac{V_1}{V_2}\]</span> で与えられる.</p>
<p>この量 <span class="math inline">\(F\)</span> は <span class="math inline">\(\geq 0\)</span> の範囲で分布する <span class="math inline">\(F\)</span> 分布に従う量で, 上側に関する片側検定をすることに意味がある. つまり,</p>
<ul>
<li>帰無仮説: 差がない
<ul>
<li>全ての群の平均は等しい</li>
</ul></li>
<li>対立仮説: 一方は一方より大きい
<ul>
<li>少なくとも一つの群は異なる</li>
</ul></li>
</ul>
<h4 id="section-22">(1)</h4>
<p>この問題で水準間平方和 <span class="math inline">\(S_A\)</span> としてあるのがおそらく要因の平方和のこと. <span class="math inline">\(S_e\)</span> は残差.</p>
<p>この問題では要因としては月だけを考えているので年ごとの平均というのはミスリーディング.</p>
<ul>
<li><span class="math inline">\(S_A = \sum_k N_k (\bar{X^k} - \bar{X})^2 = \sum^{12} 11 (\bar{y_{i\cdot}} - \bar{y_{\cdot \cdot}})^2\)</span>
<ul>
<li>11 は 2008 から 2018 までの個数</li>
</ul></li>
<li><span class="math inline">\(S_e = \sum_k \sum_i (X_i^k - \bar{X^k})^2 = \sum^{12} \sum_{2008}^{2018} (y_{ij} - \bar{y_{i\cdot}})^2\)</span></li>
</ul>
<p>選択肢は1が答え.</p>
<h4 id="section-23">(2)</h4>
<p>全体のデータ点が <span class="math inline">\(N = 12 \times 11 = 132\)</span> 個. 全体の自由度は <span class="math inline">\(N - 1 = 131\)</span>. 要因ごとの自由度は <span class="math inline">\(K - 1 = 12 - 1 = 11\)</span>. 残差の自由度は <span class="math inline">\(N - N_k = 132 - 12 = 120\)</span>, または全体の自由度と要因の自由度の差で <span class="math inline">\(131-11 = 120\)</span>.</p>
<h4 id="section-24">(3)</h4>
<p>帰無仮説は「全てが等しいこと」である. ただしこれでは選択肢は絞れない.</p>
<p>対立仮説は「いずれかが異なる」である. ここで I は誤りであることが分かる.</p>
<p>付表のF分布表を読む. 今このF分布の自由度は <span class="math inline">\((11, 120)\)</span>. これで上側5%の点は, ぴったりがないんだけど, 1.910 より小さくて 1.750 よりは大きいことだけが分かる. 今 <span class="math inline">\(F = 3.0471\)</span> と, これらより大きいので帰無仮説は棄却していい. したがって II は誤り.</p>
<p>P値は棄却出来るギリギリの上側確率のこと, であってる？？？ 自由度 <span class="math inline">\((11,120)\)</span> の値が付表にないので諦めて <span class="math inline">\((10,120)\)</span> から読む.</p>
<ul>
<li><span class="math inline">\(F_{0.05}(10;120) = 1.910\)</span></li>
<li><span class="math inline">\(F_{0.025}(10;120) = 2.157\)</span></li>
</ul>
<p><span class="math inline">\(F_p\)</span> の <span class="math inline">\(p\)</span> に関して単調減少であることはこれを見ても, あるいは意味を考えても明らか.</p>
<p>与えられたデータでは <span class="math inline">\(F=3.0471\)</span> であってもっと <span class="math inline">\(p=0.025\)</span> の値よりも大きいので, <span class="math inline">\(F=3.0471\)</span> に対応する p 値はもっと小さいことが分かる.</p>
<p>以上から III は正しい.</p>
<h3 id="問18">問18</h3>
<h4 id="section-25">(1)</h4>
<p>普通の線形回帰モデル. Estimate が対応する係数のことだろう. Intercept は切片ね. 選択肢1しか正しくない.</p>
<h4 id="section-26">(2)</h4>
<p>I について. 最小2乗誤差で最適化するとこれが成り立つ.</p>
<p>今データ <span class="math inline">\(\{ (x_i, y_i) \}\)</span> をモデル <span class="math inline">\(\hat{y_i} = a + b x_i\)</span> で表している. そして最小二乗法をしているということは <span class="math display">\[L = \sum_i (y_i - a - b x_i)^2\]</span> という値を最小化している. そのときはもちろん <span class="math inline">\(L\)</span> の勾配がゼロであるということ. <span class="math inline">\(a\)</span> で微分すると良くて <span class="math display">\[\partial_a L = - \sum_i (y_i - a - b x_i) = 0\]</span> すなわち, <span class="math display">\[\sum_i y_i = \sum_i (a+bx_i) = \sum_i \hat{y_i}\]</span> を得る. 両辺を <span class="math inline">\(N\)</span> で割れば, 平均が等しいことも分かる.</p>
<p>II について. 平均を期待値と読み替えておけば, 期待値の線形性から分かる.</p>
<p><span class="math inline">\(\hat{y} = 14.4 + 0.4 x\)</span> であって, 期待値 <span class="math inline">\(Ey=31.3\)</span> であるという. <span class="math display">\[Ex = (Ey - 14.4) / 0.4 = 42.25\]</span></p>
<p>III について. それはそう.</p>
<h4 id="section-27">(3)</h4>
<p>I について. 単回帰と重回帰の違いは説明変数がただ一つか, 2つ以上か. 2つの変数の係数を等しいとすることは, その変数の和を取った一つの変数に置き換えるということ. 今の場合それはちょうど単回帰になる.</p>
<p>II について. 決定係数 <span class="math inline">\(R^2\)</span> (<span class="math inline">\(\in [0, 1]\)</span>) はモデルのデータへの当てはまり度合いを言う. 大きいほどよく当てはまっている. この問題では <code>R-squared</code> として出力されている.</p>
<p>さてこの値はモデルを複雑にすればするほど高くなる. そこで公平さのために自由度で調整をする. これが <strong>自由度調整済み決定係数</strong>. この問題ではおそらく <code>R-squared Adjusted</code> というのがそれだろう. 見てみると単回帰の方が大きい. 大きいほうが良いので, 単回帰を選択するべき.</p>
<p>III について. それはそう.</p>
<footer>
    <p class="is-pulled-right">
    @cympfh / mail@cympfh.cc
    </p>
</footer>
<!--

  以下を埋め込むと H2 タグを列挙してそれぞれへのリンクにする.
  ただし "INDEX" は除外する.

    <div id=toc></div>


  H2, H3 タグまでを列挙するには以下を埋め込む.

    <div id=toc-level-2></div>

-->
<script>
(function() {

  function naming(obj, name) {
      var PREF = document.createElement('a');
      PREF.name = name;
      obj.appendChild(PREF);
  }

  function level1() {

    var sections = document.getElementsByTagName('h2');
    var OL = document.createElement('ol');
    for (var i=0; i < sections.length; ++i) {
      var LI = document.createElement('li');
      var A = document.createElement('a');
      A.innerHTML = sections[i].innerHTML;
      if (A.innerHTML.toUpperCase() == 'INDEX') continue;
      A.href = '#' + i;
      LI.appendChild(A);
      OL.appendChild(LI);
      naming(sections[i], i);
      // var PREF = document.createElement('a');
      // PREF.name = i;
      // sections[i].appendChild(PREF);
    }

    return OL;
  }

  function level2() {

    var sections = document.querySelectorAll('h2,h3');
    var tree = [];
    for (var i = 0; i < sections.length; ++i) {
      if (sections[i].tagName == 'H2') {
        if (sections[i].innerHTML.toUpperCase() === 'INDEX') continue;
        tree.push([sections[i]]);
      } else {
        if (tree.length > 0) {
          tree[tree.length-1].push(sections[i]);
        } else {
          tree.push([sections[i]]);
        }
      }
    }

    var OL = document.createElement('ol');
    for (var i = 0; i < tree.length; ++i) {

      // h2-level
      var LI = document.createElement('li');
      var A = document.createElement('a');
      A.innerHTML = tree[i][0].innerHTML;
      A.href = '#' + i;
      naming(tree[i][0], i);
      LI.appendChild(A);

      // h3-level
      if (tree[i].length > 1) {
        var OL_sub = document.createElement('ol');
        for (var j = 1; j < tree[i].length; ++j) {
          var LI_sub = document.createElement('li');
          var A = document.createElement('a');
          A.innerHTML = tree[i][j].innerHTML;
          A.href = `#${i}-${j}`;
          naming(tree[i][j], `${i}-${j}`);
          LI_sub.appendChild(A);
          OL_sub.appendChild(LI_sub);
        }
        LI.appendChild(OL_sub);
      }

      OL.appendChild(LI);
    }

    return OL;
  }

  function append_toc() {
    if (document.getElementById('toc')) {
      document.getElementById('toc').appendChild(level1());
    }
    if (document.getElementById('toc-level-2')) {
      document.getElementById('toc-level-2').appendChild(level2());
    }
  }

  window.addEventListener('DOMContentLoaded', append_toc, false);
}());
</script>
</body>
</html>
