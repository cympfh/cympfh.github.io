<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <title>Mon Feb 22 23:27:52 JST 2016</title>
  <style type="text/css">code{white-space: pre;}</style>
  <link rel="stylesheet" href="../../../resources/css/c.css">
  <link rel="stylesheet" href="../../css/post.css">
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<a href="../../">🔙 Back to Top</a>
<header>
<h1 class="title">Mon Feb 22 23:27:52 JST 2016</h1>
</header>
<h2 id="グランディ数">グランディ数</h2>
<h3 id="組み合わせゲーム">組み合わせゲーム</h3>
<p>次のようなゲームを組み合わせゲームという</p>
<ol type="1">
<li>二人</li>
<li>完全情報</li>
<li>常に二人が打てる手が同じ (将棋はこれに当てはまらない)</li>
<li>有限ステップでゲームが終わる</li>
</ol>
<p>有名なものとして ニム (<a href="https://ja.wikipedia.org/wiki/ニム" class="uri">https://ja.wikipedia.org/wiki/ニム</a>, <a href="https://en.wikipedia.org/wiki/Nim" class="uri">https://en.wikipedia.org/wiki/Nim</a>) がある.</p>
<p>ゲームを <span class="math inline">\(A=(\mathcal{P},\mathcal{R})\)</span> で表現する. ここで <span class="math inline">\(\mathcal{P}\)</span> は、あり得る局面全体からなる集合である. <span class="math inline">\(\mathcal{R}\)</span> はルールを表現する. ここで、ルールとは、 ある局面を渡されたときに、合法な手によって写せる先の局面を定めることができれば十分である. (組み合わせゲームにおいては、誰の手であっても打てる手は同じで、写せる先も同じ.) ある局面 <span class="math inline">\(P \in \mathcal{P}\)</span> について、それを写せることのできる局面全体を <span class="math inline">\(\mathcal{R}(P)\)</span> と書く. 写せる先のない局面は <span class="math inline">\(\mathcal{R}(P) = \{\}\)</span> であるような <span class="math inline">\(P\)</span> のことであり、このような局面を最終局面という. 言い換えれば、打つ手が無い局面である. 慣例として、最終局面に写した人が勝ちで、打つ手が無い場合に負けとする. これをゲームの正規形と呼ぶ. ちょうど逆として、打つ手が無い場合に勝ちを確定するものを、逆形と呼ぶ.</p>
<h3 id="例.-nim-n山の石取りゲーム">例. Nim (n山の石取りゲーム)</h3>
<p>nつの山がある. 一つの山はいくつかの石から成る. プレイヤーは交互に、一つの山を選び、そこから1つ以上、あるだけ自由な個数の石を取ることを、する.</p>
<p>最終局面とは、どの山にも石が残ってない状態である. いずれかの山に、１つ以上石が残っていれば、手は残っているので最終局面ではないからである.</p>
<p>正規形においては、最後の一つの石を取ったものが勝ちであり、 最終局面を渡された側の負けである.</p>
<p>逆形においては、最後の一つの石を取ったものが負けである.</p>
<h3 id="グランディ数-grundy-value-nim-value-nimber-energy">グランディ数 (Grundy value, Nim value, Nimber, Energy)</h3>
<p>あるゲーム <span class="math inline">\(A=(\mathcal{P}, \mathcal{R})\)</span> の グランディ数とは、<span class="math inline">\(g: \mathcal{P} \rightarrow \mathbb{N}\)</span> なる写像である. ここで <span class="math inline">\(\mathbb{N}\)</span> とは自然数 (非負整数) 全体 (<span class="math inline">\(0,1,2,\ldots\)</span>) である.</p>
<p>グランディ数を次のように定義する: <span class="math display">\[g(P) = mex~ \{ g(P&#39;) : P&#39; \in \mathcal{R}(P)\}.\]</span></p>
<p>ここで mex とは、最小除外数 (minimum exclusion) などと呼ばれるもので、 <span class="math inline">\(mex~T\)</span> (<span class="math inline">\(T\)</span> は自然数の部分集合) とは、<span class="math inline">\(T\)</span> に含まれない自然数の中で最小の数のことである. すなわち <span class="math inline">\(\min~(\mathbb{N} \setminus T)\)</span> と書いても良い.</p>
<p>定義から、<span class="math inline">\(P\)</span> が最終局面ならば、<span class="math inline">\(g(P)\)</span> は <span class="math inline">\(mex~\{\} = 0\)</span> である.</p>
<h3 id="例.-制限付きnim-石取りゲーム">例. 制限付きNim (石取りゲーム)</h3>
<p>山にN個の石がある. 石が在る限り、1個以上3個以下の石を交互に取る.</p>
<p>正規形を考える. すなわち、石が1個も取れない状態 (空の状態) が回ってきたら負けである. 最後の1個の石を取ったら勝ちだと言い換えても良い.</p>
<p>このゲームの局面は、山に残った石の数で表現できる. 例えば山に石が3個残ってる局面を <span class="math inline">\(P=3\)</span> と書く. さてではグランディ数はいかになるか、小さい<span class="math inline">\(P\)</span>について具体的に書きだしてみる.</p>
<p><span class="math inline">\(P=0\)</span> が最終局面であるので、その時に <span class="math inline">\(g=0\)</span> であるのは良い. <span class="math inline">\(P=1\)</span> のとき、移れる先としては <span class="math inline">\(P=0\)</span> がある. <span class="math inline">\(g(1) = mex~\{0\} = 1\)</span>. <span class="math inline">\(P=2\)</span> のとき、移れる先として <span class="math inline">\(P=0,1\)</span> がある. <span class="math inline">\(g(2)=mex~\{0,1\}=2\)</span>. みたいに数が上がっていくが、 <span class="math inline">\(P=4\)</span> のときに初めて、移れる先として <span class="math inline">\(P=1,2,3\)</span> となって最終局面に移れない. <span class="math inline">\(g(4)=0\)</span> である.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">P</th>
<th style="text-align: right;">0</th>
<th style="text-align: right;">1</th>
<th style="text-align: right;">2</th>
<th style="text-align: right;">3</th>
<th style="text-align: right;">4</th>
<th style="text-align: right;">5</th>
<th style="text-align: right;">6</th>
<th style="text-align: right;">7</th>
<th style="text-align: right;">8</th>
<th style="text-align: right;">9</th>
<th style="text-align: right;">...</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">g</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">...</td>
</tr>
</tbody>
</table>
<p>最終局面なら <span class="math inline">\(g=0\)</span>. 移る先がいつも <span class="math inline">\(g&gt;0\)</span> なら <span class="math inline">\(g=0\)</span>. 当然だ.</p>
<p>3個以下と制限を与えたが、一般に <span class="math inline">\(k\)</span> 個以下なら、グランディ数は周期 <span class="math inline">\(k+1\)</span> で <span class="math inline">\(g = 0,1,2,..,(k-1),k,0,1,2,..\)</span> となりそうなのが観察から分かる. 制限なし (いくつでも取っていい) なら、<span class="math inline">\(k=\infty\)</span> とすれば良いだろう.</p>
<h3 id="定理">定理</h3>
<p><span class="math inline">\(g(P)=0\)</span> のとき、またそのときに限り、 局面 <span class="math inline">\(P\)</span> は後攻必勝である. (つまり局面<span class="math inline">\(P\)</span> が渡された人は必ず負ける.)</p>
<h3 id="ゲームの和-選択和">ゲームの和 (選択和)</h3>
<p>ゲーム <span class="math inline">\(A_1=(\mathcal{P}_1, \mathcal{R}_1)\)</span> と <span class="math inline">\(A_2=(\mathcal{P}_2, \mathcal{R}_2)\)</span> の和を <span class="math inline">\(A_1+A_2=(\mathcal{P}_1 \times \mathcal{P}_2, \mathcal{R}_1 + \mathcal{R}_2)\)</span> と定める.</p>
<p>ゲーム和の局面は、2つのゲームの局面の直積 (すなわちただの対) である.</p>
<p>ゲーム和のルール <span class="math inline">\(\mathcal{R}_1 + \mathcal{R}_2\)</span> は選択和であり、2つのゲームの局面のうち、どちらか一方だけを動かすものである: <span class="math display">\[(\mathcal{R}_1 + \mathcal{R}_2)(P_1,P_2) = \{ (P_1&#39;,P_2) : P_1&#39; \in \mathcal{R}_1(P_1) \} \cup \{ (P_1,P_2&#39;) : P_2&#39; \in \mathcal{R}_2(P_2) \}.\]</span></p>
<p>和は次のように解釈できる: 2つのゲームを横に並べて遊ぶ. 自分の手番ではどちらか1つだけを選んで手番を進める.</p>
<p>両方のゲームが共に最終局面になったときに、ゲーム和も最終局面であると解釈される.</p>
<h3 id="ゲーム和のグランディ数">ゲーム和のグランディ数</h3>
<p><span class="math display">\[g(P_1,P_2) = g(P_1) +^* g(P_2)\]</span> で与えられる. ここで演算子 <span class="math inline">\(+^*\)</span> は、ニム和とも呼ばれるもので、 bit表現したときの <a href="https://ja.wikipedia.org/wiki/排他的論理和#.E3.83.93.E3.83.83.E3.83.88.E3.81.94.E3.81.A8.E3.81.AE.E6.8E.92.E4.BB.96.E7.9A.84.E8.AB.96.E7.90.86.E5.92.8C">排他的論理和</a> である.</p>
<p>一般に、<span class="math inline">\(n\)</span> 個以上のゲーム和も定義できて、 その和のグランディ数も、 <span class="math display">\[g(P_1,P_2,..,P_n) = \sum {}^* g(P_i)\]</span> で与えられる (ニム和の総和).</p>
<h3 id="つ山の制限付きnim-石取りゲーム">2つ山の制限付きNim (石取りゲーム)</h3>
<p>2つの山があって、それぞれ <span class="math inline">\(n\)</span> 個、<span class="math inline">\(m\)</span> 個の石からなる. プレイヤーは交互に、1つの山を選んで石を取る. 先ほどと同様に、取る石の数は1個以上3個以下と制限する. 最後の最後の一個を取ったら勝ちで、 どちらの山にも石が残ってない局面が渡されたら負けである (正規形).</p>
<p>状態は <span class="math inline">\((n,m)\)</span> で表せる. 終盤局面は <span class="math inline">\((0,0)\)</span> である. <span class="math inline">\((n,0)\)</span> または <span class="math inline">\((0,m)\)</span> なら、グランディ数は、先ほどの山が1つの場合と同じである. それ以外ではどうか.</p>
<p>例えば、<span class="math inline">\((4,1)\)</span> の時、 <span class="math inline">\(\mathcal{R}(4,1) = \{ (4,0), (3,1), (2,1), (1,1) \}\)</span> であって…</p>
<p>二次元のテーブルの上でグランディ数を具体的に書きだしてみると、 周期性が見えて、やはりなんとなく分かるが、 先ほどのニム和の性質が満たされていることも確認できる. すなわち、 <span class="math display">\[g(n,m) = g(n) +^* g(m) = ((n+1) \bmod 4) +^* ((m+1) \bmod 4)\]</span> である.</p>
<h3 id="定理の証明">定理の証明</h3>
<p>グランディ数の定義の仕方から、次が言える.</p>
<ul>
<li><span class="math inline">\(g=0\)</span> のとき、次の局面は必ず <span class="math inline">\(g \ne 0\)</span></li>
<li><span class="math inline">\(g \ne 0\)</span> のとき、次の局面として <span class="math inline">\(g=0\)</span> とできるものがある</li>
<li>終盤局面のとき、後手必勝 (このとき <span class="math inline">\(g=0\)</span> であるから定理に従う)</li>
</ul>
<p>以上のことと、先手必勝でないならば後手必勝であるという組み合わせゲームの性質を考えれば、 証明は容易である.</p>
<ol type="1">
<li><span class="math inline">\(g \ne 0\)</span> のとき、常に <span class="math inline">\(g=0\)</span> なる局面に写すことができるのでそうする. 相手は何を打っても、次、自分に渡される局面は常に <span class="math inline">\(g \ne 0\)</span> であるのでずっと <span class="math inline">\(g=0\)</span> に写す. ゲームの有限性より、いつかはそのまま終盤局面に写せて勝てる. 従って先手必勝.</li>
<li><span class="math inline">\(g=0\)</span> のときは逆. つまり、どんな手を打っても、相手には <span class="math inline">\(g \ne 0\)</span> なる局面を渡すことになる. これは先に示したように先手必勝なので、相手が勝つ. 従って後手必勝.</li>
</ol>
<p>以上.</p>
</body>
</html>
