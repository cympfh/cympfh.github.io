% Fri Feb 28 21:33:43 JST 2014

## MacBook Pro (with Retina; US arranged keyborard) に Ubuntu13.10 を入れて環境を整えるまでにしたことのメモ

## 結論

実用のために、MacBookProでLinuxするための選択肢は Unity しかないことに註意。
でも私はいくつかの設定のために結果的に xfce を経由した。

大変に満足してる。怖がらずさっさとすべきだった。
いくつか不満がある。どうにかしよう。

## インストール手法

基本的には
http://blog.echarles.net/2013/10/01/Ubuntu-13.04-On-MacbookPro-Retina
の通りにしてなんの問題もない。
私が入れたのは、Ubuntu 13.10 で、その記事とは違うけど

## 補遺

### rEFit
で Linux 用と Linux swap 用に２つパーティションを新しく設けたけど Linux swap 用はいらなかったかも。Linux installer が勝手にやってくれる。
つまり手で設ける必要はなかった…？

### インターネット
Ubuntuインストールの際に、電源が接続されてることと同様に
インターネットに接続されてることが要求される。
接続されてないと「次へ」がクリックできないはず。
MacBookだから、有線LAN + thunderboltへのアダプタ が必要。
PCの電源入れる時点でアダプタで接続していれば、認識された。

### ブートローダ (rEFit & GRUB2)
Linuxをインストールしたのち、PCの電源を入れると、
ブートローダである rEFit が起動して、
そのあとUbuntu採択のブートローダであるGRUB2が起動する。
二回もOSを選ぶチャンスがある。
rEFitは画面が綺麗でいいんだけど、GRUB2はできればスキップしたい。

### touchpad
先の url に書かれてるような touchpad の設定は必要なのか必要でないのか
結局よくわからない。
ただよくよく間違えてクリックしてしまう。
Macデフォルトの、クリック音がするまで押し込まないとクリックではなくて、
これはタッチだけでクリックがデフォルトで買える方法は思いつかない

### sleep mode
についてはさっきの url に書かれてる通り。
じゃないと、蓋を閉じると一瞬でPCの電源が消える仕様になってしまう。
nvida と文字列が入ってて最も大きな数字が含まれてる行を選択した。

あとで書くけど、これはUnity の場合のみに、うまく動くことを確認した。
蓋を閉じると、リンゴのマークが一旦消えて、
すぐ二回、点滅して (ちょっと不気味) から消える。
蓋を開けてなんかキーを押せば (電源キーだったか？) すぐログインできる。
なんの問題もない。

### Function keys
Macのデフォルトの動作になる。つまり、F10 キーをそのまま押すとミュートのトグルとして働き、Fn + F10 でF10というキーになる。
変えられるかな？別にこれはこれでいいけど。

### キー入れ替え
MBP英字配列では私は次の２つの入れ替えを行いたい。

1. CapsLock を Ctrl にする
2. 左Command (Super key 扱い) を Alt にする

1つ目は、前から普通に .bashrc に書いてた設定として

    setxkbmap -option ctrl:nocaps

.bashrc に書いてるから一旦bash起動しないと効かないけど、
いつも私こうしてた。

2つ目として、スペースバーのすぐ隣はAltが良い。
これは今のところどうにもなってない。
それどころか、AltもCommandもSuper key になってそう

(http://asukiaaa.blogspot.jp/2013/12/ubuntu1310-capslockctrl.html)

Caps -> Ctrol も Super -> Meta も

    sudo apt-get install gnome-tweak-tool

でいける。はじめから全部GNOMEにしておけば幸せ、だったらいいのに。

### IME

    sudo apt-get install ibus-mozc

がんばって、
設定からまず ibus を使うことと、日本語IMEとしてMozcを使うことを教える。

## xfce

いくつかの不便から

    sudo apt-get install xubuntu-desktop

で xfce にした。これはいくつかの設定を行うために必要だったけれど、
最終的にはUnityにした。はじめの結論にも書いたとおりである。

不満点

- IMEの設定ができない
- IME切り替え (Ctrl + Space) の反応が大変に悪い (一時的なものだった)
- 単純にUnityが嫌い、xfceが好き (これは今でも変わらない)

さて、また、
スペースバーのすぐ隣が Command key であるが、これは Super key (Windows key) として扱われるらしい。
誰もこんなキーは欲しくない。Altにしようと思ったけどうまく行かなかった。
`setxkbmap` は、一瞬で設定が戻る。
`/usr/share/X11/xkb/keycodes/evdev` で書き換えるのは、PC をスリープさせて (蓋を閉じて) 復帰すると
また設定が戻ってた。様子見

### IME

普通にMozcの設定ができる。
辞書のインポートとか各種設定を行うこと。
Control + Space でのIME切り替えがストレスなくできるようになった。
あとでUnityに戻したけど問題がなくなった。よくわからない。

### xfce の問題点

見た目ならxubuntu は大変クールなのでこれを使い続けたいのだけどそうもいかなそう。

- 蓋を閉じても手動でもスリープあるいはサスペンドがうまくできない。
- ショートカットキーが設定できない。(Setting -> Keyboard)
    + したがってせっかくキーボードにあるのに音量調整とかバックライト調整が行えない
- キーボードバックライトはそもそも使えない

# 3/2 追記

こんなこと言いたくないけど、
何度かPCのシャットダウンと起動を繰り返すと、動作が安定してきた。
安定してきたので、やっぱりやっぱり xfce にした。
ボリュームの調整はキーボードでできる。

今はちょっとできないけど。できた時もある。

- ディスプレイのバックライトは常に全力。
- キーボードのバックライトは使えない。
- タッチパッドがやたら反応するのは xfce の setting -> "Mouse and Touchpad" の "Touchpad" の項目、"Disable touchpad while typing" で極端に避けられるよう。
- suspend はやっぱり怪しい
- 電力消費も半端じゃない
    + というか、ステータスバーに電池のアイコンが出ない (hint: acpiコマンド)

これを承知でもxfceのが結局一番といろんなデスクトップやらタイル型wmまで一人ツアーしてきて思いました終わり。
