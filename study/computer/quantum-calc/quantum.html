<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <title>量子計算</title>
  <style type="text/css">code{white-space: pre;}</style>
  <link rel="stylesheet" href="../../../resources/css/c.css">
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header>
<h1 class="title">量子計算</h1>
</header>
<p>ここではあくまでも計算モデルとして量子計算を眺め、なにが実現出来るかを調べる. つまり物理学的な視点にはあまり興味がない.</p>
<h2 id="index">INDEX</h2>
<div id="toc">

</div>
<h2 id="qbit-量子ビット-qbit-qubit">qbit (量子ビット, Qbit, qubit)</h2>
<p>古典コンピュータにおける計算にはbitを用いる. これは <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0</mn><annotation encoding="application/x-tex">0</annotation></semantics></math> または <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>1</mn><annotation encoding="application/x-tex">1</annotation></semantics></math> のいずれかの状態を取るものである. 一方で、qbit はこの2つの状態を重ねあわせて持つ. 具体的には2つの状態を線型結合として記述される.</p>
<p>qbit が <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0</mn><annotation encoding="application/x-tex">0</annotation></semantics></math> である状態を <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mn>0</mn><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">|0\rangle</annotation></semantics></math>、 qbit が <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>1</mn><annotation encoding="application/x-tex">1</annotation></semantics></math> である状態を <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mn>1</mn><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">|1\rangle</annotation></semantics></math> と書く (bra-ket記法).</p>
<p>一般にはこれらの重ねあわせ (線型結合): <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo stretchy="false" form="prefix">|</mo><mn>0</mn><mo stretchy="false" form="postfix">⟩</mo><mo>+</mo><mi>β</mi><mo stretchy="false" form="prefix">|</mo><mn>1</mn><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">\alpha |0\rangle + \beta |1\rangle</annotation></semantics></math> で表される. ここで <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>,</mo><mi>β</mi></mrow><annotation encoding="application/x-tex">\alpha, \beta</annotation></semantics></math> は <strong>虚数</strong>. ただし物理学の要請から、 <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mi>α</mi><msup><mo stretchy="false" form="prefix">|</mo><mn>2</mn></msup><mo>+</mo><mo stretchy="false" form="prefix">|</mo><mi>β</mi><msup><mo stretchy="false" form="prefix">|</mo><mn>2</mn></msup><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">|\alpha|^2 + |\beta|^2 = 1</annotation></semantics></math> という係数の制約がある.</p>
<blockquote>
<p>実数 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math> について <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mi>α</mi><msup><mo stretchy="false" form="prefix">|</mo><mn>2</mn></msup><mo>=</mo><msup><mi>α</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">|\alpha|^2 = \alpha^2</annotation></semantics></math>. 虚数 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math> について <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mi>α</mi><msup><mo stretchy="false" form="prefix">|</mo><mn>2</mn></msup><mo>=</mo><msup><mi>α</mi><mo>*</mo></msup><mi>α</mi></mrow><annotation encoding="application/x-tex">|\alpha|^2 = \alpha^* \alpha</annotation></semantics></math>.</p>
</blockquote>
<h3 id="観測">観測</h3>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mi>α</mi><msup><mo stretchy="false" form="prefix">|</mo><mn>2</mn></msup><mo>+</mo><mo stretchy="false" form="prefix">|</mo><mi>β</mi><msup><mo stretchy="false" form="prefix">|</mo><mn>2</mn></msup><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">|\alpha|^2 + |\beta|^2 = 1</annotation></semantics></math> とあるが、これらは確率を意味する. すなわち、 qbit <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo stretchy="false" form="prefix">|</mo><mn>0</mn><mo stretchy="false" form="postfix">⟩</mo><mo>+</mo><mi>β</mi><mo stretchy="false" form="prefix">|</mo><mn>1</mn><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">\alpha |0\rangle + \beta |1\rangle</annotation></semantics></math> を実際に観測すると、 確率 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mi>α</mi><msup><mo stretchy="false" form="prefix">|</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">|\alpha|^2</annotation></semantics></math> で <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mn>0</mn><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">|0\rangle</annotation></semantics></math> を得、 確率 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mi>β</mi><msup><mo stretchy="false" form="prefix">|</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">|\beta|^2</annotation></semantics></math> で <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mn>1</mn><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">|1\rangle</annotation></semantics></math> を得る. 観測という行為は qbit に干渉する. 例えば <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mn>0</mn><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">|0\rangle</annotation></semantics></math> を得たとき、 qbit <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo stretchy="false" form="prefix">|</mo><mn>0</mn><mo stretchy="false" form="postfix">⟩</mo><mo>+</mo><mi>β</mi><mo stretchy="false" form="prefix">|</mo><mn>1</mn><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">\alpha |0\rangle + \beta |1\rangle</annotation></semantics></math> は <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mn>0</mn><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">|0\rangle</annotation></semantics></math> に変化するという性質を持つ. もちろん <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mn>0</mn><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">|0\rangle</annotation></semantics></math> はそれ以降、いくら観測しても <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mn>0</mn><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">|0\rangle</annotation></semantics></math> のままである.</p>
<h3 id="n-qbit"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math> qbit</h3>
<p>bit と同様に <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math> 個の qbit を並べた場合を <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math> qbit として考える.</p>
<ul>
<li>自由に一列に並べられる</li>
<li>自由に一部を取り出せる</li>
<li>自由に一部だけを観測できる</li>
</ul>
<p>簡単に <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">n=2</annotation></semantics></math> とする. 1つ目が <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mn>0</mn><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">|0\rangle</annotation></semantics></math> で 2つ目が <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mn>1</mn><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">|1\rangle</annotation></semantics></math> であるとき、 それらを並べて出来る 2 qbit の状態を <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mn>01</mn><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">|01\rangle</annotation></semantics></math> であると書く. すると 2 qbitは <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mn>00</mn><mo stretchy="false" form="postfix">⟩</mo><mo>,</mo><mo stretchy="false" form="prefix">|</mo><mn>01</mn><mo stretchy="false" form="postfix">⟩</mo><mo>,</mo><mo stretchy="false" form="prefix">|</mo><mn>10</mn><mo stretchy="false" form="postfix">⟩</mo><mo>,</mo><mo stretchy="false" form="prefix">|</mo><mn>11</mn><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">|00\rangle, |01\rangle, |10\rangle, |11\rangle</annotation></semantics></math></p>
<p>の四通りの状態を取り得、これらの線型結合で一般には表される. すなわち、</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>α</mi><mn>00</mn></msub><mo stretchy="false" form="prefix">|</mo><mn>00</mn><mo stretchy="false" form="postfix">⟩</mo><mo>+</mo><msub><mi>α</mi><mn>01</mn></msub><mo stretchy="false" form="prefix">|</mo><mn>01</mn><mo stretchy="false" form="postfix">⟩</mo><mo>+</mo><msub><mi>α</mi><mn>10</mn></msub><mo stretchy="false" form="prefix">|</mo><mn>10</mn><mo stretchy="false" form="postfix">⟩</mo><mo>+</mo><msub><mi>α</mi><mn>11</mn></msub><mo stretchy="false" form="prefix">|</mo><mn>11</mn><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">\alpha_{00} |00\rangle + \alpha_{01} |01\rangle + \alpha_{10} |10\rangle + \alpha_{11} |11\rangle</annotation></semantics></math></p>
<p>が一般の 2 qbit の表現である. 係数の制約は <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><msub><mi>α</mi><mn>00</mn></msub><msup><mo stretchy="false" form="prefix">|</mo><mn>2</mn></msup><mo>+</mo><mo stretchy="false" form="prefix">|</mo><msub><mi>α</mi><mn>01</mn></msub><msup><mo stretchy="false" form="prefix">|</mo><mn>2</mn></msup><mo>+</mo><mo stretchy="false" form="prefix">|</mo><msub><mi>α</mi><mn>10</mn></msub><msup><mo stretchy="false" form="prefix">|</mo><mn>2</mn></msup><mo>+</mo><mo stretchy="false" form="prefix">|</mo><msub><mi>α</mi><mn>11</mn></msub><msup><mo stretchy="false" form="prefix">|</mo><mn>2</mn></msup><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">|\alpha_{00}|^2 + |\alpha_{01}|^2 + |\alpha_{10}|^2 + |\alpha_{11}|^2 = 1</annotation></semantics></math> であって、それぞれがそれぞれを観測する確率になる.</p>
<p>それぞれが <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>α</mi><mn>1</mn></msub><mo stretchy="false" form="prefix">|</mo><mn>0</mn><mo stretchy="false" form="postfix">⟩</mo><mo>+</mo><msub><mi>β</mi><mn>1</mn></msub><mo stretchy="false" form="prefix">|</mo><mn>1</mn><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">\alpha_1 |0\rangle + \beta_1 |1\rangle</annotation></semantics></math> と <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>α</mi><mn>2</mn></msub><mo stretchy="false" form="prefix">|</mo><mn>0</mn><mo stretchy="false" form="postfix">⟩</mo><mo>+</mo><msub><mi>β</mi><mn>2</mn></msub><mo stretchy="false" form="prefix">|</mo><mn>1</mn><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">\alpha_2 |0\rangle + \beta_2 |1\rangle</annotation></semantics></math> だったとする. 観測する確率は qbit 毎に独立だとすると、</p>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><msub><mi>α</mi><mn>00</mn></msub><msup><mo stretchy="false" form="prefix">|</mo><mn>2</mn></msup><mo>=</mo><mo stretchy="false" form="prefix">|</mo><msub><mi>α</mi><mn>1</mn></msub><msup><mo stretchy="false" form="prefix">|</mo><mn>2</mn></msup><mo stretchy="false" form="prefix">|</mo><msub><mi>α</mi><mn>2</mn></msub><msup><mo stretchy="false" form="prefix">|</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">|\alpha_{00}|^2 = |\alpha_1|^2 |\alpha_2|^2</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><msub><mi>α</mi><mn>01</mn></msub><msup><mo stretchy="false" form="prefix">|</mo><mn>2</mn></msup><mo>=</mo><mo stretchy="false" form="prefix">|</mo><msub><mi>α</mi><mn>1</mn></msub><msup><mo stretchy="false" form="prefix">|</mo><mn>2</mn></msup><mo stretchy="false" form="prefix">|</mo><msub><mi>β</mi><mn>2</mn></msub><msup><mo stretchy="false" form="prefix">|</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">|\alpha_{01}|^2 = |\alpha_1|^2 |\beta_2|^2</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><msub><mi>α</mi><mn>10</mn></msub><msup><mo stretchy="false" form="prefix">|</mo><mn>2</mn></msup><mo>=</mo><mo stretchy="false" form="prefix">|</mo><msub><mi>β</mi><mn>1</mn></msub><msup><mo stretchy="false" form="prefix">|</mo><mn>2</mn></msup><mo stretchy="false" form="prefix">|</mo><msub><mi>α</mi><mn>2</mn></msub><msup><mo stretchy="false" form="prefix">|</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">|\alpha_{10}|^2 = |\beta_1|^2 |\alpha_2|^2</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><msub><mi>α</mi><mn>11</mn></msub><msup><mo stretchy="false" form="prefix">|</mo><mn>2</mn></msup><mo>=</mo><mo stretchy="false" form="prefix">|</mo><msub><mi>β</mi><mn>1</mn></msub><msup><mo stretchy="false" form="prefix">|</mo><mn>2</mn></msup><mo stretchy="false" form="prefix">|</mo><msub><mi>β</mi><mn>2</mn></msub><msup><mo stretchy="false" form="prefix">|</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">|\alpha_{11}|^2 = |\beta_1|^2 |\beta_2|^2</annotation></semantics></math></li>
</ul>
<p>であることが確認できて、実際そう.</p>
<h4 id="部分的観測">部分的観測</h4>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math> qbit の内 1つの qbit (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo stretchy="false" form="prefix">|</mo><mn>0</mn><mo stretchy="false" form="postfix">⟩</mo><mo>+</mo><mi>β</mi><mo stretchy="false" form="prefix">|</mo><mn>1</mn><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">\alpha |0\rangle + \beta |1\rangle</annotation></semantics></math>) を観測した結果、 その qbit の状態は先述したとおり、観測された状態に確定して固定されるが、 残りの <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n-1</annotation></semantics></math> qbit についてはなおも重ね合わせの状態を保ったままで観測が干渉することはない.</p>
<p>例として、 2 qbit <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>α</mi><mn>00</mn></msub><mo stretchy="false" form="prefix">|</mo><mn>00</mn><mo stretchy="false" form="postfix">⟩</mo><mo>+</mo><msub><mi>α</mi><mn>01</mn></msub><mo stretchy="false" form="prefix">|</mo><mn>01</mn><mo stretchy="false" form="postfix">⟩</mo><mo>+</mo><msub><mi>α</mi><mn>10</mn></msub><mo stretchy="false" form="prefix">|</mo><mn>10</mn><mo stretchy="false" form="postfix">⟩</mo><mo>+</mo><msub><mi>α</mi><mn>11</mn></msub><mo stretchy="false" form="prefix">|</mo><mn>11</mn><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">\alpha_{00} |00\rangle + \alpha_{01} |01\rangle + \alpha_{10} |10\rangle + \alpha_{11} |11\rangle</annotation></semantics></math></p>
<p>の 1 qbit 目を観測した結果 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mn>0</mn><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">|0\rangle</annotation></semantics></math> を得たとする. 1 qbit 目は <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0</mn><annotation encoding="application/x-tex">0</annotation></semantics></math> で固定されるので、 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mn>10</mn><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">|10\rangle</annotation></semantics></math>, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mn>11</mn><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">|11\rangle</annotation></semantics></math> は最早得られない. 従って 2 qbit は、 <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>α</mi><mn>00</mn></msub><mi>′</mi><mo stretchy="false" form="prefix">|</mo><mn>00</mn><mo stretchy="false" form="postfix">⟩</mo><mo>+</mo><msub><mi>α</mi><mn>01</mn></msub><mi>′</mi><mo stretchy="false" form="prefix">|</mo><mn>01</mn><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">\alpha_{00}&#39; |00\rangle + \alpha_{01}&#39; |01\rangle</annotation></semantics></math></p>
<p>で表される.</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>α</mi><mn>00</mn></msub><mi>′</mi></mrow><annotation encoding="application/x-tex">\alpha_{00}&#39;</annotation></semantics></math>, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>α</mi><mn>01</mn></msub><mi>′</mi></mrow><annotation encoding="application/x-tex">\alpha_{01}&#39;</annotation></semantics></math> はどうなるかと言うと、これらは結局、2 qbit 目が <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mn>0</mn><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">|0\rangle</annotation></semantics></math>, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mn>1</mn><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">|1\rangle</annotation></semantics></math> で観測される確率 (の閉包根) であって、 (それは観測の前後で変化しない)</p>
<p>元の 2 qbit が <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>α</mi><mn>1</mn></msub><mo stretchy="false" form="prefix">|</mo><mn>0</mn><mo stretchy="false" form="postfix">⟩</mo><mo>+</mo><msub><mi>β</mi><mn>1</mn></msub><mo stretchy="false" form="prefix">|</mo><mn>1</mn><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">\alpha_1 |0\rangle + \beta_1 |1\rangle</annotation></semantics></math> と <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>α</mi><mn>2</mn></msub><mo stretchy="false" form="prefix">|</mo><mn>0</mn><mo stretchy="false" form="postfix">⟩</mo><mo>+</mo><msub><mi>β</mi><mn>2</mn></msub><mo stretchy="false" form="prefix">|</mo><mn>1</mn><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">\alpha_2 |0\rangle + \beta_2 |1\rangle</annotation></semantics></math> だったとすると、</p>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>α</mi><mn>00</mn></msub><mi>′</mi><mo>=</mo><msub><mi>α</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\alpha_{00}&#39; = \alpha_2</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>α</mi><mn>01</mn></msub><mi>′</mi><mo>=</mo><msub><mi>β</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\alpha_{01}&#39; = \beta_2</annotation></semantics></math></li>
</ul>
<p>先ほど見た結果を使うと (絶対値などという細かなことを無視すると)</p>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>α</mi><mn>00</mn></msub><mi>′</mi><mo>=</mo><msub><mi>α</mi><mn>2</mn></msub><mo>=</mo><msub><mi>α</mi><mn>00</mn></msub><mi>/</mi><msub><mi>α</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\alpha_{00}&#39; = \alpha_2 = \alpha_{00} / \alpha_1</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>α</mi><mn>01</mn></msub><mi>′</mi><mo>=</mo><msub><mi>β</mi><mn>2</mn></msub><mo>=</mo><msub><mi>α</mi><mn>01</mn></msub><mi>/</mi><msub><mi>α</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\alpha_{01}&#39; = \beta_2 = \alpha_{01} / \alpha_1</annotation></semantics></math></li>
</ul>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>α</mi><mn>1</mn></msub><annotation encoding="application/x-tex">\alpha_1</annotation></semantics></math> の逆数を単に定数 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>κ</mi><annotation encoding="application/x-tex">\kappa</annotation></semantics></math> と書いて以上を改めてまとめると、</p>
<ul>
<li>2 qbit <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>α</mi><mn>00</mn></msub><mo stretchy="false" form="prefix">|</mo><mn>00</mn><mo stretchy="false" form="postfix">⟩</mo><mo>+</mo><msub><mi>α</mi><mn>01</mn></msub><mo stretchy="false" form="prefix">|</mo><mn>01</mn><mo stretchy="false" form="postfix">⟩</mo><mo>+</mo><msub><mi>α</mi><mn>10</mn></msub><mo stretchy="false" form="prefix">|</mo><mn>10</mn><mo stretchy="false" form="postfix">⟩</mo><mo>+</mo><msub><mi>α</mi><mn>11</mn></msub><mo stretchy="false" form="prefix">|</mo><mn>11</mn><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">\alpha_{00} |00\rangle + \alpha_{01} |01\rangle + \alpha_{10} |10\rangle + \alpha_{11} |11\rangle</annotation></semantics></math></li>
<li>1 qbit 目を観測して <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mn>0</mn><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">|0\rangle</annotation></semantics></math> を得た</li>
<li>2 qbit <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>κ</mi><msub><mi>α</mi><mn>00</mn></msub><mo stretchy="false" form="prefix">|</mo><mn>00</mn><mo stretchy="false" form="postfix">⟩</mo><mo>+</mo><mi>κ</mi><msub><mi>α</mi><mn>01</mn></msub><mo stretchy="false" form="prefix">|</mo><mn>01</mn><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">\kappa \alpha_{00} |00\rangle + \kappa \alpha_{01} |01\rangle</annotation></semantics></math></li>
</ul>
<p>観測の結果あり得ない状態を消して (係数をゼロにして) 他の係数は定数 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>κ</mi><annotation encoding="application/x-tex">\kappa</annotation></semantics></math> 倍する. 係数の自乗和が <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>1</mn><annotation encoding="application/x-tex">1</annotation></semantics></math> (全確率が <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>1</mn><annotation encoding="application/x-tex">1</annotation></semantics></math>) という制約から <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>κ</mi><annotation encoding="application/x-tex">\kappa</annotation></semantics></math> の値は決定する.</p>
<h2 id="量子ゲート">量子ゲート</h2>
<p>量子に対する実現可能な操作で次のようなゲートを作成することが理論上可能.</p>
<h3 id="量子not">量子NOT</h3>
<p>次のような <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math> が存在する:</p>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo stretchy="false" form="prefix">|</mo><mn>0</mn><mo stretchy="false" form="postfix">⟩</mo><mo>=</mo><mo stretchy="false" form="prefix">|</mo><mn>1</mn><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">X |0\rangle = |1\rangle</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo stretchy="false" form="prefix">|</mo><mn>1</mn><mo stretchy="false" form="postfix">⟩</mo><mo>=</mo><mo stretchy="false" form="prefix">|</mo><mn>0</mn><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">X |1\rangle = |0\rangle</annotation></semantics></math></li>
</ul>
<p>この2つは即ち、 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo stretchy="false" form="prefix">(</mo><mi>α</mi><mo stretchy="false" form="prefix">|</mo><mn>0</mn><mo stretchy="false" form="postfix">⟩</mo><mo>+</mo><mi>β</mi><mo stretchy="false" form="prefix">|</mo><mn>1</mn><mo stretchy="false" form="postfix">⟩</mo><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mi>β</mi><mo stretchy="false" form="prefix">|</mo><mn>0</mn><mo stretchy="false" form="postfix">⟩</mo><mo>+</mo><mi>α</mi><mo stretchy="false" form="prefix">|</mo><mn>1</mn><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">X (\alpha |0\rangle + \beta |1\rangle) = \beta |0\rangle + \alpha |1\rangle</annotation></semantics></math> であると言っている.</p>
<h3 id="制御-controlled-not">制御 (controlled) NOT</h3>
<p>次のような 2 qbit に対する操作 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math> が存在する:</p>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo stretchy="false" form="prefix">|</mo><mi>α</mi><mo>,</mo><mi>β</mi><mo stretchy="false" form="postfix">⟩</mo><mo>=</mo><mo stretchy="false" form="prefix">|</mo><mi>α</mi><mo>,</mo><mi>α</mi><mo>⊕</mo><mi>β</mi><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">X |\alpha, \beta \rangle = |\alpha, \alpha \oplus \beta \rangle</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo stretchy="false" form="prefix">|</mo><mi>α</mi><mo>,</mo><mi>β</mi><mo stretchy="false" form="postfix">⟩</mo><mo>=</mo><mo stretchy="false" form="prefix">|</mo><mi>α</mi><mo>,</mo><mi>α</mi><mo>⊕</mo><mi>β</mi><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">X |\alpha, \beta \rangle = |\alpha, \alpha \oplus \beta \rangle</annotation></semantics></math></li>
</ul>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>⊕</mo><annotation encoding="application/x-tex">\oplus</annotation></semantics></math> は排他的論理で、 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>⊕</mo><mi>β</mi><mo>=</mo><mi>β</mi></mrow><annotation encoding="application/x-tex">0 \oplus \beta = \beta</annotation></semantics></math>、 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>⊕</mo><mi>β</mi><mo>=</mo><mn>1</mn><mo>−</mo><mi>β</mi></mrow><annotation encoding="application/x-tex">1 \oplus \beta = 1 - \beta</annotation></semantics></math>.</p>
<h3 id="アダマール-hadamard-ゲート">アダマール (Hadamard) ゲート</h3>
<p>次のような <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>H</mi><annotation encoding="application/x-tex">H</annotation></semantics></math> が存在する:</p>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo stretchy="false" form="prefix">|</mo><mn>0</mn><mo stretchy="false" form="postfix">⟩</mo><mo>=</mo><mfrac><mn>1</mn><msqrt><mn>2</mn></msqrt></mfrac><mo stretchy="false" form="prefix">|</mo><mn>0</mn><mo stretchy="false" form="postfix">⟩</mo><mo>+</mo><mfrac><mn>1</mn><msqrt><mn>2</mn></msqrt></mfrac><mo stretchy="false" form="prefix">|</mo><mn>1</mn><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">H |0\rangle = \frac{1}{\sqrt{2}} |0\rangle + \frac{1}{\sqrt{2}} |1\rangle</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo stretchy="false" form="prefix">|</mo><mn>1</mn><mo stretchy="false" form="postfix">⟩</mo><mo>=</mo><mfrac><mn>1</mn><msqrt><mn>2</mn></msqrt></mfrac><mo stretchy="false" form="prefix">|</mo><mn>0</mn><mo stretchy="false" form="postfix">⟩</mo><mo>−</mo><mfrac><mn>1</mn><msqrt><mn>2</mn></msqrt></mfrac><mo stretchy="false" form="prefix">|</mo><mn>1</mn><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">H |1\rangle = \frac{1}{\sqrt{2}} |0\rangle - \frac{1}{\sqrt{2}} |1\rangle</annotation></semantics></math></li>
</ul>
<h4 id="n.b.">N.B.</h4>
<p>ちょうど一つの量子を得ることができれば、観測してみることで <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mn>0</mn><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">|0\rangle</annotation></semantics></math>, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mn>1</mn><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">|1\rangle</annotation></semantics></math> を得ることができる. アダマールゲートは観測した上で二種類重ね合わせの状態の量子を得られる. そのに種類は確かに異なるものだが、両者とも 「同確率で <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mn>0</mn><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">|0\rangle</annotation></semantics></math>, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mn>1</mn><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">|1\rangle</annotation></semantics></math> が観測される」ような量子である.</p>
<p>また <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>H</mi><annotation encoding="application/x-tex">H</annotation></semantics></math> は二回通すことで恒等写像になることがわかる.</p>
<p>また <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>H</mi><annotation encoding="application/x-tex">H</annotation></semantics></math> を組み合わせることで、 全ての <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mn>2</mn><mi>n</mi></msup><annotation encoding="application/x-tex">2^n</annotation></semantics></math> 状態が等確率で観測できる <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math> qbit を作ることができる.</p>
<h2 id="量子並列性">量子並列性</h2>
<p>古典回路で計算できるビット操作 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>f</mi><annotation encoding="application/x-tex">f</annotation></semantics></math> について、同程度の効率で計算できる次のような量子ゲート <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>U</mi><mi>f</mi></msub><annotation encoding="application/x-tex">U_f</annotation></semantics></math> が存在する:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>U</mi><mi>f</mi></msub><mo stretchy="false" form="prefix">|</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">⟩</mo><mo>=</mo><mo stretchy="false" form="prefix">|</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>⊕</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">U_f |x,y\rangle = |x, y \oplus f(x) \rangle</annotation></semantics></math></p>
<p>アダマールは2つの状態を全く同等に含んだ量子を作れるから、<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>U</mi><mi>f</mi></msub><annotation encoding="application/x-tex">U_f</annotation></semantics></math> を用いて、 実質的に <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">f(0)</annotation></semantics></math> と <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mn>1</mn><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">f(1)</annotation></semantics></math> を並列に計算するようなことができる. 具体的には次を実行する.</p>
<ol type="1">
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo stretchy="false" form="prefix">|</mo><mn>0</mn><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">H |0\rangle</annotation></semantics></math> に <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mn>0</mn><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">|0\rangle</annotation></semantics></math> を並べる
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo stretchy="false" form="prefix">|</mo><mn>0</mn><mo stretchy="false" form="postfix">⟩</mo><mo>⋅</mo><mo stretchy="false" form="prefix">|</mo><mn>1</mn><mo stretchy="false" form="postfix">⟩</mo><mo>=</mo><mfrac><mn>1</mn><msqrt><mn>2</mn></msqrt></mfrac><mo stretchy="false" form="prefix">|</mo><mn>00</mn><mo stretchy="false" form="postfix">⟩</mo><mo>+</mo><mfrac><mn>1</mn><msqrt><mn>2</mn></msqrt></mfrac><mo stretchy="false" form="prefix">|</mo><mn>10</mn><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">H|0\rangle \cdot |1\rangle = \frac{1}{\sqrt{2}} |00\rangle + \frac{1}{\sqrt{2}} |10\rangle</annotation></semantics></math></li>
</ul></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>U</mi><mi>f</mi></msub><annotation encoding="application/x-tex">U_f</annotation></semantics></math> に通す
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><msqrt><mn>2</mn></msqrt></mfrac><mo stretchy="false" form="prefix">|</mo><mn>0</mn><mo>,</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">⟩</mo><mo>+</mo><mfrac><mn>1</mn><msqrt><mn>2</mn></msqrt></mfrac><mo stretchy="false" form="prefix">|</mo><mn>1</mn><mo>,</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mn>1</mn><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">\frac{1}{\sqrt{2}} |0, f(0)\rangle + \frac{1}{\sqrt{2}} |1, f(1)\rangle</annotation></semantics></math></li>
</ul></li>
</ol>
<p>一度の <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>U</mi><mi>f</mi></msub><annotation encoding="application/x-tex">U_f</annotation></semantics></math> の計算で <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">f(0)</annotation></semantics></math> と <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mn>1</mn><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">f(1)</annotation></semantics></math> が行われているのが分かる. この性質を量子並列性というが、これをこのまま観測するだけでは結局、一通りの結果 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mi>x</mi><mo>,</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">|x, f(x)\rangle</annotation></semantics></math> しか得られない. 並列性のメリットを享受するには工夫が必要である. その古典的な一例であるドイチュのアルゴリズムを次に見る.</p>
<h2 id="ドイチュのアルゴリズム-deutsch-algorithm">ドイチュのアルゴリズム (Deutsch algorithm)</h2>
<p>bit操作 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>f</mi><annotation encoding="application/x-tex">f</annotation></semantics></math> について <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo stretchy="false" form="postfix">)</mo><mo>⊕</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mn>1</mn><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">f(0) \oplus f(1)</annotation></semantics></math> を一度の <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>U</mi><mi>f</mi></msub><annotation encoding="application/x-tex">U_f</annotation></semantics></math> (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>f</mi><annotation encoding="application/x-tex">f</annotation></semantics></math> 相当の計算) で計算するアルゴリズム.</p>
<p>アルゴリズムは次の 4 step から成る.</p>
<ol type="1">
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mo>+</mo><mo stretchy="false" form="postfix">⟩</mo><mo>=</mo><mi>H</mi><mo stretchy="false" form="prefix">|</mo><mn>0</mn><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">|+\rangle = H |0\rangle</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mo>−</mo><mo stretchy="false" form="postfix">⟩</mo><mo>=</mo><mi>H</mi><mo stretchy="false" form="prefix">|</mo><mn>1</mn><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">|-\rangle = H |1\rangle</annotation></semantics></math>
<ul>
<li>2つを並べたものを <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mo>+</mo><mo stretchy="false" form="postfix">⟩</mo><mo>⋅</mo><mo stretchy="false" form="prefix">|</mo><mo>−</mo><mo stretchy="false" form="postfix">⟩</mo><mo>=</mo><mo stretchy="false" form="prefix">|</mo><mo>+</mo><mo>−</mo><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">|+\rangle \cdot |-\rangle = |+-\rangle</annotation></semantics></math> とする</li>
</ul></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><msub><mi>ϕ</mi><mn>1</mn></msub><mo>,</mo><msub><mi>ϕ</mi><mn>2</mn></msub><mo stretchy="false" form="postfix">⟩</mo><mo>=</mo><msub><mi>U</mi><mi>f</mi></msub><mo stretchy="false" form="prefix">|</mo><mo>+</mo><mo>−</mo><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">|\phi_1, \phi_2 \rangle = U_f |+-\rangle</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo stretchy="false" form="prefix">|</mo><msub><mi>ϕ</mi><mn>1</mn></msub><mo>,</mo><msub><mi>ϕ</mi><mn>2</mn></msub><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">H |\phi_1, \phi_2 \rangle</annotation></semantics></math> の 1 qbit 目を観測
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo stretchy="false" form="prefix">|</mo><msub><mi>ϕ</mi><mn>1</mn></msub><mo>,</mo><msub><mi>ϕ</mi><mn>2</mn></msub><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">H |\phi_1, \phi_2 \rangle</annotation></semantics></math> とは <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo stretchy="false" form="prefix">|</mo><msub><mi>ϕ</mi><mn>1</mn></msub><mo stretchy="false" form="postfix">⟩</mo><mo>⋅</mo><mi>H</mi><mo stretchy="false" form="prefix">|</mo><msub><mi>ϕ</mi><mn>2</mn></msub><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">H|\phi_1 \rangle \cdot H |\phi_2 \rangle</annotation></semantics></math> のこと</li>
</ul></li>
</ol>
<p>具体的に計算を追う.</p>
<ol start="2" type="1">
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mo>+</mo><mo>−</mo><mo stretchy="false" form="postfix">⟩</mo><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mo stretchy="false" form="prefix">|</mo><mn>0</mn><mo stretchy="false" form="postfix">⟩</mo><mo>+</mo><mo stretchy="false" form="prefix">|</mo><mn>1</mn><mo stretchy="false" form="postfix">⟩</mo><mo stretchy="false" form="postfix">)</mo><mi>/</mi><msqrt><mn>2</mn></msqrt><mo>⋅</mo><mo stretchy="false" form="prefix">(</mo><mo stretchy="false" form="prefix">|</mo><mn>0</mn><mo stretchy="false" form="postfix">⟩</mo><mo>−</mo><mo stretchy="false" form="prefix">|</mo><mn>1</mn><mo stretchy="false" form="postfix">⟩</mo><mo stretchy="false" form="postfix">)</mo><mi>/</mi><msqrt><mn>2</mn></msqrt><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mo stretchy="false" form="prefix">|</mo><mn>00</mn><mo stretchy="false" form="postfix">⟩</mo><mo>−</mo><mo stretchy="false" form="prefix">|</mo><mn>01</mn><mo stretchy="false" form="postfix">⟩</mo><mo>+</mo><mo stretchy="false" form="prefix">|</mo><mn>10</mn><mo stretchy="false" form="postfix">⟩</mo><mo>−</mo><mo stretchy="false" form="prefix">|</mo><mn>11</mn><mo stretchy="false" form="postfix">⟩</mo><mo stretchy="false" form="postfix">)</mo><mi>/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">|+-\rangle = (|0\rangle+|1\rangle)/\sqrt{2} \cdot (|0\rangle - |1\rangle)/\sqrt{2} = (|00\rangle - |01\rangle + |10\rangle - |11\rangle) / 2</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>U</mi><mi>f</mi></msub><mo stretchy="false" form="prefix">|</mo><mo>+</mo><mo>−</mo><mo stretchy="false" form="postfix">⟩</mo><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mo stretchy="false" form="prefix">|</mo><mn>0</mn><mo>,</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">⟩</mo><mo>−</mo><mo stretchy="false" form="prefix">|</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo>−</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">⟩</mo><mo>+</mo><mo stretchy="false" form="prefix">|</mo><mn>1</mn><mo>,</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mn>1</mn><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">⟩</mo><mo>−</mo><mo stretchy="false" form="prefix">|</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo>−</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mn>1</mn><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">⟩</mo><mo stretchy="false" form="postfix">)</mo><mi>/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">U_f |+-\rangle = (|0,f(0)\rangle -|0,1-f(0)\rangle +|1,f(1)\rangle -|1,1-f(1)\rangle)/2</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo stretchy="false" form="prefix">(</mo><msub><mi>U</mi><mi>f</mi></msub><mo stretchy="false" form="prefix">|</mo><mo>+</mo><mo>−</mo><mo stretchy="false" form="postfix">⟩</mo><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mo stretchy="false" form="prefix">|</mo><mi>H</mi><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mi>H</mi><mo stretchy="false" form="prefix">(</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">⟩</mo><mo>−</mo><mo stretchy="false" form="prefix">|</mo><mi>H</mi><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mi>H</mi><mo stretchy="false" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">⟩</mo><mo>+</mo><mo stretchy="false" form="prefix">|</mo><mi>H</mi><mo stretchy="false" form="prefix">(</mo><mn>1</mn><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mi>H</mi><mo stretchy="false" form="prefix">(</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mn>1</mn><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">⟩</mo><mo>−</mo><mo stretchy="false" form="prefix">|</mo><mi>H</mi><mo stretchy="false" form="prefix">(</mo><mn>1</mn><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mi>H</mi><mo stretchy="false" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mn>1</mn><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">⟩</mo><mo stretchy="true" form="postfix">)</mo></mrow><mi>/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">H(U_f |+- \rangle) = \left( |H(0),H(f(0))\rangle -|H(0), H(1-f(0))\rangle +|H(1), H(f(1))\rangle - |H(1), H(1-f(1))\rangle \right)/2</annotation></semantics></math></li>
</ol>
<p>ここで <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo stretchy="false" form="prefix">(</mo><mo stretchy="false" form="prefix">|</mo><mn>0</mn><mo stretchy="false" form="postfix">⟩</mo><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">H(|0\rangle)</annotation></semantics></math> を <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">H(0)</annotation></semantics></math> などと略記した. (もちろん <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo stretchy="false" form="prefix">|</mo><mo>+</mo><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">H(0) = |+\rangle</annotation></semantics></math>, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo stretchy="false" form="prefix">(</mo><mn>1</mn><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo stretchy="false" form="prefix">|</mo><mo>−</mo><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">H(1) = |-\rangle</annotation></semantics></math> のことである.)</p>
<p>最期の式を更に詳細に調べる.</p>
<p>初めの2項 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mi>H</mi><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mi>H</mi><mo stretchy="false" form="prefix">(</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">⟩</mo><mo>−</mo><mo stretchy="false" form="prefix">|</mo><mi>H</mi><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mi>H</mi><mo stretchy="false" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">|H(0),H(f(0))\rangle -|H(0), H(1-f(0))\rangle</annotation></semantics></math> に注目する. <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mn>1</mn><mo>−</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">f(0), 1-f(0)</annotation></semantics></math> はちょうど一方が 0 なら他方は 1 である.</p>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo stretchy="false" form="postfix">)</mo><mo>−</mo><mi>H</mi><mo stretchy="false" form="prefix">(</mo><mn>1</mn><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mspace width="0.222em"></mspace><msqrt><mn>2</mn></msqrt><mspace width="0.222em"></mspace><mo stretchy="false" form="prefix">|</mo><mn>1</mn><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">H(0) - H(1) = ~ \sqrt{2}~|1\rangle</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo stretchy="false" form="prefix">(</mo><mn>1</mn><mo stretchy="false" form="postfix">)</mo><mo>−</mo><mi>H</mi><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo>−</mo><msqrt><mn>2</mn></msqrt><mspace width="0.222em"></mspace><mo stretchy="false" form="prefix">|</mo><mn>1</mn><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">H(1) - H(0) = - \sqrt{2}~|1\rangle</annotation></semantics></math></li>
</ul>
<p>であることを使うと</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mi>H</mi><mo stretchy="false" form="prefix">(</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">⟩</mo><mo>−</mo><mo stretchy="false" form="prefix">|</mo><mi>H</mi><mo stretchy="false" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">⟩</mo><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mo>−</mo><mn>1</mn><msup><mo stretchy="false" form="postfix">)</mo><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo stretchy="false" form="postfix">)</mo></mrow></msup><msqrt><mn>2</mn></msqrt><mspace width="0.222em"></mspace><mo stretchy="false" form="prefix">|</mo><mn>1</mn><mo stretchy="false" form="postfix">⟩</mo><mi>.</mi></mrow><annotation encoding="application/x-tex">|H(f(0))\rangle -|H(1-f(0))\rangle = (-1)^{f(0)} \sqrt{2}~|1\rangle.</annotation></semantics></math> すなわち、 <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mi>H</mi><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mi>H</mi><mo stretchy="false" form="prefix">(</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">⟩</mo><mo>−</mo><mo stretchy="false" form="prefix">|</mo><mi>H</mi><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mi>H</mi><mo stretchy="false" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">⟩</mo><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mo>−</mo><mn>1</mn><msup><mo stretchy="false" form="postfix">)</mo><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo stretchy="false" form="postfix">)</mo></mrow></msup><msqrt><mn>2</mn></msqrt><mspace width="0.222em"></mspace><mo stretchy="false" form="prefix">|</mo><mi>H</mi><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mn>1</mn><mo stretchy="false" form="postfix">⟩</mo><mi>.</mi></mrow><annotation encoding="application/x-tex">|H(0),H(f(0))\rangle -|H(0), H(1-f(0))\rangle
=
(-1)^{f(0)} \sqrt{2}~|H(0), 1\rangle.</annotation></semantics></math></p>
<p>と書ける. 残りの2項についても同様に書きなおせば、</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo stretchy="false" form="prefix">(</mo><msub><mi>U</mi><mi>f</mi></msub><mo stretchy="false" form="prefix">|</mo><mo>+</mo><mo>−</mo><mo stretchy="false" form="postfix">⟩</mo><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mrow><mo stretchy="true" form="prefix">[</mo><mo stretchy="false" form="prefix">(</mo><mo>−</mo><mn>1</mn><msup><mo stretchy="false" form="postfix">)</mo><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo stretchy="false" form="postfix">)</mo></mrow></msup><msqrt><mn>2</mn></msqrt><mspace width="0.222em"></mspace><mo stretchy="false" form="prefix">|</mo><mi>H</mi><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mn>1</mn><mo stretchy="false" form="postfix">⟩</mo><mo>+</mo><mo stretchy="false" form="prefix">(</mo><mo>−</mo><mn>1</mn><msup><mo stretchy="false" form="postfix">)</mo><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mn>1</mn><mo stretchy="false" form="postfix">)</mo></mrow></msup><msqrt><mn>2</mn></msqrt><mspace width="0.222em"></mspace><mo stretchy="false" form="prefix">|</mo><mi>H</mi><mo stretchy="false" form="prefix">(</mo><mn>1</mn><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mn>1</mn><mo stretchy="false" form="postfix">⟩</mo><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">H(U_f |+- \rangle) = \frac{1}{2} \left[
(-1)^{f(0)} \sqrt{2}~|H(0), 1\rangle
+
(-1)^{f(1)} \sqrt{2}~|H(1), 1\rangle
\right]</annotation></semantics></math> <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><mfrac><mn>1</mn><msqrt><mn>2</mn></msqrt></mfrac><mrow><mo stretchy="true" form="prefix">[</mo><mo stretchy="false" form="prefix">(</mo><mo>−</mo><mn>1</mn><msup><mo stretchy="false" form="postfix">)</mo><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo stretchy="false" form="postfix">)</mo></mrow></msup><mspace width="0.222em"></mspace><mo stretchy="false" form="prefix">|</mo><mi>H</mi><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mn>1</mn><mo stretchy="false" form="postfix">⟩</mo><mo>+</mo><mo stretchy="false" form="prefix">(</mo><mo>−</mo><mn>1</mn><msup><mo stretchy="false" form="postfix">)</mo><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mn>1</mn><mo stretchy="false" form="postfix">)</mo></mrow></msup><mspace width="0.222em"></mspace><mo stretchy="false" form="prefix">|</mo><mi>H</mi><mo stretchy="false" form="prefix">(</mo><mn>1</mn><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mn>1</mn><mo stretchy="false" form="postfix">⟩</mo><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">= \frac{1}{\sqrt{2}}\left[
(-1)^{f(0)} ~|H(0), 1\rangle
+
(-1)^{f(1)} ~|H(1), 1\rangle
\right]</annotation></semantics></math></p>
<p>1 qbit 目にだけ注目すると</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><msqrt><mn>2</mn></msqrt></mfrac><mrow><mo stretchy="true" form="prefix">[</mo><mo stretchy="false" form="prefix">(</mo><mo>−</mo><mn>1</mn><msup><mo stretchy="false" form="postfix">)</mo><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo stretchy="false" form="postfix">)</mo></mrow></msup><mspace width="0.222em"></mspace><mo stretchy="false" form="prefix">|</mo><mi>H</mi><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">⟩</mo><mo>+</mo><mo stretchy="false" form="prefix">(</mo><mo>−</mo><mn>1</mn><msup><mo stretchy="false" form="postfix">)</mo><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mn>1</mn><mo stretchy="false" form="postfix">)</mo></mrow></msup><mspace width="0.222em"></mspace><mo stretchy="false" form="prefix">|</mo><mi>H</mi><mo stretchy="false" form="prefix">(</mo><mn>1</mn><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">⟩</mo><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\frac{1}{\sqrt{2}}\left[
(-1)^{f(0)} ~|H(0)\rangle
+
(-1)^{f(1)} ~|H(1)\rangle
\right]</annotation></semantics></math></p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mn>1</mn><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">f(0), f(1)</annotation></semantics></math> によって場合分けをすると</p>
<ol type="1">
<li>case <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mn>0</mn><mo>,</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mn>1</mn><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">f(0)=0, f(1)=0</annotation></semantics></math>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mi>/</mi><msqrt><mn>2</mn></msqrt><mspace width="0.222em"></mspace><mo stretchy="false" form="prefix">|</mo><mi>H</mi><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">⟩</mo><mo>+</mo><mn>1</mn><mi>/</mi><msqrt><mn>2</mn></msqrt><mspace width="0.222em"></mspace><mo stretchy="false" form="prefix">|</mo><mi>H</mi><mo stretchy="false" form="prefix">(</mo><mn>1</mn><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">⟩</mo><mo>=</mo><mo stretchy="false" form="prefix">|</mo><mn>0</mn><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">1/\sqrt{2}~|H(0)\rangle + 1/\sqrt{2}~|H(1)\rangle = |0\rangle</annotation></semantics></math></li>
</ul></li>
<li>case <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mn>0</mn><mo>,</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mn>1</mn><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">f(0)=0, f(1)=1</annotation></semantics></math>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mi>/</mi><msqrt><mn>2</mn></msqrt><mspace width="0.222em"></mspace><mo stretchy="false" form="prefix">|</mo><mi>H</mi><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">⟩</mo><mo>−</mo><mn>1</mn><mi>/</mi><msqrt><mn>2</mn></msqrt><mspace width="0.222em"></mspace><mo stretchy="false" form="prefix">|</mo><mi>H</mi><mo stretchy="false" form="prefix">(</mo><mn>1</mn><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">⟩</mo><mo>=</mo><mo stretchy="false" form="prefix">|</mo><mn>1</mn><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">1/\sqrt{2}~|H(0)\rangle - 1/\sqrt{2}~|H(1)\rangle = |1\rangle</annotation></semantics></math></li>
</ul></li>
<li>case <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mn>1</mn><mo>,</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mn>1</mn><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">f(0)=1, f(1)=0</annotation></semantics></math>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mn>1</mn><mi>/</mi><msqrt><mn>2</mn></msqrt><mspace width="0.222em"></mspace><mo stretchy="false" form="prefix">|</mo><mi>H</mi><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">⟩</mo><mo>+</mo><mn>1</mn><mi>/</mi><msqrt><mn>2</mn></msqrt><mspace width="0.222em"></mspace><mo stretchy="false" form="prefix">|</mo><mi>H</mi><mo stretchy="false" form="prefix">(</mo><mn>1</mn><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">⟩</mo><mo>=</mo><mo>−</mo><mo stretchy="false" form="prefix">|</mo><mn>1</mn><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">-1/\sqrt{2}~|H(0)\rangle + 1/\sqrt{2}~|H(1)\rangle = -|1\rangle</annotation></semantics></math></li>
</ul></li>
<li>case <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mn>1</mn><mo>,</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mn>1</mn><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">f(0)=1, f(1)=1</annotation></semantics></math>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mn>1</mn><mi>/</mi><msqrt><mn>2</mn></msqrt><mspace width="0.222em"></mspace><mo stretchy="false" form="prefix">|</mo><mi>H</mi><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">⟩</mo><mo>−</mo><mn>1</mn><mi>/</mi><msqrt><mn>2</mn></msqrt><mspace width="0.222em"></mspace><mo stretchy="false" form="prefix">|</mo><mi>H</mi><mo stretchy="false" form="prefix">(</mo><mn>1</mn><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">⟩</mo><mo>=</mo><mo>−</mo><mo stretchy="false" form="prefix">|</mo><mn>0</mn><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">-1/\sqrt{2}~|H(0)\rangle - 1/\sqrt{2}~|H(1)\rangle = -|0\rangle</annotation></semantics></math></li>
</ul></li>
</ol>
<p>観測して得られる qbit は、符号は無視して、それぞれ、確率 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>1</mn><annotation encoding="application/x-tex">1</annotation></semantics></math> で、 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mn>0</mn><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">|0\rangle</annotation></semantics></math> または <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mn>1</mn><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">|1\rangle</annotation></semantics></math> が得られ、それはちょうど <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo stretchy="false" form="postfix">)</mo><mo>⊕</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mn>1</mn><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">f(0) \oplus f(1)</annotation></semantics></math> と一致している.</p>
<h2 id="ユニタリ変換">ユニタリ変換</h2>
<p>複素正方行列 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>U</mi><annotation encoding="application/x-tex">U</annotation></semantics></math> で</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>U</mi><mo>†</mo></msup><mi>U</mi><mo>=</mo><mi>U</mi><msup><mi>U</mi><mo>†</mo></msup><mo>=</mo><mi>I</mi></mrow><annotation encoding="application/x-tex">U^\dagger U = UU^\dagger = I</annotation></semantics></math></p>
<p>とあるような行列をユニタリ行列という. ここで <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>U</mi><mo>†</mo></msup><annotation encoding="application/x-tex">U^\dagger</annotation></semantics></math> は成分の共役 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><msup><mi>U</mi><mo>*</mo></msup><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(U^*)</annotation></semantics></math> を取って転置した行列 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><msup><mi>U</mi><mo>*</mo></msup><msup><mo stretchy="false" form="postfix">)</mo><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">(U^*)^T</annotation></semantics></math>.</p>
<p>簡単な性質として2つのユニタリ行列 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi><mo>,</mo><mi>V</mi></mrow><annotation encoding="application/x-tex">U,V</annotation></semantics></math> の積 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi><mi>V</mi></mrow><annotation encoding="application/x-tex">UV</annotation></semantics></math> もユニタリ行列.</p>
<p>ベクトル <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>v</mi><annotation encoding="application/x-tex">v</annotation></semantics></math> の左から <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>U</mi><annotation encoding="application/x-tex">U</annotation></semantics></math> を掛ける操作をユニタリ変換という.</p>
<h3 id="thm.">Thm.</h3>
<p>任意のユニタリ変換を再現する量子ゲートが存在する.</p>
<p>ところでこの定理を証明する気は無いが、其の前に qbit のベクトル表記を説明しないと意味が分からない. <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math> qbit に関して</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mn>0</mn><mi>…</mi><mn>000</mn><mo stretchy="false" form="postfix">⟩</mo><mo>,</mo><mspace width="0.222em"></mspace><mo stretchy="false" form="prefix">|</mo><mn>0</mn><mi>…</mi><mn>001</mn><mo stretchy="false" form="postfix">⟩</mo><mo>,</mo><mspace width="0.222em"></mspace><mo stretchy="false" form="prefix">|</mo><mn>0</mn><mi>…</mi><mn>010</mn><mo stretchy="false" form="postfix">⟩</mo><mo>,</mo><mspace width="0.222em"></mspace><mi>…</mi><mo>,</mo><mspace width="0.222em"></mspace><mo stretchy="false" form="prefix">|</mo><mn>1</mn><mi>…</mi><mn>111</mn><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">|0\ldots000\rangle,~
|0\ldots001\rangle,~
|0\ldots010\rangle,~
\ldots,~
|1\ldots111\rangle</annotation></semantics></math></p>
<p>という <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mn>2</mn><mi>n</mi></msup><annotation encoding="application/x-tex">2^n</annotation></semantics></math> 個の (基底) 状態があり得、 これらに係数</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>α</mi><mrow><mn>0</mn><mi>…</mi><mn>000</mn></mrow></msub><mo>,</mo><mspace width="0.222em"></mspace><msub><mi>α</mi><mrow><mn>0</mn><mi>…</mi><mn>001</mn></mrow></msub><mo>,</mo><mspace width="0.222em"></mspace><msub><mi>α</mi><mrow><mn>0</mn><mi>…</mi><mn>010</mn></mrow></msub><mo>,</mo><mspace width="0.222em"></mspace><mi>…</mi><mo>,</mo><mspace width="0.222em"></mspace><msub><mi>α</mi><mrow><mn>1</mn><mi>…</mi><mn>111</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\alpha_{0\ldots000},~
\alpha_{0\ldots001},~
\alpha_{0\ldots010},~
\ldots,~
\alpha_{1\ldots111}</annotation></semantics></math></p>
<p>を乗じた線型結合が一般の状態だが、 そう書く代わりに、</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd><msub><mi>α</mi><mrow><mn>0</mn><mi>…</mi><mn>000</mn></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>α</mi><mrow><mn>0</mn><mi>…</mi><mn>001</mn></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>α</mi><mrow><mn>0</mn><mi>…</mi><mn>010</mn></mrow></msub></mtd></mtr><mtr><mtd><mi>…</mi></mtd></mtr><mtr><mtd><msub><mi>α</mi><mrow><mn>1</mn><mi>…</mi><mn>111</mn></mrow></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">\left[\begin{array}
\alpha_{0\ldots000}\\
\alpha_{0\ldots001}\\
\alpha_{0\ldots010}\\
\ldots\\
\alpha_{1\ldots111}
\end{array}\right]</annotation></semantics></math></p>
<p>という列ベクトルだと思うことにする.</p>
<p>そうして先ほどの定理だが、これはこの列ベクトルに左からあるユニタリ行列 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>U</mi><annotation encoding="application/x-tex">U</annotation></semantics></math> を掛けて</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd><msub><mi>β</mi><mrow><mn>0</mn><mi>…</mi><mn>000</mn></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>β</mi><mrow><mn>0</mn><mi>…</mi><mn>001</mn></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>β</mi><mrow><mn>0</mn><mi>…</mi><mn>010</mn></mrow></msub></mtd></mtr><mtr><mtd><mi>…</mi></mtd></mtr><mtr><mtd><msub><mi>β</mi><mrow><mn>1</mn><mi>…</mi><mn>111</mn></mrow></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mi>U</mi><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd><msub><mi>α</mi><mrow><mn>0</mn><mi>…</mi><mn>000</mn></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>α</mi><mrow><mn>0</mn><mi>…</mi><mn>001</mn></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>α</mi><mrow><mn>0</mn><mi>…</mi><mn>010</mn></mrow></msub></mtd></mtr><mtr><mtd><mi>…</mi></mtd></mtr><mtr><mtd><msub><mi>α</mi><mrow><mn>1</mn><mi>…</mi><mn>111</mn></mrow></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">
\left[\begin{array}
\beta_{0\ldots000}\\
\beta_{0\ldots001}\\
\beta_{0\ldots010}\\
\ldots\\
\beta_{1\ldots111}
\end{array}\right]
=
U
\left[\begin{array}
\alpha_{0\ldots000}\\
\alpha_{0\ldots001}\\
\alpha_{0\ldots010}\\
\ldots\\
\alpha_{1\ldots111}
\end{array}\right]</annotation></semantics></math></p>
<p>という時に、左辺のベクトルに対応する qbit 状態を得るような量子ゲートが必ず存在すると言っている.</p>
<p>このような行列 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>U</mi><annotation encoding="application/x-tex">U</annotation></semantics></math> の大きさは <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mi>n</mi></msup><mo>×</mo><msup><mn>2</mn><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">2^n \times 2^n</annotation></semantics></math> と、2のべき乗でないといけないが、 実際には気にする必要はない. 一般の <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math> (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>&lt;</mo><mi>m</mi><mo>≤</mo><msup><mn>2</mn><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">2^{n-1} &lt; m \leq 2^n</annotation></semantics></math>) について、 ユニタリー行列 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi><mo>∈</mo><msup><mstyle mathvariant="double-struck"><mi>ℂ</mi></mstyle><mrow><mi>m</mi><mo>×</mo><mi>m</mi></mrow></msup></mrow><annotation encoding="application/x-tex">U \in \mathbb{C}^{m\times m}</annotation></semantics></math> に <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mi>n</mi></msup><mo>−</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">2^n-m</annotation></semantics></math> 個、サイズを広げて、 <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi><mi>′</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd></mtd><mtd></mtd><mtd></mtd><mtd></mtd><mtd></mtd></mtr><mtr><mtd></mtd><mtd><mi>U</mi></mtd><mtd></mtd><mtd></mtd><mtd></mtd></mtr><mtr><mtd></mtd><mtd></mtd><mtd></mtd><mtd></mtd><mtd></mtd></mtr><mtr><mtd></mtd><mtd></mtd><mtd></mtd><mtd><mn>1</mn></mtd><mtd></mtd></mtr><mtr><mtd></mtd><mtd></mtd><mtd></mtd><mtd></mtd><mtd><mn>1</mn></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">U&#39; = \left[\begin{array}
  &amp;   &amp;   &amp;   &amp;   \\
  &amp; U &amp;   &amp;   &amp;   \\
  &amp;   &amp;   &amp;   &amp;   \\
  &amp;   &amp;   &amp; 1 &amp;   \\
  &amp;   &amp;   &amp;   &amp; 1
\end{array}\right]</annotation></semantics></math></p>
<p>広げた部分は対角に <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>1</mn><annotation encoding="application/x-tex">1</annotation></semantics></math> を置いてできる行列 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi><mi>′</mi></mrow><annotation encoding="application/x-tex">U&#39;</annotation></semantics></math> も問題なくユニタリー行列.</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math> qbit であるが実際には <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mn>2</mn><mi>n</mi></msup><annotation encoding="application/x-tex">2^n</annotation></semantics></math> 状態の内 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math> 状態しか取り得ないようなもの長さ <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math> の列ベクトルで表現でき、<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>×</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">m \times m</annotation></semantics></math> 行列 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>U</mi><annotation encoding="application/x-tex">U</annotation></semantics></math> で、操作を記述すればよい. 実際には余白を <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0</mn><annotation encoding="application/x-tex">0</annotation></semantics></math> で埋めた長さ <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mn>2</mn><mi>n</mi></msup><annotation encoding="application/x-tex">2^n</annotation></semantics></math> の列ベクトルを <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mi>n</mi></msup><mo>×</mo><msup><mn>2</mn><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">2^n \times 2^n</annotation></semantics></math> 行列 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi><mi>′</mi></mrow><annotation encoding="application/x-tex">U&#39;</annotation></semantics></math> で操作したものだとすれば問題ない.</p>
<h4 id="例.-量子not">例. 量子NOT</h4>
<p>量子NOTというゲート <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math> は <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo stretchy="false" form="prefix">|</mo><mn>0</mn><mo stretchy="false" form="postfix">⟩</mo><mo>+</mo><mi>β</mi><mo stretchy="false" form="prefix">|</mo><mn>1</mn><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">\alpha |0\rangle + \beta |1\rangle</annotation></semantics></math> を <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi><mo stretchy="false" form="prefix">|</mo><mn>0</mn><mo stretchy="false" form="postfix">⟩</mo><mo>+</mo><mi>α</mi><mo stretchy="false" form="prefix">|</mo><mn>1</mn><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">\beta |0\rangle + \alpha |1\rangle</annotation></semantics></math> に写す.</p>
<p>即ち</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd><mi>β</mi></mtd></mtr><mtr><mtd><mi>α</mi></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><msub><mi>U</mi><mi>X</mi></msub><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd><mi>α</mi></mtd></mtr><mtr><mtd><mi>β</mi></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">
\left[\begin{array}
\beta\\
\alpha
\end{array}\right]
=
U_X
\left[\begin{array}
\alpha\\
\beta
\end{array}\right]</annotation></semantics></math></p>
<p>という行列 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>U</mi><mi>X</mi></msub><annotation encoding="application/x-tex">U_X</annotation></semantics></math> である. これを満たすような行列は正しく</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>U</mi><mi>X</mi></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd></mtr><mtr><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">U_X = \left[\begin{array}
0 &amp; 1\\
1 &amp; 0
\end{array}\right]</annotation></semantics></math></p>
<p>で、これがユニタリ行列であることは明らか.</p>
<h2 id="exact-and-threshold-algorithm">EXACT and THRESHOLD algorithm</h2>
<h3 id="論文">論文</h3>
<ul>
<li>&quot;Exact quantum query complexity of EXACT and THRESHOLD&quot;
<ul>
<li>Andris Ambainis, Jānis Iraids, Juris Smotrovs</li>
</ul></li>
<li><a href="https://arxiv.org/abs/1302.1235" class="uri">https://arxiv.org/abs/1302.1235</a></li>
</ul>
<p>与えられた <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math> bit (qbit ではない) について立ってる (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>1</mn><annotation encoding="application/x-tex">1</annotation></semantics></math> である) ビットの数を数えるアルゴリズム. 正確に述べると、 立ってるビットの数がちょうど <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math> であるか判定する <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mtext mathvariant="normal">EXACT</mtext><mi>k</mi><mi>n</mi></msubsup><annotation encoding="application/x-tex">\text{EXACT}^n_k</annotation></semantics></math> と、 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math> 以上であるか判定する <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mtext mathvariant="normal">THRESHOLD</mtext><mi>k</mi><mi>n</mi></msubsup><annotation encoding="application/x-tex">\text{THRESHOLD}^n_k</annotation></semantics></math> の2つのアルゴリズムを与える.</p>
<h3 id="notation">notation</h3>
<p>01を並べて <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mn>00010</mn><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">|00010\rangle</annotation></semantics></math> などと書く代わりに <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mn>0</mn><mo stretchy="false" form="postfix">⟩</mo><mo>,</mo><mspace width="0.222em"></mspace><mo stretchy="false" form="prefix">|</mo><mn>1</mn><mo stretchy="false" form="postfix">⟩</mo><mo>,</mo><mspace width="0.222em"></mspace><mi>…</mi><mo>,</mo><mspace width="0.222em"></mspace><mo stretchy="false" form="prefix">|</mo><mi>n</mi><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">|0\rangle,~|1\rangle,~\ldots,~|n\rangle</annotation></semantics></math> と書く. 実際にはこれは <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math> qbit だとして、 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math> 番目のビットだけが立ってるものを <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mi>i</mi><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">|i\rangle</annotation></semantics></math> と書いたと約束する (one-hot).</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>&lt;</mo><mi>j</mi></mrow><annotation encoding="application/x-tex">i&lt;j</annotation></semantics></math> について、 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mi>i</mi><mo stretchy="false" form="postfix">⟩</mo><mo>⋅</mo><mo stretchy="false" form="prefix">|</mo><mi>j</mi><mo stretchy="false" form="postfix">⟩</mo><mo>=</mo><mo stretchy="false" form="prefix">|</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">|i \rangle \cdot |j \rangle = |i,j\rangle</annotation></semantics></math> (左辺は <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math> qbit、右辺は <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>n</mi></mrow><annotation encoding="application/x-tex">2n</annotation></semantics></math> qbit) と書く.</p>
<p>さらに冗長に、 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mi>i</mi><mo stretchy="false" form="postfix">⟩</mo><mo>⋅</mo><mo stretchy="false" form="prefix">|</mo><mi>i</mi><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">|i\rangle \cdot |i\rangle</annotation></semantics></math> を改めて、 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mi>i</mi><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">|i \rangle</annotation></semantics></math> とする. 即ちこれは実際には <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>n</mi></mrow><annotation encoding="application/x-tex">2n</annotation></semantics></math> qbit である.</p>
<blockquote>
<p><em>N.B.</em> 実際には、中身の表現はどうでもよくて、要するに区別できる状態であればよい. つまり <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mo>⋅</mo><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">| \cdot \rangle</annotation></semantics></math> の中に書く数字は単なるラベルであるので実際には文字列だと思って見る.</p>
</blockquote>
<p>1 qbit <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mi>x</mi><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">|x\rangle</annotation></semantics></math> (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mn>0</mn><mo>,</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">x=0,1</annotation></semantics></math>) に対して <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><mo>−</mo><mn>1</mn><msup><mo stretchy="false" form="postfix">)</mo><mi>x</mi></msup></mrow><annotation encoding="application/x-tex">(-1)^x</annotation></semantics></math> を <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>x</mi><mo accent="true">^</mo></mover><annotation encoding="application/x-tex">\hat{x}</annotation></semantics></math> と書く (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>x</mi><mo accent="true">^</mo></mover><mo>=</mo><mo>−</mo><mn>1</mn><mo>,</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\hat{x}=-1,1</annotation></semantics></math>).</p>
<h3 id="query-量子クエリ">Query (量子クエリ)</h3>
<p>これから EXACT と THRESHOLD という2つのアルゴリズムを説明するが、 共に <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Q</mi><annotation encoding="application/x-tex">Q</annotation></semantics></math> という操作が登場する. これは入力 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><msub><mi>x</mi><mn>2</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>x</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">x_1, x_2,\ldots, x_n</annotation></semantics></math> に依存する写像であって、</p>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mo stretchy="false" form="prefix">|</mo><mi>i</mi><mo stretchy="false" form="postfix">⟩</mo><mo>=</mo><msub><mover><mi>x</mi><mo accent="true">^</mo></mover><mi>i</mi></msub><mo stretchy="false" form="prefix">|</mo><mi>i</mi><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">Q |i\rangle = \hat{x}_i |i\rangle</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mo stretchy="false" form="prefix">|</mo><mi>i</mi><mo>,</mo><mo stretchy="false" form="postfix">⟩</mo><mo>=</mo><mo stretchy="false" form="prefix">|</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">Q |i,\rangle = |i,j\rangle</annotation></semantics></math> <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><mi>i</mi><mo>&lt;</mo><mi>j</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(i&lt;j)</annotation></semantics></math></li>
</ul>
<p>で定めるものである. このように入力に依存する操作をクエリと呼ぶ.</p>
<p>1回のクエリの処理 (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Q</mi><annotation encoding="application/x-tex">Q</annotation></semantics></math> の適用) のたびに、入力 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mi>i</mi></msub><annotation encoding="application/x-tex">x_i</annotation></semantics></math> を一回読む必要がある. アルゴリズムの複雑性として、クエリを処理する回数を指標とする. これを量子クエリ計算量という.</p>
<h3 id="exact">EXACT</h3>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math> bit <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>0</mn></msub><mo>,</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>x</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">x_0, x_1, \ldots, x_{n-1}</annotation></semantics></math> の内、ちょうど <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math> 個が立ってるか判定するアルゴリズムを <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mtext mathvariant="normal">EXACT</mtext><mi>k</mi><mi>n</mi></msubsup><annotation encoding="application/x-tex">\text{EXACT}^n_k</annotation></semantics></math> とする.</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mtext mathvariant="normal">EXACT</mtext><mi>k</mi><mi>n</mi></msubsup><mo>:</mo><mo stretchy="false" form="prefix">{</mo><mn>0</mn><mo>,</mo><mn>1</mn><msup><mo stretchy="false" form="postfix">}</mo><mi>n</mi></msup><mo accent="false">→</mo><mo stretchy="false" form="prefix">{</mo><mtext mathvariant="normal">true</mtext><mo>,</mo><mtext mathvariant="normal">false</mtext><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\text{EXACT}^n_k : \{0,1\}^n \to \{\text{true}, \text{false}\}</annotation></semantics></math></p>
<p>今から述べる彼らのアルゴリズムでは <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>n</mi></mrow><annotation encoding="application/x-tex">2n</annotation></semantics></math> qbit を用意する. 取り得る状態は <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mi>i</mi><mo stretchy="false" form="postfix">⟩</mo><mo>,</mo><mo stretchy="false" form="prefix">|</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">|i\rangle, |i,j\rangle</annotation></semantics></math> <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo>≤</mo><mi>i</mi><mo>&lt;</mo><mi>n</mi><mo>,</mo><mn>0</mn><mo>≤</mo><mi>j</mi><mo>&lt;</mo><mi>n</mi><mo>,</mo><mi>i</mi><mo>&lt;</mo><mi>j</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">( 0\leq i &lt; n, 0\leq j &lt; n, i &lt; j)</annotation></semantics></math> の <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>+</mo><mi>n</mi><mo stretchy="false" form="prefix">(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy="false" form="postfix">)</mo><mi>/</mi><mn>2</mn><mo>=</mo><mi>n</mi><mo stretchy="false" form="prefix">(</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo stretchy="false" form="postfix">)</mo><mi>/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">n + n(n-1)/2 = n(n+1)/2</annotation></semantics></math> 個だけとし、初め <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mn>0</mn><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">|0\rangle</annotation></semantics></math> だとする. 従って、長さ <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo stretchy="false" form="prefix">(</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo stretchy="false" form="postfix">)</mo><mi>/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">n(n+1)/2</annotation></semantics></math> の虚ベクトルで状態は表現される.</p>
<p>まず <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>2</mn><mi>k</mi></mrow><annotation encoding="application/x-tex">n=2k</annotation></semantics></math> (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mtext mathvariant="normal">EXACT</mtext><mi>k</mi><mrow><mn>2</mn><mi>k</mi></mrow></msubsup><annotation encoding="application/x-tex">\text{EXACT}^{2k}_k</annotation></semantics></math>) の場合を考える.</p>
<h4 id="exact2k_k">EXACT<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mrow></mrow><mi>k</mi><mrow><mn>2</mn><mi>k</mi></mrow></msubsup><annotation encoding="application/x-tex">{}^{2k}_k</annotation></semantics></math></h4>
<p>ちょうど半分のビットが立ってるかだけを判定する. ビットそれぞれを <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo accent="false">↦</mo><mover><mi>x</mi><mo accent="true">^</mo></mover></mrow><annotation encoding="application/x-tex">x \mapsto \hat{x}</annotation></semantics></math> としたときに、 その和 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo>∑</mo><mi>i</mi></msub><msub><mover><mi>x</mi><mo accent="true">^</mo></mover><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\sum_i \hat{x}_i</annotation></semantics></math> がゼロになるだろう. これを利用する.</p>
<p>次の3つの操作を用いる:</p>
<ol type="1">
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>U</mi><mn>1</mn></msub><mo stretchy="false" form="prefix">|</mo><mn>0</mn><mo stretchy="false" form="postfix">⟩</mo><mo>=</mo><mfrac><mn>1</mn><msqrt><mrow><mn>2</mn><mi>k</mi></mrow></msqrt></mfrac><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mrow><mn>2</mn><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msubsup><mo stretchy="false" form="prefix">|</mo><mi>i</mi><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">U_1 |0\rangle = \frac{1}{\sqrt{2k}} \sum_{i=0}^{2k-1} |i\rangle</annotation></semantics></math>
<ul>
<li>ユニタリー変換</li>
</ul></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Q</mi><annotation encoding="application/x-tex">Q</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>U</mi><mn>2</mn></msub><mo stretchy="false" form="prefix">|</mo><mi>i</mi><mo stretchy="false" form="postfix">⟩</mo><mo>=</mo><mfrac><mn>1</mn><msqrt><mrow><mn>2</mn><mi>k</mi></mrow></msqrt></mfrac><mrow><mo stretchy="true" form="prefix">(</mo><msub><mo>∑</mo><mrow><mi>i</mi><mo>&lt;</mo><mi>j</mi></mrow></msub><mo stretchy="false" form="prefix">|</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false" form="postfix">⟩</mo><mo>−</mo><msub><mo>∑</mo><mrow><mi>i</mi><mo>&gt;</mo><mi>j</mi></mrow></msub><mo stretchy="false" form="prefix">|</mo><mi>j</mi><mo>,</mo><mi>i</mi><mo stretchy="false" form="postfix">⟩</mo><mo>+</mo><mo stretchy="false" form="prefix">|</mo><mn>0</mn><mo stretchy="false" form="postfix">⟩</mo><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">U_2 |i\rangle = \frac{1}{\sqrt{2k}} \left( \sum_{i&lt;j} |i,j\rangle - \sum_{i&gt;j} |j,i\rangle + |0\rangle \right)</annotation></semantics></math>
<ul>
<li>ユニタリー変換</li>
</ul></li>
</ol>
<p>ここで未定義な値 (e.g. <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>U</mi><mn>1</mn></msub><mo stretchy="false" form="prefix">|</mo><mn>1</mn><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">U_1|1\rangle</annotation></semantics></math>) はどう定義してもいいので <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>U</mi><mn>1</mn></msub><mo>,</mo><msub><mi>U</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">U_1, U_2</annotation></semantics></math> をユニタリー行列になるようにする.</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mn>0</mn><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">|0\rangle</annotation></semantics></math> にこれらを順に通す.</p>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mn>0</mn><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">|0\rangle</annotation></semantics></math>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow></mrow><mover><mrow><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><msub><mi>U</mi><mn>1</mn></msub><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace></mrow><mo accent="true">⃗</mo></mover></msub><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mfrac><mn>1</mn><msqrt><mrow><mn>2</mn><mi>k</mi></mrow></msqrt></mfrac><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mrow><mn>2</mn><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msubsup><mo stretchy="false" form="prefix">|</mo><mi>i</mi><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">{}_\vec{~~U_1~~} ~~ \frac{1}{\sqrt{2k}} \sum_{i=0}^{2k-1} |i\rangle</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow></mrow><mover><mrow><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mi>Q</mi><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace></mrow><mo accent="true">⃗</mo></mover></msub><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mfrac><mn>1</mn><msqrt><mrow><mn>2</mn><mi>k</mi></mrow></msqrt></mfrac><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mrow><mn>2</mn><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msubsup><msub><mover><mi>x</mi><mo accent="true">^</mo></mover><mi>i</mi></msub><mo stretchy="false" form="prefix">|</mo><mi>i</mi><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">{}_\vec{~~Q~~} ~~ \frac{1}{\sqrt{2k}} \sum_{i=0}^{2k-1} \hat{x}_i |i\rangle</annotation></semantics></math></li>
</ul></li>
</ul>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow></mrow><mover><mrow><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><msub><mi>U</mi><mn>2</mn></msub><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace></mrow><mo accent="true">⃗</mo></mover></msub><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mfrac><mn>1</mn><mrow><mn>2</mn><mi>k</mi></mrow></mfrac><mrow><mo stretchy="true" form="prefix">(</mo><mo stretchy="false" form="prefix">(</mo><msub><mover><mi>x</mi><mo accent="true">^</mo></mover><mi>i</mi></msub><mo>−</mo><msub><mover><mi>x</mi><mo accent="true">^</mo></mover><mi>j</mi></msub><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="prefix">|</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false" form="postfix">⟩</mo><mo>+</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mrow><mn>2</mn><mi>k</mi><mo>−</mo><mn>1</mn></mrow></munderover><msub><mover><mi>x</mi><mo accent="true">^</mo></mover><mi>i</mi></msub><mo stretchy="false" form="prefix">|</mo><mn>0</mn><mo stretchy="false" form="postfix">⟩</mo><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">{}_\vec{~~U_2~~} ~~ \frac{1}{2k} \left( (\hat{x}_i - \hat{x}_j) |i,j\rangle + \sum_{i=0}^{2k-1} \hat{x}_i |0\rangle \right)</annotation></semantics></math></p>
<p>で、最後の量子を観測したときに得られうる状態は</p>
<ol type="1">
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">|i,j\rangle</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mn>0</mn><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">|0\rangle</annotation></semantics></math></li>
</ol>
<p>の2種類ある. この2つ目を得た時、それは係数 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo>∑</mo><mi>i</mi></msub><msub><mover><mi>x</mi><mo accent="true">^</mo></mover><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\sum_i \hat{x}_i</annotation></semantics></math> がゼロでないということ. なぜなら、ゼロなら観測できる確率はゼロだから. そして、それがゼロでないということは、<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>2</mn><mi>k</mi></mrow><annotation encoding="application/x-tex">n=2k</annotation></semantics></math> の内ちょうど半分のビットが立っていることを <strong>否定</strong> している. すなわち、</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mtext mathvariant="normal">EXACT</mtext><mi>k</mi><mrow><mn>2</mn><mi>k</mi></mrow></msubsup><mo stretchy="false" form="prefix">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo>,</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>x</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mtext mathvariant="normal">false</mtext><mi>.</mi></mrow><annotation encoding="application/x-tex">\text{EXACT}^{2k}_k(x_0, x_1, \ldots, x_{n-1}) = \text{false}.</annotation></semantics></math></p>
<p>次に、1つ目の <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">|i,j\rangle</annotation></semantics></math> を得た時、これも同様に、その係数 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>x</mi><mo accent="true">^</mo></mover><mi>i</mi></msub><mo>−</mo><msub><mover><mi>x</mi><mo accent="true">^</mo></mover><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">\hat{x}_i - \hat{x}_j</annotation></semantics></math> がゼロではないことを示してる. それはつまり、ビット <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mi>i</mi></msub><annotation encoding="application/x-tex">x_i</annotation></semantics></math> とビット <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mi>j</mi></msub><annotation encoding="application/x-tex">x_j</annotation></semantics></math> とが異なることを示してる. すなわち、</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mtext mathvariant="normal">EXACT</mtext><mi>k</mi><mrow><mn>2</mn><mi>k</mi></mrow></msubsup><mo stretchy="false" form="prefix">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo>,</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>x</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false" form="postfix">)</mo><mo>=</mo><msubsup><mtext mathvariant="normal">EXACT</mtext><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow><mrow><mn>2</mn><mi>k</mi><mo>−</mo><mn>2</mn></mrow></msubsup><mo stretchy="false" form="prefix">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo>,</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>x</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>\</mo><mo stretchy="false" form="prefix">{</mo><msub><mi>x</mi><mi>i</mi></msub><mo>,</mo><msub><mi>x</mi><mi>j</mi></msub><mo stretchy="false" form="postfix">}</mo><mo stretchy="false" form="postfix">)</mo><mi>.</mi></mrow><annotation encoding="application/x-tex">\text{EXACT}^{2k}_k(x_0, x_1, \ldots, x_{n-1})
=
\text{EXACT}^{2k-2}_{k-1}(x_0, x_1, \ldots, x_{n-1} \setminus \{x_i, x_j\}).</annotation></semantics></math></p>
<p>以上は <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math> に関する帰納法を示唆する. 基底状態として</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mtext mathvariant="normal">EXACT</mtext><mn>0</mn><mn>0</mn></msubsup><mo stretchy="false" form="prefix">(</mo><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mtext mathvariant="normal">true</mtext></mrow><annotation encoding="application/x-tex">\text{EXACT}^0_0() = \text{true}</annotation></semantics></math></p>
<p>である.</p>
<h4 id="exactn_k">EXACT<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mrow></mrow><mi>k</mi><mi>n</mi></msubsup><annotation encoding="application/x-tex">{}^{n}_k</annotation></semantics></math></h4>
<p>入力 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>0</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>x</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">x_0, \ldots, x_{n-1}</annotation></semantics></math> に適当に付け足せば <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mtext mathvariant="normal">EXACT</mtext><mi>k</mi><mrow><mn>2</mn><mi>k</mi></mrow></msubsup><annotation encoding="application/x-tex">\text{EXACT}^{2k}_k</annotation></semantics></math> に出来る. 具体的には</p>
<ul>
<li>case <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>2</mn><mi>k</mi></mrow><annotation encoding="application/x-tex">n = 2k</annotation></semantics></math>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mtext mathvariant="normal">EXACT</mtext><mi>k</mi><mrow><mn>2</mn><mi>k</mi></mrow></msubsup><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\text{EXACT}^{2k}_k(x)</annotation></semantics></math></li>
</ul></li>
<li>case <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>&gt;</mo><mn>2</mn><mi>k</mi></mrow><annotation encoding="application/x-tex">n &gt; 2k</annotation></semantics></math>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mtext mathvariant="normal">EXACT</mtext><mrow><mi>n</mi><mo>−</mo><mi>k</mi></mrow><mrow><mn>2</mn><mi>n</mi><mo>−</mo><mn>2</mn><mi>k</mi></mrow></msubsup><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>+</mo><mspace width="-0.167em"></mspace><mspace width="-0.167em"></mspace><mspace width="-0.167em"></mspace><mspace width="-0.167em"></mspace><mspace width="-0.167em"></mspace><mo>+</mo><mo stretchy="false" form="prefix">(</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><mn>1</mn><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\text{EXACT}^{2n-2k}_{n-k}(x +\!\!\!\!\!+ (1,\ldots,1))</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>−</mo><mn>2</mn><mi>k</mi></mrow><annotation encoding="application/x-tex">n-2k</annotation></semantics></math> 個の 1 bit 列を連結</li>
</ul></li>
<li>case <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>&lt;</mo><mn>2</mn><mi>k</mi></mrow><annotation encoding="application/x-tex">n &lt; 2k</annotation></semantics></math>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mtext mathvariant="normal">EXACT</mtext><mi>k</mi><mrow><mn>2</mn><mi>k</mi></mrow></msubsup><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>+</mo><mspace width="-0.167em"></mspace><mspace width="-0.167em"></mspace><mspace width="-0.167em"></mspace><mspace width="-0.167em"></mspace><mspace width="-0.167em"></mspace><mo>+</mo><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo>,</mo><mi>…</mi><mo>,</mo><mn>0</mn><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\text{EXACT}^{2k}_{k}(x +\!\!\!\!\!+ (0,\ldots,0))</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>k</mi><mo>−</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">2k-n</annotation></semantics></math> 個の 0 bit 列を連結</li>
</ul></li>
</ul>
<h4 id="クエリ計算量">クエリ計算量</h4>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mtext mathvariant="normal">EXACT</mtext><mi>k</mi><mrow><mn>2</mn><mi>k</mi></mrow></msubsup><annotation encoding="application/x-tex">\text{EXACT}^{2k}_k</annotation></semantics></math> のクエリ計算量は、再帰の回数なので、最悪 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>. したがって、<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mtext mathvariant="normal">EXACT</mtext><mi>k</mi><mi>n</mi></msubsup><annotation encoding="application/x-tex">\text{EXACT}^{n}_k</annotation></semantics></math> のクエリ計算量は、最悪</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>max</mo><mo stretchy="false" form="prefix">{</mo><mi>k</mi><mo>,</mo><mi>n</mi><mo>−</mo><mi>k</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\max\{k, n-k\}</annotation></semantics></math></p>
<p>となる.</p>
<h3 id="threshold">THRESHOLD</h3>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math> bit <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>0</mn></msub><mo>,</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>x</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">x_0, x_1, \ldots, x_{n-1}</annotation></semantics></math> の内、<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math> 個 <strong>以上</strong> が立ってるか判定するアルゴリズムを <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mtext mathvariant="normal">THRESHOLD</mtext><mi>k</mi><mi>n</mi></msubsup><annotation encoding="application/x-tex">\text{THRESHOLD}^n_k</annotation></semantics></math> とする.</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mtext mathvariant="normal">THRESHOLD</mtext><mi>k</mi><mi>n</mi></msubsup><mo>:</mo><mo stretchy="false" form="prefix">{</mo><mn>0</mn><mo>,</mo><mn>1</mn><msup><mo stretchy="false" form="postfix">}</mo><mi>n</mi></msup><mo accent="false">→</mo><mo stretchy="false" form="prefix">{</mo><mtext mathvariant="normal">true</mtext><mo>,</mo><mtext mathvariant="normal">false</mtext><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\text{THRESHOLD}^n_k : \{0,1\}^n \to \{\text{true}, \text{false}\}</annotation></semantics></math></p>
<h4 id="threshold2k1_k1">THRESHOLD<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mrow></mrow><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow><mrow><mn>2</mn><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msubsup><annotation encoding="application/x-tex">{}^{2k+1}_{k+1}</annotation></semantics></math></h4>
<p>まず初めに <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mtext mathvariant="normal">THRESHOLD</mtext><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow><mrow><mn>2</mn><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msubsup><annotation encoding="application/x-tex">\text{THRESHOLD}^{2k+1}_{k+1}</annotation></semantics></math> を考える. これは即ち過半数ビットが立ってるかを判定する手続きである.</p>
<p>入力は <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>0</mn></msub><mo>,</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>x</mi><mrow><mn>2</mn><mi>k</mi></mrow></msub></mrow><annotation encoding="application/x-tex">x_0, x_1, \ldots, x_{2k}</annotation></semantics></math> の <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>k</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">2k+1</annotation></semantics></math> 個. これに関して</p>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mn>0</mn></msub><mo>=</mo><mo stretchy="false" form="prefix">{</mo><mi>i</mi><mo>:</mo><msub><mi>x</mi><mi>i</mi></msub><mo>=</mo><mn>0</mn><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">S_0 = \{ i : x_i = 0 \}</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mn>1</mn></msub><mo>=</mo><mo stretchy="false" form="prefix">{</mo><mi>i</mi><mo>:</mo><msub><mi>x</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">S_1 = \{ i : x_i = 1 \}</annotation></semantics></math></li>
</ul>
<p>とする. それぞれのサイズ (個数) について <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>#</mi><msub><mi>S</mi><mn>0</mn></msub><mo>=</mo><mi>#</mi><msub><mi>S</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\#S_0 = \#S_1</annotation></semantics></math> であることはない. 今 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>#</mi><msub><mi>S</mi><mn>0</mn></msub><mo>&gt;</mo><mi>#</mi><msub><mi>S</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\#S_0 &gt; \#S_1</annotation></semantics></math> とする. 逆の場合も同様であるので省略する.</p>
<p>まず、次のような性質がある.</p>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>≤</mo><mi>i</mi><mo>≤</mo><mn>2</mn><mi>k</mi></mrow><annotation encoding="application/x-tex">0 \leq i \leq 2k</annotation></semantics></math> について、
<ul>
<li>when <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>∈</mo><msub><mi>S</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">i \in S_0</annotation></semantics></math>
<ul>
<li>when <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>#</mi><msub><mi>S</mi><mn>0</mn></msub><mo>=</mo><mi>#</mi><msub><mi>S</mi><mn>1</mn></msub><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\#S_0 = \#S_1 + 1</annotation></semantics></math>: <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo>∑</mo><mrow><mi>j</mi><mo>≠</mo><mi>i</mi></mrow></msub><msub><mover><mi>x</mi><mo accent="true">^</mo></mover><mi>j</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\sum_{j \ne i} \hat{x}_j = 0</annotation></semantics></math></li>
<li>when <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>#</mi><msub><mi>S</mi><mn>0</mn></msub><mo>&gt;</mo><mi>#</mi><msub><mi>S</mi><mn>1</mn></msub><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\#S_0 &gt; \#S_1 + 1</annotation></semantics></math>:
<ul>
<li>任意の <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>≠</mo><mi>i</mi></mrow><annotation encoding="application/x-tex">j \ne i</annotation></semantics></math> について</li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mtext mathvariant="normal">THRESHOLD</mtext><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow><mrow><mn>2</mn><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msubsup><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><msubsup><mtext mathvariant="normal">THRESHOLD</mtext><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow><mrow><mn>2</mn><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msubsup><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>\</mo><mo stretchy="false" form="prefix">{</mo><msub><mi>x</mi><mi>i</mi></msub><mo>,</mo><msub><mi>x</mi><mi>j</mi></msub><mo stretchy="false" form="postfix">}</mo><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\text{THRESHOLD}^{2k+1}_{k+1}(x) = \text{THRESHOLD}^{2k-1}_{k-1}(x \setminus \{x_i, x_j\})</annotation></semantics></math></li>
</ul></li>
</ul></li>
<li>when <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>∈</mo><msub><mi>S</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">i \in S_1</annotation></semantics></math>
<ul>
<li>任意の <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>≠</mo><mi>i</mi></mrow><annotation encoding="application/x-tex">j \ne i</annotation></semantics></math> について</li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mtext mathvariant="normal">THRESHOLD</mtext><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow><mrow><mn>2</mn><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msubsup><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><msubsup><mtext mathvariant="normal">THRESHOLD</mtext><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow><mrow><mn>2</mn><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msubsup><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>\</mo><mo stretchy="false" form="prefix">{</mo><msub><mi>x</mi><mi>i</mi></msub><mo>,</mo><msub><mi>x</mi><mi>j</mi></msub><mo stretchy="false" form="postfix">}</mo><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\text{THRESHOLD}^{2k+1}_{k+1}(x) = \text{THRESHOLD}^{2k-1}_{k-1}(x \setminus \{x_i, x_j\})</annotation></semantics></math></li>
</ul></li>
</ul></li>
</ul>
<p>THRESHOLD では次の3つの操作を用いる:</p>
<ol type="1">
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>U</mi><mn>1</mn></msub><annotation encoding="application/x-tex">U_1</annotation></semantics></math>
<ul>
<li>先述</li>
</ul></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Q</mi><annotation encoding="application/x-tex">Q</annotation></semantics></math>
<ul>
<li>先述</li>
</ul></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>U</mi><mn>3</mn></msub><annotation encoding="application/x-tex">U_3</annotation></semantics></math>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>U</mi><mn>3</mn></msub><mo stretchy="false" form="prefix">|</mo><mi>i</mi><mo stretchy="false" form="postfix">⟩</mo><mo>=</mo><mfrac><msqrt><mrow><mn>2</mn><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msqrt><mrow><mn>2</mn><mi>k</mi></mrow></mfrac><mrow><mo stretchy="true" form="prefix">(</mo><msub><mo>∑</mo><mrow><mi>i</mi><mo>&lt;</mo><mi>j</mi></mrow></msub><mo stretchy="false" form="prefix">|</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false" form="postfix">⟩</mo><mo>−</mo><msub><mo>∑</mo><mrow><mi>i</mi><mo>&gt;</mo><mi>j</mi></mrow></msub><mo stretchy="false" form="prefix">|</mo><mi>j</mi><mo>,</mo><mi>i</mi><mo stretchy="false" form="postfix">⟩</mo><mo>+</mo><mfrac><mn>1</mn><mrow><mn>2</mn><mi>k</mi></mrow></mfrac><mo stretchy="false" form="prefix">|</mo><mi>j</mi><mo stretchy="false" form="postfix">⟩</mo><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">U_3 |i\rangle = \frac{\sqrt{2k+1}}{2k} \left( \sum_{i&lt;j} |i,j\rangle - \sum_{i&gt;j} |j,i\rangle + \frac{1}{2k} |j\rangle \right)</annotation></semantics></math></li>
<li>ユニタリ変換</li>
</ul></li>
</ol>
<p>EXACT と同様に <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mn>0</mn><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">|0\rangle</annotation></semantics></math> から初めてこれらに順に通す.</p>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mn>0</mn><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">|0\rangle</annotation></semantics></math>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow></mrow><mover><mrow><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><msub><mi>U</mi><mn>1</mn></msub><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace></mrow><mo accent="true">⃗</mo></mover></msub><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mfrac><mn>1</mn><msqrt><mrow><mn>2</mn><mi>k</mi></mrow></msqrt></mfrac><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mrow><mn>2</mn><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msubsup><mo stretchy="false" form="prefix">|</mo><mi>i</mi><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">{}_\vec{~~U_1~~} ~~ \frac{1}{\sqrt{2k}} \sum_{i=0}^{2k-1} |i\rangle</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow></mrow><mover><mrow><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mi>Q</mi><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace></mrow><mo accent="true">⃗</mo></mover></msub><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mfrac><mn>1</mn><msqrt><mrow><mn>2</mn><mi>k</mi></mrow></msqrt></mfrac><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mrow><mn>2</mn><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msubsup><msub><mover><mi>x</mi><mo accent="true">^</mo></mover><mi>i</mi></msub><mo stretchy="false" form="prefix">|</mo><mi>i</mi><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">{}_\vec{~~Q~~} ~~ \frac{1}{\sqrt{2k}} \sum_{i=0}^{2k-1} \hat{x}_i |i\rangle</annotation></semantics></math></li>
</ul></li>
</ul>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow></mrow><mover><mrow><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><msub><mi>U</mi><mn>3</mn></msub><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace></mrow><mo accent="true">⃗</mo></mover></msub><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mfrac><msqrt><mrow><mn>2</mn><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msqrt><mrow><mn>2</mn><mi>k</mi><msqrt><mrow><mn>2</mn><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msqrt></mrow></mfrac><munder><mo>∑</mo><mrow><mi>i</mi><mo>&lt;</mo><mi>j</mi></mrow></munder><mo stretchy="false" form="prefix">(</mo><msub><mover><mi>x</mi><mo accent="true">^</mo></mover><mi>i</mi></msub><mo>−</mo><msub><mover><mi>x</mi><mo accent="true">^</mo></mover><mi>j</mi></msub><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="prefix">|</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false" form="postfix">⟩</mo><mo>+</mo><mfrac><mn>1</mn><mrow><mn>2</mn><mi>k</mi><msqrt><mrow><mn>2</mn><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msqrt></mrow></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mrow><mn>2</mn><mi>k</mi></mrow></munderover><munder><mo>∑</mo><mrow><mi>i</mi><mo>≠</mo><mi>j</mi></mrow></munder><msub><mover><mi>x</mi><mo accent="true">^</mo></mover><mi>i</mi></msub><mo stretchy="false" form="prefix">|</mo><mi>j</mi><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">
{}_\vec{~~U_3~~}
~~
\frac{\sqrt{2k-1}}{2k \sqrt{2k+1}} \sum_{i&lt;j} (\hat{x}_i - \hat{x}_j) |i,j\rangle
+ \frac{1}{2k\sqrt{2k+1}} \sum_{i=0}^{2k} \sum_{i \ne j} \hat{x}_i |j\rangle</annotation></semantics></math></p>
<p>これを測定すると</p>
<ol type="1">
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">|i,j\rangle</annotation></semantics></math> または</li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mi>j</mi><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">|j\rangle</annotation></semantics></math></li>
</ol>
<p>のいずれかを得る.</p>
<ol type="1">
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">|i,j\rangle</annotation></semantics></math> を得た時、</li>
</ol>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>x</mi><mo accent="true">^</mo></mover><mi>i</mi></msub><mo>−</mo><msub><mover><mi>x</mi><mo accent="true">^</mo></mover><mi>j</mi></msub><mo>≠</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\hat{x}_i - \hat{x}_j \ne 0</annotation></semantics></math> であるから、<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub><mo>≠</mo><msub><mi>x</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">x_i \ne x_j</annotation></semantics></math>. 従って</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mtext mathvariant="normal">THRESHOLD</mtext><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow><mrow><mn>2</mn><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msubsup><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><msubsup><mtext mathvariant="normal">THRESHOLD</mtext><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow><mrow><mn>2</mn><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msubsup><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>\</mo><mo stretchy="false" form="prefix">{</mo><msub><mi>x</mi><mi>i</mi></msub><mo>,</mo><msub><mi>x</mi><mi>j</mi></msub><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\text{THRESHOLD}^{2k+1}_{k+1}(x)
= \text{THRESHOLD}^{2k+1}_{k+1}(x \setminus \{x_i, x_j\}</annotation></semantics></math></p>
<ol start="2" type="1">
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mi>j</mi><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">|j\rangle</annotation></semantics></math> を得た時、</li>
</ol>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo>∑</mo><mrow><mi>i</mi><mo>≠</mo><mi>j</mi></mrow></msub><msub><mover><mi>x</mi><mo accent="true">^</mo></mover><mi>i</mi></msub><mo>≠</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\sum_{i \ne j} \hat{x}_i \ne 0</annotation></semantics></math>. 先ほどの性質を思い出せば、</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mtext mathvariant="normal">THRESHOLD</mtext><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow><mrow><mn>2</mn><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msubsup><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><msubsup><mtext mathvariant="normal">THRESHOLD</mtext><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow><mrow><mn>2</mn><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msubsup><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>\</mo><mo stretchy="false" form="prefix">{</mo><msub><mi>x</mi><mi>i</mi></msub><mo>,</mo><msub><mi>x</mi><mi>j</mi></msub><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\text{THRESHOLD}^{2k+1}_{k+1}(x)
= \text{THRESHOLD}^{2k+1}_{k+1}(x \setminus \{x_i, x_j\}</annotation></semantics></math></p>
<p>以上から、ちょうど <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math> 回、再帰的に <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>U</mi><mn>1</mn></msub><mo>,</mo><mi>Q</mi><mo>,</mo><msub><mi>U</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">U_1, Q, U_2</annotation></semantics></math> を適用することで</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mtext mathvariant="normal">THRESHOLD</mtext><mn>0</mn><mn>1</mn></msubsup><mo stretchy="false" form="prefix">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo stretchy="false" form="postfix">)</mo><mo>=</mo><msub><mi>x</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">\text{THRESHOLD}^1_0(x_0) = x_0</annotation></semantics></math></p>
<p>というわけで <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mtext mathvariant="normal">THRESHOLD</mtext><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow><mrow><mn>2</mn><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msubsup><annotation encoding="application/x-tex">\text{THRESHOLD}^{2k+1}_{k+1}</annotation></semantics></math> はクエリ計算量 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k+1</annotation></semantics></math> で解ける.</p>
<h4 id="thresholdn_k">THRESHOLD<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mrow></mrow><mi>k</mi><mi>n</mi></msubsup><annotation encoding="application/x-tex">{}^{n}_k</annotation></semantics></math></h4>
<p>EXACT と同じ感じでやる.</p>
<p>クエリ計算量は、</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>max</mo><mo stretchy="false" form="prefix">{</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo>,</mo><mi>n</mi><mo>−</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo stretchy="false" form="postfix">}</mo><mi>.</mi></mrow><annotation encoding="application/x-tex">\max \{k+1, n-k+1\}.</annotation></semantics></math></p>
<!--

  HTML として pandoc -B で include する.

  <H2> を列挙してそれらにリンクを貼った toc を id='toc' に埋め込む.
  markdown で書いてるだろうから例として次のような段落を書けばよい.

```
## INDEX
<div id=toc></div>
```

  used in
  - /memo/gnuplot
  - /memo/linux
  - /memo/imagemagick

-->
<script>
(function() {
  var sections = document.getElementsByTagName('h2');
  var i;
  var OL = document.createElement('ol');
  for (i=0; i < sections.length; ++i) {
    var LI = document.createElement('li');
    var A = document.createElement('a');
    A.innerHTML = sections[i].innerHTML;
    if (A.innerHTML.toUpperCase() == 'INDEX') continue;
    A.href = '#' + i;
    LI.appendChild(A);
    OL.appendChild(LI);

    var PREF = document.createElement('a');
    PREF.name = i;
    sections[i].appendChild(PREF);
  }

  var done = false;
  function work() {
    if (done) return;
    if ( document.getElementById('toc') === null) return; // no toc element
    document.getElementById('toc').appendChild(OL);
    done = true;
  };

  window.onload = work;
  setTimeout(work,800);
}());
</script>
</body>
</html>
