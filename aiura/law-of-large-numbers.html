<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <title>大数の法則</title>
  <style type="text/css">code{white-space: pre;}</style>
  <link rel="stylesheet" href="../resources/css/c.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header class="page-header">
    <a href='index.html'><i class="fa fa-stumbleupon" style="position:absolute; left:0.4em; top:0.4em; width:1.3em;border-radius:0.8em;"></i></a>
</header>
<header>
<h1 class="title">大数の法則</h1>
</header>
<p class="date" style="text-align: right">
2019-12-15 (Sun.), 2020-01-07 (Tue.)
</p>
<div class="is-pulled-right">
<p><a class='tag is-red' href=index.html#確率論>確率論</a> <a class='tag is-red' href=index.html#測度論>測度論</a></p>
</div>
<p><span class="math inline">\(\def\F{\mathcal{F}}\def\R{\mathbb{R}}\def\BR{\mathcal{B}(\mathbb{R})}\def\RX{\mathbb R_X}\)</span></p>
<h2 id="確率変数">確率変数</h2>
<p><a href="probability.html">確率空間</a> <span class="math inline">\((\Omega, \F, P)\)</span> について, 関数 <span class="math inline">\(X \colon \Omega \to \R\)</span> が可測であるとき, これを確率変数だという. 関数が可測であるとはすなわち, 任意の実数 <span class="math inline">\(a\)</span> について, <span class="math display">\[[X &gt; a] \equiv \{ \omega \in \Omega \mid X \omega &gt; a \}\]</span> が <span class="math inline">\(\F\)</span> に属する（つまり可測空間である）こと. ちなみに <span class="math inline">\([X &gt; a]\)</span> の代わりに <span class="math inline">\([X \geq a]\)</span> とか <span class="math inline">\([X &lt; a]\)</span> とかを使っても同値である.</p>
<p><span class="math inline">\(X\)</span> の像 <span class="math inline">\(\{ X\omega \mid \omega \in \Omega \} (\subset \R)\)</span> を <span class="math inline">\(\RX\)</span> と書く.</p>
<h3 id="確率変数の分布">確率変数の分布</h3>
<p>確率変数 <span class="math inline">\(X\)</span> に対してその分布を <span class="math inline">\(\mu_X\)</span> と書くが, これは次のような関数 <span class="math inline">\(\RX \to \R\)</span>.</p>
<p><span class="math display">\[\mu_X(a) = P(X = a) = P \{ \omega \in \Omega \mid X \omega = a \}\]</span></p>
<p>以下で確率空間は固定して考える.</p>
<h2 id="確率変数の独立性">確率変数の独立性</h2>
<p>加算無限個の確率変数 <span class="math display">\[X_1, X_2, \ldots\]</span> について次が成り立つ時, これらは <strong>独立</strong> であるという.</p>
<p>実数の上のボレル集合族 <span class="math inline">\(\BR\)</span> の任意の集合 （要は加算無限個の開区間を和積差で組み合わせて出来る集合） <span class="math display">\[E_1, E_2, \ldots \in \BR\]</span> に対して <span class="math display">\[P(X_1 \in E_1, X_2 \in E_2, \ldots) = \prod_i P(X_i \in E_i)\]</span> が成り立つ.</p>
<p>念の為に補足すると, 左辺は <span class="math inline">\(\{ \omega \in \Omega \mid X_1(\omega) \in E_1 \land X_2(\omega) \in E_2 \land \cdots \}\)</span> の確率測度で, 右辺は個々 <span class="math inline">\(\{ \omega \in \Omega \mid X_i(\omega) \in E_i \}\)</span> の確率測度の積.</p>
<h2 id="期待値分散">期待値、分散</h2>
<p>確率変数 <span class="math inline">\(X\)</span> の <strong>期待値</strong> を次で定義してそれを <span class="math inline">\(EX\)</span> と書く.</p>
<p><span class="math display">\[EX = \int_\Omega X \, dP\]</span></p>
<p>特に <span class="math inline">\(P\)</span> が離散であれば <span class="math inline">\(EX = \sum_{\omega \in \Omega} X \omega \times P(\omega)\)</span> と書ける.</p>
<p>確率変数 <span class="math inline">\(X\)</span> の <strong>分散</strong> を次で定義しそれを <span class="math inline">\(VX\)</span> と書く.</p>
<p><span class="math display">\[VX = E (X - EX)^2\]</span></p>
<h3 id="性質">性質</h3>
<ul>
<li><span class="math inline">\(E(aX + b) = a EX + b \; (a, b \in \R)\)</span></li>
<li><span class="math inline">\(V(aX + b) = a^2 VX \; (a, b \in \R)\)</span></li>
<li><span class="math inline">\(VX = E(X^2) - (EX)^2\)</span></li>
</ul>
<p>独立であるが同じ分布を持つ（このことを iid と言う） <span class="math inline">\(X_1, X_2, \ldots, X_n\)</span> を考える. これについて次が成り立つ.</p>
<ul>
<li><span class="math inline">\(E (\sum_i X_i) = \sum_i E X_i\)</span></li>
<li><span class="math inline">\(E (\prod X_i) = \prod_i E X_i\)</span></li>
<li><span class="math inline">\(V (\sum_i X_i) = \sum_i V X_i\)</span></li>
</ul>
<h2 id="マルコフの不等式">マルコフの不等式</h2>
<p>確率変数 <span class="math inline">\(X\)</span> について次が成り立つ.</p>
<p><span class="math display">\[\forall \epsilon &gt; 0, P(|X| &gt; \epsilon) \leq \frac{1}{\epsilon} E |X|\]</span></p>
<h3 id="証明">証明</h3>
<p><span class="math inline">\(A = [ |X| &gt; \epsilon ] \subset \Omega\)</span> と置くと <span class="math inline">\(E |X| = \int_\Omega |X| \, dP \geq \int_A |X| \, dP \geq \int_A \epsilon \, dP = \epsilon \times P(A)\)</span> より従う.</p>
<h2 id="チェビシェフの不等式">チェビシェフの不等式</h2>
<p><span class="math display">\[\forall \epsilon &gt; 0, P(|X - EX| &gt; \epsilon ) \leq \frac{1}{\epsilon^2} VX\]</span></p>
<h3 id="証明-1">証明</h3>
<p>マルコフの不等式と全く同様. <span class="math inline">\(A = \left[ |X-EX| &gt; \epsilon \right] \subset \Omega\)</span> と置いて, <span class="math inline">\(VX = E(X-EX)^2 \geq \int_A (X-EX)^2 \, dP \geq \epsilon^2 \times P(A)\)</span> から従う.</p>
<h2 id="確率変数の収束">確率変数の収束</h2>
<p>確率変数の列 <span class="math inline">\(\{ X_i \}_{i=1,2,\ldots}\)</span> の収束を次の二通りで定義する.</p>
<h3 id="確率収束">確率収束</h3>
<p>次が成り立つとき, <span class="math inline">\(\{X_i\}\)</span> は <span class="math inline">\(X\)</span> に確率収束するという. <span class="math display">\[\forall \epsilon &gt; 0, \lim_{n \to \infty} P(|X_n - X| &gt; \epsilon) = 0\]</span></p>
<h3 id="概収束-almost-surely-convergence">概収束 (almost surely convergence)</h3>
<p>一般に、確率変数 <span class="math inline">\(X\)</span> に関するある命題 <span class="math inline">\(\Phi(X)\)</span> が成立する確率が 1 のとき, 「 <strong>ほとんど確実に</strong> <span class="math inline">\(\Phi(X)\)</span> は成立する」と言い、「<span class="math inline">\(\Phi(X)\)</span> a.s.」と書く. ここで &quot;a.s.&quot; は almost surely の略.</p>
<p><strong>ほとんど確実に</strong> 確率変数の列 <span class="math inline">\(X_i\)</span> が <span class="math inline">\(X\)</span> に収束すること <span class="math display">\[P(\lim_i X_i = X) = 1\]</span> を <strong>概収束</strong> という.</p>
<p>一般に「概収束 <span class="math inline">\(\implies\)</span> 確率収束」は成り立つ. つまり概収束のほうが確率収束より強い.</p>
<h2 id="大数の法則">大数の法則</h2>
<p>iid な <span class="math inline">\(X_1, X_2, \ldots\)</span> を考える. 分布が等しいので <span class="math inline">\(m=E X_i\)</span> と置いておく. 期待値 <span class="math inline">\(m\)</span> も分散 <span class="math inline">\(VX_i\)</span> も（発散せず）値を定めるとする. <span class="math inline">\(n\)</span> 個の平均 <span class="math display">\[Y_n = \frac{1}{n} \left( X_1 + X_2 + \cdots + X_n \right)\]</span> は <span class="math inline">\(n \to \infty\)</span> のとき <span class="math inline">\(m\)</span> に収束する.</p>
<p>この収束の仕方として確率収束を言うのを「弱法則」、ほとんど確実収束を言うのを「強法則」という.</p>
<h3 id="弱法則の証明">弱法則の証明</h3>
<p><span class="math inline">\(\lim_n P(Y_n &gt; \epsilon) = 0\)</span> が成り立つことを言う.</p>
<p>まず先に確認することとして, <span class="math inline">\(EY_n = E(\frac{1}{n} \sum X_i) = m\)</span>,</p>
<p><span class="math display">\[\begin{align*}
VY_n &amp; = E(Y_n)^2 - (EY_n)^2 \\
&amp; = \frac{1}{n^2} E(\sum_i X_i)^2 - m^2 \\
&amp; = \frac{1}{n^2} E(\sum_i X_i^2 + \sum_{i \ne j} X_i X_j) - m^2 \\
&amp; = \frac{1}{n^2} E(n X_i^2 + n(n-1) X_i X_j) - m^2 \\
&amp; = \frac{1}{n} E(X_i^2 - m^2) \\
&amp; = \frac{1}{n} VX_i \\
\end{align*}\]</span></p>
<blockquote>
<p><span class="math inline">\(i \ne j\)</span> について <span class="math inline">\(E(X_i X_j) = m^2\)</span> としたところに, 独立性を利用している</p>
</blockquote>
<p>チェビシェフの不等式によれば,</p>
<p><span class="math display">\[\begin{align*}
P(|Y_n - m| &gt; \epsilon) &amp; \leq \frac{1}{\epsilon^2} VY_n \\
&amp; = \frac{1}{n\epsilon^2} VX_i \\
\end{align*}\]</span></p>
<p>最後の右辺は <span class="math inline">\(n \to \infty\)</span> のとき <span class="math inline">\(\to 0\)</span> なので, <span class="math inline">\(\lim_n P(Y_n &gt; \epsilon) = 0\)</span> が言えた.</p>
<h3 id="条件付きの強法則の証明">（条件付きの）強法則の証明</h3>
<p><span class="math inline">\(E(X_i^4)\)</span> の値（この値を4次モーメントという）が無限大に発散せずに値を定めると仮定したときに, <span class="math inline">\(P(\lim_n Y_n = m) = 1\)</span> であることを示す.</p>
<blockquote>
<p>4次モーメントが存在しなくても実はこの法則は成り立つ. もとの <span class="math inline">\(X_i\)</span> が iid であって期待値が存在しさえすれば本当はいいんだけど, 証明が難しい.</p>
</blockquote>
<p><span class="math inline">\(E \left( \sum_i (X_i - m) \right)^4\)</span> という値を考える. <span class="math inline">\(E\)</span> の線形性から, 和について分解することを考える. このときに, <span class="math inline">\(E (X_i - m) (X_j - m)^3\)</span> といった値は <span class="math inline">\(i \ne j\)</span> とするとその独立性より <span class="math inline">\(E (X_i - m) \times E(X_j-m)^3\)</span> に等しく, <span class="math inline">\(E (X_i-m)=0\)</span> よりゼロである. 従って結局残るのは <span class="math inline">\(E(X_i-m)^4\)</span> という項と, <span class="math inline">\(E(X_i-m)^2(X_j-m)^2\)</span> という項だけ. このことに注目すると,</p>
<p><span class="math display">\[\begin{align*}
E \left( \sum_i (X_i - m) \right)^4
&amp; = n E(X_i-m)^4 +
\left( \begin{array}{cc} 4 \\ 2\end{array} \right)
\left( \begin{array}{cc} n \\ 2\end{array} \right)
E(X_i-m)^2(X_j-m)^2 \\
&amp; = n E(X_i-m)^4 + 3n(n-1) (E(X_i-m)^2)^2
\end{align*}\]</span></p>
<p>従って, <span class="math inline">\(E(Y_n^4) = \frac{1}{n^4} E(X_i-m)^n = o(n^{-2})\)</span>. すなわちある定数 <span class="math inline">\(C\)</span> があって, <span class="math inline">\(E(Y_n^4) \leq C/n^2\)</span> といえる.</p>
<p>次に列 <span class="math inline">\(Y_i\)</span> の累積和を考えると, これは次のように収束する. <span class="math inline">\(E(\sum_{n=1}^\infty Y_n^4) = \sum E Y_n^4 \leq C \sum_i \frac{1}{i^2} &lt; \infty\)</span></p>
<p>さてここで次の補題を主張する.</p>
<h4 id="補題">補題</h4>
<p>iid な <span class="math inline">\(X_i\)</span> について, <span class="math display">\[\sum_i E|X_i| &lt; \infty \implies P(\sum_i |X_i| &lt; \infty) = 1.\]</span></p>
<p>絶対値を取ってるのは単に、正の確率変数であることを約束させるために過ぎない. 甘んじて <span class="math inline">\(\sum_i E|X_i| = E(\sum_i |X_i|)\)</span> であることまでは認めてもらうと, <span class="math inline">\(A = [ \sum_i |X_i| &lt; \infty ] \subset \Omega\)</span> とおいて <span class="math inline">\(\sum_i E|X_i| = \int_A |X_i| \, dP + \int_{\Omega \setminus A} |X_i| \, dP \geq \int_{\Omega \setminus A} |X_i| \, dP = P(\Omega \setminus A) \times \infty\)</span> なので, <span class="math inline">\(P(\Omega \setminus A)=0\)</span> でなければならない. 従って <span class="math inline">\(P(A)=1\)</span>.</p>
<p>この補題を <span class="math inline">\(|X_n| = Y_n^4\)</span> として適用すると, <span class="math display">\[P(\sum_n Y_n^4 &lt; \infty) = 1\]</span> が言えた.</p>
<p>数列 <span class="math inline">\({Y_n^4}\)</span> が非減少単調列でこれの累積和が概収束するので, <span class="math display">\[P(\lim_n Y_n^4 = 0) = 1\]</span> が言えた. 従って <span class="math display">\[\lim_{n \to \infty} Y_n = 0 ~~~ a.s.\]</span> であることも明らか.</p>
<!--

  以下を埋め込むと H2 タグを列挙してそれぞれへのリンクにする.
  ただし "INDEX" は除外する.

    <div id=toc></div>


  H2, H3 タグまでを列挙するには以下を埋め込む.

    <div id=toc-level-2></div>

-->
<script>
(function() {

  function naming(obj, name) {
      var PREF = document.createElement('a');
      PREF.name = name;
      obj.appendChild(PREF);
  }

  function level1() {

    var sections = document.getElementsByTagName('h2');
    var OL = document.createElement('ol');
    for (var i=0; i < sections.length; ++i) {
      var LI = document.createElement('li');
      var A = document.createElement('a');
      A.innerHTML = sections[i].innerHTML;
      if (A.innerHTML.toUpperCase() == 'INDEX') continue;
      A.href = '#' + i;
      LI.appendChild(A);
      OL.appendChild(LI);
      naming(sections[i], i);
      // var PREF = document.createElement('a');
      // PREF.name = i;
      // sections[i].appendChild(PREF);
    }

    return OL;
  }

  function level2() {

    var sections = document.querySelectorAll('h2,h3');
    var tree = [];
    for (var i = 0; i < sections.length; ++i) {
      if (sections[i].tagName == 'H2') {
        if (sections[i].innerHTML.toUpperCase() === 'INDEX') continue;
        tree.push([sections[i]]);
      } else {
        if (tree.length > 0) {
          tree[tree.length-1].push(sections[i]);
        } else {
          tree.push([sections[i]]);
        }
      }
    }

    var OL = document.createElement('ol');
    for (var i = 0; i < tree.length; ++i) {

      // h2-level
      var LI = document.createElement('li');
      var A = document.createElement('a');
      A.innerHTML = tree[i][0].innerHTML;
      A.href = '#' + i;
      naming(tree[i][0], i);
      LI.appendChild(A);

      // h3-level
      if (tree[i].length > 1) {
        var OL_sub = document.createElement('ol');
        for (var j = 1; j < tree[i].length; ++j) {
          var LI_sub = document.createElement('li');
          var A = document.createElement('a');
          A.innerHTML = tree[i][j].innerHTML;
          A.href = `#${i}-${j}`;
          naming(tree[i][j], `${i}-${j}`);
          LI_sub.appendChild(A);
          OL_sub.appendChild(LI_sub);
        }
        LI.appendChild(OL_sub);
      }

      OL.appendChild(LI);
    }

    return OL;
  }

  function append_toc() {
    if (document.getElementById('toc')) {
      document.getElementById('toc').appendChild(level1());
    }
    if (document.getElementById('toc-level-2')) {
      document.getElementById('toc-level-2').appendChild(level2());
    }
  }

  window.addEventListener('DOMContentLoaded', append_toc, false);
}());
</script>
</body>
</html>
