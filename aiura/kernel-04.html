<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <title>カーネル法 - カーネルの特性</title>
  <style type="text/css">code{white-space: pre;}</style>
  <link rel="stylesheet" href="../resources/css/c.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header>
<h1 class="title">カーネル法 - カーネルの特性</h1>
</header>
<p class="date" style="text-align: right">
2016-09-18 (Sun.)
</p>
<div class="is-pulled-right">
<p><a class='tag is-red' href=index.html#機械学習>機械学習</a></p>
</div>
<h2 id="index">index</h2>
<div id="toc">

</div>
<h2 id="内積空間">内積空間</h2>
<p><span class="math inline">\(\mathbb{R}\)</span> 上のベクトル空間 <span class="math inline">\(X\)</span> が <strong>内積空間 (inner product space)</strong> であるとは</p>
<ol type="1">
<li><span class="math inline">\(\langle x,z \rangle = \langle z,x \rangle\)</span></li>
<li><span class="math inline">\(\langle x,x \rangle \geq 0\)</span></li>
</ol>
<p>を満たす二項線形関数 <span class="math inline">\(\langle \cdot, \cdot \rangle: (X, X) \rightarrow \mathbb{R}\)</span> が定められた空間のことで、 この関数を <strong>内積 (inner product)</strong> という.</p>
<p>加えて</p>
<p><span class="math display">\[\langle x,x \rangle = 0 \iff x = 0\]</span></p>
<p>が成り立つ内積を <strong>strict</strong> な内積 (strict inner product) であるという.</p>
<p>また <span class="math inline">\(x \in X\)</span> のノルムを</p>
<p><span class="math display">\[|x| = \sqrt{\langle x,x \rangle}\]</span></p>
<p>で定義する.</p>
<h2 id="ヒルベルト空間">ヒルベルト空間</h2>
<p>内積空間であって分離可能 (separable) かつ完備 (complete) なものヒルベルト空間 <span class="math inline">\(\mathcal{F}\)</span> という.</p>
<p>完備であるとは、任意のコーシー列 <span class="math inline">\(\{ h_i \in \mathcal{F} : i \in \mathbb{N} \}\)</span> はある値 <span class="math inline">\(h \in \mathcal{F}\)</span> に収束すること. ここでコーシー列とは</p>
<p><span class="math display">\[\sup_{m&gt;n} | h_n - h_m | \rightarrow 0 ~~ (n \rightarrow \infty)\]</span></p>
<p>であった. また、分離可能であるとは、</p>
<p><span class="math display">\[\forall \epsilon&gt;0, \exists N \in \mathbb{N}, \exists h_1,\ldots,h_N \in \mathcal{F}, \forall h \in \mathcal{F}, \min_{i=1,\ldots,N} | h_i - h | &lt; \epsilon.\]</span></p>
<h3 id="例.-l_2-空間">例. <span class="math inline">\(L_2\)</span> 空間</h3>
<p><span class="math inline">\(X\)</span> を次のような実数の可算無限個からなる列の集合とする.</p>
<ul>
<li><span class="math inline">\(x \in X\)</span></li>
<li><span class="math inline">\(x = \left(x_1, x_2, \ldots, x_n, \ldots\right)\)</span>
<ul>
<li>s.t. <span class="math inline">\(\sum_{i=1}^\infty x_i^2 &lt; \infty\)</span></li>
</ul></li>
</ul>
<p>内積を次のように定める:</p>
<p><span class="math display">\[\langle x,y \rangle = \sum_{i=1}^\infty x_i y_i.\]</span></p>
<p>この空間を <span class="math inline">\(L_2\)</span> 空間という. これはヒルベルト空間らしい.</p>
<h3 id="例.-l_2x-空間">例. <span class="math inline">\(L_2(X)\)</span> 空間</h3>
<p>先の <span class="math inline">\(L_2\)</span> の連続バージョン. <span class="math inline">\(\mathbb{R}^n\)</span> のコンパクトな部分集合 <span class="math inline">\(X\)</span> について</p>
<p><span class="math display">\[L_2(X) = \left\{ f : \int_X f(x)^2 dx &lt; \infty \right\}\]</span></p>
<p>とする. <span class="math inline">\(L_2(X)\)</span> 上の内積を次で定める.</p>
<p><span class="math display">\[\langle f,g \rangle = \int_X f(x) g(x) dx\]</span></p>
<p>これもヒルベルト空間.</p>
<h2 id="コーシーシュワルツの不等号-cauchy-schwarz-inequality">コーシー・シュワルツの不等号 (Cauchy-Schwarz inequality)</h2>
<p>内積について次が成立する.</p>
<p><span class="math display">\[\langle x,z \rangle^2 \leq |x|^2 |z|^2\]</span></p>
<p>内積が strict なとき、等号が成り立つのは <span class="math inline">\(x = az\)</span> (<span class="math inline">\(a\)</span> はスカラー) のときに限る.</p>
<h3 id="証明">証明</h3>
<p>正の微小量 <span class="math inline">\(\epsilon\)</span> を考える.</p>
<ul>
<li><span class="math inline">\(0 \leq | (|z| + \epsilon)~x \pm (|x| + \epsilon)~z |^2\)</span>
<ul>
<li><span class="math inline">\(= \langle \_,~\_ \rangle\)</span></li>
<li><span class="math inline">\(= (|z| + \epsilon)^2~|x|^2 + (|x| + \epsilon)^2~|z|^2 \pm 2 (|x|+\epsilon) (|z| + \epsilon) ~ \langle x, z \rangle\)</span></li>
<li><span class="math inline">\(\leq (|z| + \epsilon)^2 (|x| + \epsilon)^2 + (|x| + \epsilon)^2 (|z| + \epsilon)^2 \pm 2 (|x|+\epsilon) (|z| + \epsilon) ~ \langle x, z \rangle\)</span></li>
<li><span class="math inline">\(= 2 (|z| + \epsilon)^2 (|x| + \epsilon)^2 \pm 2 (|x|+\epsilon) (|z| + \epsilon) ~ \langle x, z \rangle\)</span></li>
</ul></li>
</ul>
<p><span class="math inline">\(|x| + \epsilon &gt; 0\)</span>, <span class="math inline">\(|z| + \epsilon &gt; 0\)</span> だから</p>
<p><span class="math display">\[\mp\langle x,z \rangle \leq (|x| + \epsilon) \cdot (|z| + \epsilon)\]</span></p>
<p>左辺に関して <span class="math inline">\(\langle x,z \rangle\)</span> または <span class="math inline">\(-\langle x,z \rangle\)</span> のどちらかは非負であることに註意すれば、 両辺自乗して <span class="math inline">\(\epsilon \rightarrow 0\)</span> の極限を取ることで</p>
<p><span class="math display">\[\langle x,z \rangle^2 \leq |x|^2 |z|^2\]</span></p>
<p>strict なとき、<span class="math inline">\(x=az\)</span> のときにこれが成り立つのは自明. 逆にこれが成り立つとき、今の証明を逆に辿って</p>
<ul>
<li><span class="math inline">\(0 = \left|~ (|z|~x - |x|~z) ~\right|^2\)</span></li>
<li><span class="math inline">\(\iff 0 = |z|~x - |x|~z\)</span> (strict)</li>
</ul>
<p>すなわち <span class="math display">\[x = \frac{|x|}{|z|} z\]</span> の関係 (rescaling) を得る. 以上から、等号成立と、<span class="math inline">\(x=az\)</span> とが同値であることが示された.</p>
<h2 id="偏角">偏角</h2>
<p>2つのベクトル <span class="math inline">\(x, z\)</span> について偏角 <span class="math inline">\(\theta\)</span> は次で定められる. ただし内積は strict とする.</p>
<p><span class="math display">\[\cos \theta = \frac{\langle x,z \rangle}{|x|~|z|}\]</span></p>
<p>偏角が <span class="math inline">\(\cos \theta = 0\)</span> のとき、2つのベクトルは直交するという.</p>
<p>集合 <span class="math inline">\(S = \{x_1, \ldots, x_m\}\)</span> が <span class="math inline">\(X\)</span> 上の <strong>正規直交系 (orthonormal)</strong> であるとは、</p>
<p><span class="math display">\[\forall i, j ~(1 \leq i, j \leq m), \langle x_i, x_j \rangle = \delta_{i,j}\]</span></p>
<p>とあること. ここで <span class="math inline">\(\delta_{i,j}\)</span> はクロネッカーのデルタ.</p>
<p>正規直交系 <span class="math inline">\(S\)</span> に関する <span class="math inline">\(z \in X\)</span> のフーリエ級数 (Fourier series) とは</p>
<p><span class="math display">\[\sum_{x \in S} \langle x, z \rangle x\]</span></p>
<p>のこと. この値が <span class="math inline">\(z\)</span> と常に等しくなるような <span class="math inline">\(S\)</span> を <strong>基底 (basis)</strong> とも言う.</p>
<p>行列 <span class="math inline">\(X \in \mathbb{R}^{n \times m}\)</span> の <strong>rank</strong> とは、列ベクトルが張る空間の次元のこと. rank が今 <span class="math inline">\(r\)</span> だとすると、行列 <span class="math inline">\(T \in \mathbb{R}^{n \times r}\)</span>, <span class="math inline">\(S \in \mathbb{R}^{r \times m}\)</span> を用いて <span class="math inline">\(X = TS\)</span> とできる. ただし <span class="math inline">\(T\)</span> の列ベクトルは線形独立. 註意すべき点としては列ベクトルに注目する代わりに行ベクトルで考えても rank <span class="math inline">\(r\)</span> は変わらないこと. 即ち転置 <span class="math inline">\(X&#39;\)</span> のrankは <span class="math inline">\(X\)</span> に等しい. また、<span class="math inline">\(r = \min(n,m)\)</span> のとき、<span class="math inline">\(X\)</span> は full rank であるという.</p>
<h2 id="グラム行列">グラム行列</h2>
<p>あるベクトルの集合 <span class="math inline">\(S = \{ x_1, \ldots, x_\ell \}\)</span> の <strong>グラム行列</strong> <span class="math inline">\(G\)</span> とは <span class="math inline">\(\ell \times \ell\)</span> 行列であって <span class="math inline">\(G_{i,j} = \langle x_i, x_j \rangle\)</span> のこと. <span class="math inline">\(x \in X\)</span> を特徴空間に写す <span class="math inline">\(\phi\)</span> に対応するようなカーネル関数 <span class="math inline">\(\kappa\)</span> を考慮するとき、これに関するグラム行列 <span class="math inline">\(G\)</span> とは <span class="math inline">\(G_{i,j} = \kappa(x_i, x_j)\)</span> だと再定義する. グラム行列が対称行列 (<span class="math inline">\(G_{i,j} = G_{j,i}\)</span>) であることは自明.</p>
<h3 id="特異行列">特異行列</h3>
<p>行列 <span class="math inline">\(A\)</span> が <strong>特異 (singular)</strong> であるとは、<span class="math inline">\(A\)</span> の行ベクトルの非自明な線型結合で <span class="math inline">\(0\)</span> にできること. すなわち <span class="math inline">\(0\)</span> でない列ベクトル <span class="math inline">\(x\)</span> を右から掛けて <span class="math display">\[Ax=0\]</span> とできること.</p>
<p>行列 <span class="math inline">\(A\)</span> が <strong>正則 (non-singular)</strong> のとき、なんやかんやあって <span class="math inline">\(A\)</span> の逆行列 <span class="math inline">\(A^{-1}\)</span> が存在する.</p>
<h3 id="固有値">固有値</h3>
<p>行列 <span class="math inline">\(A\)</span> について、<span class="math inline">\(Av=\lambda v\)</span> を満たす実数 <span class="math inline">\(\lambda\)</span> を固有値 (eigenvalue)、列ベクトル <span class="math inline">\(v\)</span> を固有ベクトル (eigenvector) という. 行ベクトルを左から掛けた <span class="math inline">\(v&#39; v\)</span> が実数であることに註意すると</p>
<p><span class="math display">\[\frac{v&#39;Av}{v&#39;v} = \lambda.\]</span></p>
<p>この左辺を <strong>レイリー商 (Rayleigh quotient)</strong> という. この式からも固有値は固有ベクトルのスカラー倍に関して普遍であることは自明なので、これ以降、固有ベクトルの大きさは <span class="math inline">\(|v| = 1\)</span> だとする.</p>
<p>行列 <span class="math inline">\(A\)</span> が対称行列のとき <span class="math inline">\(A&#39; = A\)</span>. <span class="math inline">\(A\)</span> の<u>異なる</u>固有値 <span class="math inline">\(\lambda_1\)</span>, <span class="math inline">\(\lambda2\)</span> とそれぞれに対応する固有ベクトル <span class="math inline">\(v_1\)</span>, <span class="math inline">\(v_2\)</span> について</p>
<ul>
<li><span class="math inline">\(\lambda_1 \langle v_1, v_2 \rangle = (\lambda_1 v_1)&#39; \cdot v_2\)</span></li>
<li><span class="math inline">\(= (A v_1)&#39; \cdot v_2\)</span></li>
<li><span class="math inline">\(= v_1&#39; A&#39; v_2 = v_1&#39; A v_2\)</span></li>
<li><span class="math inline">\(= v_1&#39; (\lambda_2 v_2) = \lambda_2 \langle v_1, v_2 \rangle\)</span></li>
</ul>
<p>従って <span class="math inline">\(\lambda_1 \ne \lambda_2 \Rightarrow \langle v_1, v_2 \rangle = 0\)</span>. 即ち、対称行列の異なる2つの固有ベクトルは直交する. このことは、<span class="math inline">\(n \times n\)</span> 行列の相異なる固有ベクトルは高々 <span class="math inline">\(n\)</span> 個だということも示す.</p>
<p>行列 <span class="math inline">\(A\)</span> の一つの固有ベクトル <span class="math inline">\(v\)</span> と対応する固有値 <span class="math inline">\(\lambda\)</span> を以って</p>
<p><span class="math display">\[A \mapsto \tilde{A} = A - \lambda v v&#39;\]</span></p>
<p>という操作を <strong>deflation</strong> という. この操作に依って <span class="math inline">\(v\)</span> は固有ベクトルではなくなる (since <span class="math inline">\(\tilde{A}v = Av-\lambda vv&#39;v = 0\)</span>). <span class="math inline">\(A\)</span> が full rank であったとしても <span class="math inline">\(\tilde{A}\)</span> は線形従属な列ベクトルを持つので確実に full rank ではなくなった. 一方で<span class="math inline">\(A\)</span> の他の固有ベクトル <span class="math inline">\(v_2\)</span> は尚も <span class="math inline">\(\tilde{A}\)</span> の固有ベクトルである (since <span class="math inline">\(v&#39; v_2 = 0\)</span>).</p>
<p>非決定的にただひとつ固有ベクトルを探すアルゴリズムがあるとき、deflation という操作を繰り返すことで、全ての固有ベクトルを列挙することが可能.</p>
<p>対称行列 <span class="math inline">\(A \in \mathbb{R}^{n \times n}\)</span> が full rank で <span class="math inline">\(n\)</span> 個の固有ベクトルを持つとする. 固有ベクトル (列) を並べた行列 <span class="math inline">\(V\)</span> を以って</p>
<p><span class="math display">\[AV = V\Lambda\]</span></p>
<p>と書ける. <span class="math inline">\(\Lambda\)</span> は対角成分に固有値を並べたものになる. 対称行列なら固有ベクトルが互いに直交するから <span class="math inline">\(V&#39; = V^{-1}\)</span> なので</p>
<p><span class="math display">\[A = V\Lambda V&#39;\]</span></p>
<p><span class="math inline">\(A\)</span> をこの形に記述することを固有値分解という. <span class="math inline">\(A\)</span> の逆行列は次のように容易に求められる:</p>
<p><span class="math display">\[A^{-1} = V&#39; \Lambda^{-1} V\]</span></p>
<p>これは <span class="math inline">\(A\)</span> の逆行列が存在することをも示す.</p>
<p>あと <span class="math inline">\(A\)</span> の固有ベクトル <span class="math inline">\(v_i\)</span>、固有値 <span class="math inline">\(\lambda_i\)</span> に対して、 <span class="math inline">\(A^2\)</span> の固有ベクトルは <span class="math inline">\(v_i\)</span> 固有値 <span class="math inline">\(\lambda_i^2\)</span> なのはすぐ確かめられて</p>
<p><span class="math display">\[A^2 = V \Lambda^2 V&#39;.\]</span></p>
<h3 id="thm.-courant-fisher-定理">Thm. Courant-Fisher 定理</h3>
<p>対称行列 <span class="math inline">\(A \in \mathbb{R}^{n \times n}\)</span> の固有値を大きい順に <span class="math inline">\(\lambda_1, \lambda_2, \ldots, \lambda_n\)</span> とする. <span class="math inline">\(k\)</span> 番目の固有値は次のように求まる.</p>
<p><span class="math display">\[\lambda_k = \max_{dim(T)=k~} ~~ \min_{v \in T, v \ne 0} \frac{v&#39;Av}{v&#39;v}\]</span> <span class="math display">\[= \min_{dim(T)=n-k+1~} ~~ \max_{v \in T, v \ne 0} \frac{v&#39;Av}{v&#39;v}\]</span></p>
<h3 id="半正定値行列-positive-semi-definite-matrices">半正定値行列 (positive semi-definite matrices)</h3>
<p>対称行列 <span class="math inline">\(A \in \mathbb{R}^{n \times n}\)</span> が <strong>半正定値行列</strong> であるとは、 全ての固有値が非負であること. これは、Courant-Fisher 定理を用いると、任意のベクトル <span class="math inline">\(v\)</span> に対して</p>
<p><span class="math display">\[v&#39; A v \geq 0\]</span></p>
<p>が成り立つことと同値.</p>
<p>同様に、正定値行列であるとは、全ての固有値が正であること. すなわち 任意のベクトル <span class="math inline">\(v\)</span> に対して</p>
<p><span class="math display">\[v&#39; A v &gt; 0\]</span></p>
<p>が成り立つこと.</p>
<h4 id="prop-3.7">Prop 3.7</h4>
<p>グラム行列は半正定値行列.</p>
<h5 id="証明-1">証明</h5>
<ul>
<li><span class="math inline">\(v&#39;Gv = \sum_i \sum_j v_i v_j G_{i,j} = \sum_i \sum_j v_i v_j \langle \phi(x_i), \phi(x_j) \rangle\)</span></li>
<li><span class="math inline">\(= \langle \sum_i v_i \phi(x_i), \sum_j v_j \phi(x_j) \rangle\)</span></li>
<li><span class="math inline">\(= \langle \_, \_ \rangle\)</span></li>
<li><span class="math inline">\(\geq 0\)</span></li>
</ul>
<h4 id="prop-3.8">Prop 3.8</h4>
<p>行列 <span class="math inline">\(A\)</span> が半正定値行列であることは、ある実行列<span class="math inline">\(B\)</span> が存在して <span class="math inline">\(A=B&#39;B\)</span> と書けることと同値.</p>
<h5 id="証明-2">証明</h5>
<p><span class="math inline">\(A=B&#39;B\)</span> を仮定したとき、 任意のベクトル <span class="math inline">\(v\)</span> を以って <span class="math inline">\(v&#39;Av = v&#39;B&#39;Bv = |Bv|^2 \geq 0\)</span> なので <span class="math inline">\(A\)</span> は半正定値.</p>
<p><span class="math inline">\(A\)</span> が半正定値行列のとき、 固有値分解して <span class="math inline">\(AV = V\Lambda\)</span> と書いて <span class="math inline">\(B = \sqrt{\Lambda} V&#39;\)</span> とすれば <span class="math inline">\(A=B&#39;B\)</span> を得る. ここで対角行列 <span class="math inline">\(\Lambda\)</span> に対して <span class="math inline">\(\sqrt{\Lambda}\)</span> は対角成分の <span class="math inline">\(\sqrt{\_}\)</span> を取るもので、今、固有値は <span class="math inline">\(\geq 0\)</span> を仮定してるので.</p>
<p>行列 <span class="math inline">\(A\)</span> を <span class="math inline">\(A = B&#39;B\)</span> に書きなおすような分解を考える. これを満たす <span class="math inline">\(B\)</span> は一般に一意ではない. 上三角行列 <span class="math inline">\(R\)</span> を以って <span class="math inline">\(A = R&#39; R\)</span> と書くのを Cholesky 分解という.</p>
<h4 id="prop-3.9">Prop 3.9</h4>
<p>(半) 正定値行列 <span class="math inline">\(A\)</span> iff <span class="math inline">\(A\)</span> の任意の主小行列 (principal minor) は (半) 正定値行列.</p>
<h5 id="証明-3">証明</h5>
<p><span class="math inline">\(A \in R^{n \times n}\)</span> についてその主小行列 <span class="math inline">\(M \in R^{m \times m}\)</span> とは、<span class="math inline">\(1 \leq k_1 &lt; k_2 &lt; \ldots &lt; k_m \leq n\)</span> を選んで <span class="math inline">\(M_{i,j} = A_{k_i, k_j}\)</span>.</p>
<p>証明はほとんど自明. (<span class="math inline">\(\Rightarrow\)</span>) <span class="math inline">\(u&#39;Mu\)</span> について、ベクトル <span class="math inline">\(u\)</span> に適切にゼロを挿入して出来る <span class="math inline">\(v\)</span> を用いて、 <span class="math inline">\(u&#39;Mu = v&#39;Av\)</span>. <span class="math inline">\(v&#39;Av \geq 0\)</span> より <span class="math inline">\(u&#39;Mu \geq 0\)</span>.</p>
<p>(<span class="math inline">\(\Leftarrow\)</span>) 右矢印が成り立つなら、 <span class="math inline">\(A\)</span> 自体が <span class="math inline">\(A\)</span> の主小行列であることから明らか.</p>
<h3 id="行列式とトレース">行列式とトレース</h3>
<p>製法行列 <span class="math inline">\(A\)</span> の <strong>行列式 (determinant)</strong> <span class="math inline">\(det(A)\)</span> とは <span class="math inline">\(A\)</span> の固有値の積であると定義する. 従って正定値の行列式は必ず正となる. また特異行列の行列式はゼロになる.</p>
<p>また、定義から頑張れば次が導ける:</p>
<p><span class="math display">\[det(AB) = det(A) det(B).\]</span></p>
<p><span class="math inline">\(A\)</span> の対角成分の和を <strong>トレース (trace)</strong> <span class="math inline">\(tr(A)\)</span> という.</p>
<p><span class="math display">\[tr(A) = \sum_i A_{i,i}\]</span></p>
<p>自明に次が成立: <span class="math display">\[tr(AB) = tr(BA).\]</span></p>
<p>これを用いると <span class="math inline">\(tr(V^{-1}AV) = tr((AV) V^{-1}) = tr(AI) = tr(A)\)</span> が分かる.</p>
<h3 id="def-3.10">Def 3.10</h3>
<p>二項関数 <span class="math inline">\(\kappa: X \times X \rightarrow \mathbb{R}\)</span> が <strong>有限半正定値関数 (finitely positive semi-definite)</strong> であるとは、 任意の有限集合 <span class="math inline">\(X&#39; \subseteq X\)</span> を以って、<span class="math inline">\((A)_{x, y} = \kappa(x, y)\)</span> (<span class="math inline">\(x, y \in X&#39;\)</span>) が半正定値行列であること.</p>
<h3 id="thm-3.11">Thm 3.11</h3>
<p>ある関数 <span class="math inline">\(\kappa: X \times X \rightarrow \mathbb{R}\)</span> が連続である、またはドメインが有限であるとする. この関数が<span class="math inline">\(X\)</span> をヒルベルト空間 <span class="math inline">\(F\)</span> に写すような写像 <span class="math inline">\(\phi\)</span> によって <span class="math display">\[\kappa(x,z) = \langle \phi(x), \phi(z) \rangle\]</span> と分解できることの必要十分条件は、 <span class="math inline">\(\kappa\)</span> が有限半正定値関数であること.</p>
<p>カーネル関数 <span class="math inline">\(\kappa\)</span> と (可算無限以下の) 集合 <span class="math inline">\(X\)</span> を以って、次の関数空間を考える:</p>
<p><span class="math display">\[\mathcal{F} = \left\{ \sum_{i=1}^\ell \alpha_i \kappa(x_i, \cdot) : \ell \in \mathbb{N}, x_i \in X, \alpha_i \in \mathbb{R} \right\}\]</span></p>
<p>例えば、線形分類器の学習とは、学習データ <span class="math inline">\(X\)</span> に就いて適切な <span class="math inline">\(\kappa\)</span> を選んで出来る <span class="math inline">\(\mathcal{F}\)</span> から適切な関数を一つ選択する作業にほかならない.</p>
<p><span class="math inline">\(\mathcal{F}\)</span> は自明にベクトル空間である. すなわち、 <span class="math inline">\(f \in \mathcal{F} \Rightarrow \beta f \in \mathcal{F}\)</span> や <span class="math inline">\(f, g \in \mathcal{F} \Rightarrow f + g \in \mathcal{F}\)</span> が成立する.</p>
<p>この空間に内積を定める.</p>
<ul>
<li><span class="math inline">\(f(x) = \sum_{i=1}^\ell \alpha_i \kappa(x_i, x) \in \mathcal{F}\)</span></li>
<li><span class="math inline">\(g(x) = \sum_{j=1}^n \beta_j \kappa(z_j, x) \in \mathcal{F}\)</span></li>
</ul>
<p>に対して</p>
<p><span class="math display">\[\langle f, g \rangle \equiv \sum_{i=1}^\ell \sum_{j=1}^n \alpha_i \beta_j \kappa(x_i, z_j)
= \sum_{i=1}^\ell \alpha_i g(x_i)
= \sum_{j=1}^n \beta_j f(z_j)\]</span></p>
<p>これは内積の公理を満たしている.</p>
<p><span class="math inline">\(g = \kappa(x, \cdot)\)</span> との内積を考えると <span class="math inline">\(\langle f, g \rangle = \sum_i^\ell \alpha_i \kappa(x, x_i) = f(x)\)</span> を得る. この性質を reproducing property という.</p>
<p>関数のコーシー列 <span class="math inline">\((f_n)_{n=1}^\infty\)</span> を考える. 先ほどの reproducing producty 及び内積の線形性を用いると次を得る.</p>
<p><span class="math display">\[(f_n(x) - f_m(x))^2 = \left\langle f_n - f_m, \kappa(x, \cdot) \right\rangle^2\]</span></p>
<p>さらにコーシー・シュワルツの不等式は次を言う.</p>
<p><span class="math display">\[\left\langle f_n - f_m, \kappa(x, \cdot) \right\rangle^2 \leq \| f_n - f_m \|^2 \kappa(x, x)\]</span></p>
<p>というわけで任意の <span class="math inline">\(x\)</span> について <span class="math inline">\(f(x)\)</span> 自体もある値に収束することが分かる.</p>
<p><span class="math inline">\(x\)</span> を先ほど言ったような関数に写す (高階) 関数 <span class="math inline">\(\phi(x) = \kappa(x, \cdot)\)</span> を用いると、先程書いたのは改めて</p>
<p><span class="math display">\[\langle f, \phi(x) \rangle = \langle f, \kappa(x, \cdot) \rangle = f(x)\]</span></p>
<p>と書き直せる.</p>
<p>内積が strict で、今 <span class="math inline">\(\| f \|^2 = \langle f, f \rangle = 0\)</span> なとき、 <span class="math inline">\(f(x) = \left\langle f, \phi(x) \right\rangle \leq \|f\| \|\phi(x)\| = 0\)</span> ゆえに、任意の <span class="math inline">\(x\)</span> について <span class="math inline">\(f(x) \leq 0\)</span> を得る.</p>
<!--

  HTML として pandoc -B で include する.

  <H2> を列挙してそれらにリンクを貼った toc を id='toc' に埋め込む.
  markdown で書いてるだろうから例として次のような段落を書けばよい.

```
## INDEX
<div id=toc></div>
```

  used in
  - /memo/gnuplot
  - /memo/linux
  - /memo/imagemagick

-->
<script>
(function() {
  var sections = document.getElementsByTagName('h2');
  var i;
  var OL = document.createElement('ol');
  for (i=0; i < sections.length; ++i) {
    var LI = document.createElement('li');
    var A = document.createElement('a');
    A.innerHTML = sections[i].innerHTML;
    if (A.innerHTML.toUpperCase() == 'INDEX') continue;
    A.href = '#' + i;
    LI.appendChild(A);
    OL.appendChild(LI);

    var PREF = document.createElement('a');
    PREF.name = i;
    sections[i].appendChild(PREF);
  }

  var done = false;
  function work() {
    if (done) return;
    if ( document.getElementById('toc') === null) return; // no toc element
    document.getElementById('toc').appendChild(OL);
    done = true;
  };

  window.onload = work;
  setTimeout(work,800);
}());
</script>
</body>
</html>
