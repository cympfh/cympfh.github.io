<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <title>Mon Aug 3 15:27:20 JST 2015</title>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
  </style>
  <link rel="stylesheet" href="../../../resources/css/c.css">
  <link rel="stylesheet" href="../../css/post.css">
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<a href="../../">🔙 Back to Top</a>
<header>
<h1 class="title">Mon Aug 3 15:27:20 JST 2015</h1>
</header>
<h2 id="今日のこと">今日のこと</h2>
<p>最近家のクーラーをつけっぱなしで生活している。</p>
<p>今日12時ごろに家を出て数秒歩いただけで頭痛が出てきた。 今日は寝て過ごすことに決めた。</p>
<p>先日、7/28に夏コミの為の印刷を出した。 <a href="http://www.seichoku.com/" class="uri">http://www.seichoku.com/</a>。 その時はコミケの為の特別な手配をしてくれるようなところに見えなかったけれど、 今日見ると、夏コミの為の色々なことを、 具体的にはコミケ会場への配達を無料でやってくれていたらしい。 8/6までに出せばよかったらしい。 来年からの参考にしよう。</p>
<p>奥付というもののルールを甘く見ていた。 印刷所のルールでもコミケットアピールでのルールでも、 奥付としていくつかがルール付されていた。</p>
<ul>
<li>タイトル</li>
<li>出版日</li>
<li>著者（サークル名）</li>
<li>連絡先</li>
<li>印刷所の名前</li>
</ul>
<p>今回はこれをガン無視していた。 私のは上の4つは書いてたけれど、印刷所の名前はダサいので入れてなかった。 調べるとYahoo知恵袋で、そんくらい無くても大丈夫だよ、という記述を見かけたが、 不安だ。</p>
<hr />
<h2 id="haskell-四則パズル-10パズル-make-a-ten">Haskell 四則パズル 10パズル Make a ten</h2>
<p>解いた: <a href="http://judge.u-aizu.ac.jp/onlinejudge/description.jsp?id=0041">数式 | Aizu Online Judge</a>。 使える演算が <code>+-*</code> の3つだけで、 しかもよく見ると入力が 4 つの <code>0-9</code> なので、0以上の自然数の範囲だけでよかった。 下のは整数 (<code>Int</code>) の範囲で解く。 割り算が使えるようにするには有理数の使い方を調べなくっちゃいけない。</p>
<p>こういうの、 絶対、 大昔に書いてネットのどこかにあるのに見つけられないや。</p>
<p>このリンクいつまで持つのかな: <a href="https://ideone.com/Lso7nn" class="uri">https://ideone.com/Lso7nn</a></p>
<h3 id="example">example</h3>
<pre><code>stdin
---
1 1 1 1
9 9 9 9
1 2 3 4
2 3 4 5
0 0 0 0

stdout
---
0
0
(((1 + 2) + 3) + 4)
(5 - ((2 - 3) - 4))</code></pre>
<h3 id="src">src</h3>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="co">{-</span>
<span class="co"> - AOJ 0041: Expression (original in PCK 2004)</span>
<span class="co"> - http://judge.u-aizu.ac.jp/onlinejudge/description.jsp?id=0041</span>
<span class="co"> -}</span>

<span class="kw">import </span><span class="dt">Data.Array.IO</span>
<span class="kw">import </span><span class="dt">Data.Char</span>
<span class="kw">import </span><span class="dt">System.IO</span>
<span class="kw">import </span><span class="dt">Control.Monad</span>
<span class="kw">import </span><span class="dt">Control.Applicative</span>

<span class="co">{-</span>
<span class="co"> - list から 1, 2 個選んで残りも一緒に返す</span>
<span class="co"> - 2個選ぶときは順序付きのペアだとする (x,y) と (y,x) を一般に区別する</span>
<span class="co"> - &gt; one [1..6]</span>
<span class="co"> - [(1,[2,3,4,5,6]),(2,[3,4,5,6,1]),(3,[4,5,6,2,1]),</span>
<span class="co">    (4,[5,6,3,2,1]),(5,[6,4,3,2,1]),(6,[5,4,3,2,1])]</span>
<span class="co"> - &gt; two [1..6]</span>
<span class="co"> - [(1,2,[3,4,5,6]),(1,3,[4,5,6,2]),(1,4,[5,6,3,2]),(1,5,[6,4,3,2]),(1,6,[5,4,3,2]),</span>
<span class="co">    (2,3,[4,5,6,1]),(2,4,[5,6,1,3]),(2,5,[6,1,4,3]),(2,6,[1,5,4,3]),(2,1,[6,5,4,3]),</span>
<span class="co">    (3,4,[5,6,2,1]),(3,5,[6,2,1,4]),(3,6,[2,1,5,4]),(3,2,[1,6,5,4]),(3,1,[2,6,5,4]),</span>
<span class="co">    (4,5,[6,3,2,1]),(4,6,[3,2,1,5]),(4,3,[2,1,6,5]),(4,2,[1,3,6,5]),(4,1,[2,3,6,5]),</span>
<span class="co">    (5,6,[4,3,2,1]),(5,4,[3,2,1,6]),(5,3,[2,1,4,6]),(5,2,[1,3,4,6]),(5,1,[2,3,4,6]),</span>
<span class="co">    (6,5,[4,3,2,1]),(6,4,[3,2,1,5]),(6,3,[2,1,4,5]),(6,2,[1,3,4,5]),(6,1,[2,3,4,5])]</span>
<span class="co">-}</span>

<span class="ot">one ::</span> [a] <span class="ot">-&gt;</span> [(a, [a])]
one xs <span class="fu">=</span> sub xs []
  <span class="kw">where</span>
    sub [] _ <span class="fu">=</span> []
    sub (x<span class="fu">:</span>xs) ac <span class="fu">=</span> (x, xs<span class="fu">++</span>ac) <span class="fu">:</span> (sub xs (x<span class="fu">:</span>ac))

<span class="ot">two ::</span> [a] <span class="ot">-&gt;</span> [(a, a, [a])]
two [] <span class="fu">=</span> []
two [a] <span class="fu">=</span> []
two xs <span class="fu">=</span> <span class="kw">do</span>
  (x, rest) <span class="ot">&lt;-</span> one xs
  <span class="kw">do</span>
    (y, rest) <span class="ot">&lt;-</span> one rest
    return (x, y, rest)

<span class="kw">data</span> <span class="dt">Expr</span> <span class="fu">=</span> <span class="dt">Val</span> <span class="dt">Int</span> <span class="fu">|</span> <span class="dt">Add</span> <span class="dt">Expr</span> <span class="dt">Expr</span> <span class="fu">|</span> <span class="dt">Sub</span> <span class="dt">Expr</span> <span class="dt">Expr</span> <span class="fu">|</span> <span class="dt">Mul</span> <span class="dt">Expr</span> <span class="dt">Expr</span>
<span class="kw">type</span> <span class="dt">Number</span> <span class="fu">=</span> (<span class="dt">Expr</span>, <span class="dt">Int</span>)

<span class="ot">eval ::</span> <span class="dt">Number</span> <span class="ot">-&gt;</span> <span class="dt">Int</span>
eval <span class="fu">=</span> snd

<span class="co">{-</span>
<span class="co"> - n 個の Number に一回演算を適用して出来る (n-1) 個の Number を返す</span>
<span class="co"> -}</span>
<span class="ot">apply ::</span> [<span class="dt">Number</span>] <span class="ot">-&gt;</span> [[<span class="dt">Number</span>]]
apply xs <span class="fu">=</span> concat <span class="fu">$</span> <span class="kw">do</span>
  ((e, x), (f, y), rest) <span class="ot">&lt;-</span> two xs
  return [
    (<span class="dt">Add</span> e f, x <span class="fu">+</span> y) <span class="fu">:</span> rest,
    (<span class="dt">Sub</span> e f, x <span class="fu">-</span> y) <span class="fu">:</span> rest,
    (<span class="dt">Mul</span> e f, x <span class="fu">*</span> y) <span class="fu">:</span> rest
    ]

<span class="co">{-</span>
<span class="co"> - (bfs n xs) は xs に何度か apply を適用して</span>
<span class="co"> - 評価結果が n になる Number を返す</span>
<span class="co"> -}</span>
<span class="ot">bfs ::</span> <span class="dt">Int</span> <span class="ot">-&gt;</span> [[<span class="dt">Number</span>]] <span class="ot">-&gt;</span> [<span class="dt">Number</span>]
bfs n [] <span class="fu">=</span> []
bfs n ([x] <span class="fu">:</span> rest) <span class="fu">=</span>
  (<span class="kw">if</span> (eval x) <span class="fu">==</span> n <span class="kw">then</span> [x] <span class="kw">else</span> []) <span class="fu">++</span> (bfs n rest)
bfs n (xs <span class="fu">:</span> rest) <span class="fu">=</span> bfs n (rest <span class="fu">++</span> (apply xs))

<span class="kw">instance</span> <span class="dt">Show</span> <span class="dt">Expr</span> <span class="kw">where</span>
  show (<span class="dt">Val</span> n) <span class="fu">=</span> show n
  show (<span class="dt">Add</span> e f) <span class="fu">=</span> <span class="st">&quot;(&quot;</span> <span class="fu">++</span> show e <span class="fu">++</span> <span class="st">&quot; + &quot;</span> <span class="fu">++</span> show f <span class="fu">++</span> <span class="st">&quot;)&quot;</span>
  show (<span class="dt">Sub</span> e f) <span class="fu">=</span> <span class="st">&quot;(&quot;</span> <span class="fu">++</span> show e <span class="fu">++</span> <span class="st">&quot; - &quot;</span> <span class="fu">++</span> show f <span class="fu">++</span> <span class="st">&quot;)&quot;</span>
  show (<span class="dt">Mul</span> e f) <span class="fu">=</span> <span class="st">&quot;(&quot;</span> <span class="fu">++</span> show e <span class="fu">++</span> <span class="st">&quot; * &quot;</span> <span class="fu">++</span> show f <span class="fu">++</span> <span class="st">&quot;)&quot;</span>

<span class="ot">toVal ::</span> <span class="dt">Int</span> <span class="ot">-&gt;</span> <span class="dt">Number</span>
toVal n <span class="fu">=</span> (<span class="dt">Val</span> n, n)

solve a b c d <span class="fu">=</span> <span class="kw">do</span>
  <span class="kw">let</span> anss <span class="fu">=</span> bfs <span class="dv">10</span> [[toVal a, toVal b, toVal c, toVal d]]
  <span class="kw">if</span> null anss
    <span class="kw">then</span> print <span class="dv">0</span>
    <span class="kw">else</span> print <span class="fu">$</span> fst <span class="fu">$</span> head <span class="fu">$</span> anss

main <span class="fu">=</span> <span class="kw">do</span>
  [a,b,c,d] <span class="ot">&lt;-</span> (map read <span class="fu">.</span> words)<span class="fu">&lt;$&gt;</span>getLine<span class="ot"> ::</span> <span class="dt">IO</span> [<span class="dt">Int</span>]
  <span class="kw">if</span> (minimum [a,b,c,d]) <span class="fu">==</span> <span class="dv">0</span>
    <span class="kw">then</span> return ()
    <span class="kw">else</span> solve a b c d <span class="fu">&gt;&gt;</span> main</code></pre></div>
</body>
</html>
