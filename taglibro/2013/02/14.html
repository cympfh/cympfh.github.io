<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <title>Feb 14 2012</title>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
  </style>
  <link rel="stylesheet" href="../../../resources/css/c.css">
  <link rel="stylesheet" href="../../css/post.css">
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<a href="../../">ğŸ”™ Back to Top</a>
<header>
<h1 class="title">Feb 14 2012</h1>
</header>
<p>ã“ã®æ—¥ä»˜ç®¡ç†ã€ã¡ã‚‡ã£ã¨ä¿¡ç”¨ã§ããªããªã£ã¦ããŸ</p>
<p>ä¸€ã¤ä¸Šã®äººã®å’è«–ç™ºè¡¨ä¼šè¦‹ã«è¡Œã£ãŸï¼ ã‚ã‚“ãªã€èª°ã§ã‚‚è‡ªç”±ã«å…¥ã£ã¦è¦‹èãã§ãã‚‹ã‚«ãƒ³ã‚¸ãªã‚“ã ï¼ æ—¥ä»˜ã¨å ´æ‰€ã•ãˆã€ã©ã“ã‹ã‹ã‚‰èãã¤ã‘ã‚‰ã‚Œã‚Œã°ã€éƒ¨å¤–è€… ã§ã‚‚è¡Œã‘ã‚‹ï¼ä¿®å£«è«–æ–‡ã¨ã‹ã¯çŸ¥ã‚‰ã‚“ã‘ã©ï¼</p>
<p>è‡ªåˆ†ãŒã‚ã®å ´æ‰€ã«ç«‹ã£ã¦ã‚ã‚“ãªã“ã¨ç™ºè¡¨ã™ã‚‹ãªã‚“ã¦ ä¿¡ã˜ã‚‰ã‚Œãªã„ãªï¼ãƒ ãƒªã ã‚ã†ãªï¼ç ”ç©¶å®¤æ¬¡ç¬¬ã ã‚ã†ãª ã¨ã‚‚æ€ã£ãŸï¼</p>
<h2 id="maybeãƒ¢ãƒŠãƒ‰ã‚’schemeã§">Maybeãƒ¢ãƒŠãƒ‰ã‚’schemeã§ï¼</h2>
<p><a href="http://d.hatena.ne.jp/kzk/20050902">Monad in Scheme (2) - moratorium</a> ã®ãƒ‘ã‚¯ãƒªãªã‚“ã ã‘ã©ã€æ€ã„å‡ºã—ãªãŒã‚‰ã§æ›¸ã„ãŸã®ã§ã‚ã£ã¦ã€ä¸¸å†™ã—ã§ã¯ãªã„ã¨ã„ã† æ„å‘³ã§ã€è‡ªåˆ†ã¨ã—ã¦ã¯é‡è¦ãªã®ã§ã€</p>
<div class="sourceCode"><pre class="sourceCode scheme"><code class="sourceCode scheme">(<span class="kw">define</span><span class="fu"> </span>(return x)
    (<span class="kw">lambda</span> (f . rest) (f x rest)))

(<span class="kw">define</span><span class="fu"> </span>(fail . _) (return &#39;Nothing))
(<span class="kw">define</span><span class="fu"> </span>(fail? x)  (<span class="kw">equal?</span> &#39;Nothing x))

(<span class="kw">define</span><span class="fu"> zero </span>(return <span class="dv">0</span>))
(<span class="kw">define</span><span class="fu"> one  </span>(return <span class="dv">1</span>))

(<span class="kw">define</span><span class="fu"> </span>(succ x) (return (<span class="kw">+</span> x <span class="dv">1</span>)))
(<span class="kw">define</span><span class="fu"> </span>(pred x) (return (<span class="kw">-</span> x <span class="dv">1</span>)))

(<span class="kw">define</span><span class="fu"> </span>(&gt;&gt;= x ls)
    (<span class="kw">if</span> (fail? x) (fail)
        (<span class="kw">if</span> (<span class="kw">null?</span> (<span class="kw">cdr</span> ls)) ((<span class="kw">car</span> ls) x)
            (apply ((<span class="kw">car</span> ls) x) (<span class="kw">cdr</span> ls)) )))

(<span class="kw">define</span><span class="fu"> </span>(M m)
    (<span class="kw">define</span><span class="fu"> </span>(f x _) x)
    (m f))</code></pre></div>
<hr />
<h2 id="ç›®æ¬¡">ç›®æ¬¡ï¼</h2>
<ul>
<li>ç§ã®æŒã£ã¦ã„ã‚‹ãƒ¢ãƒŠãƒ‰ã«å¯¾ã™ã‚‹çŸ¥è­˜</li>
<li>å®Ÿè£… ã¾ã§ã®ã‚¹ã‚±ãƒƒãƒ</li>
<li>éŠã‚“ã§ã¿ã‚‹</li>
</ul>
<h3 id="ç§ã®æŒã£ã¦ã„ã‚‹ãƒ¢ãƒŠãƒ‰ã«å¯¾ã™ã‚‹çŸ¥è­˜">ç§ã®æŒã£ã¦ã„ã‚‹ãƒ¢ãƒŠãƒ‰ã«å¯¾ã™ã‚‹çŸ¥è­˜</h3>
<p>Maybeãƒ¢ãƒŠãƒ‰ã‚’æ§‹æˆã™ã‚‹ã®ã¯ã€return ã¨ &gt;&gt;= , ã‚ã¨æœ€å¾Œã«ä¸­èº«ã‚’å‡ºã™ç‚ºã® M. ã‚ã¨å¤±æ•—ã‚’è¡¨ã™ç‚ºã® fail ã¨ fail ã§ã‚ã‚‹ã‹ã‚’åˆ¤å®šã™ã‚‹è¿°èª fail?.</p>
<p>Mã¨ã„ã†ã®ã¯ã€ä¾‹ãˆã° (return 1) ã¯1ã‚’ä½•ã‹ã§åŒ…ã‚“ã§ã„ã‚‹ï¼ä¸­èº«ã®1ã‚’ã‚€ãå‡ºã—ã« ã™ã‚‹ã‚‚ã®ï¼</p>
<p>GHCiã§å®Ÿé¨“ã—ã¦ã¿ã‚‹ã¨</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="dt">Prelude</span><span class="fu">&gt;</span> return <span class="dv">1</span>
<span class="dv">1</span></code></pre></div>
<p>ã‚ã€ã“ã†è¡¨ç¤ºã•ã‚Œã‚‹ã‚“ã ï¼</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="dt">Prelude</span><span class="fu">&gt;</span> <span class="kw">let</span> a <span class="fu">=</span> return <span class="dv">1</span>

<span class="fu">&lt;</span>interactive<span class="fu">&gt;:</span><span class="dv">20</span><span class="fu">:</span><span class="dv">9</span><span class="fu">:</span>
    <span class="dt">Ambiguous</span> <span class="kw">type</span> variable <span class="ot">`m0&#39; in the constraint:</span>
<span class="ot">      (Monad m0) arising from a use of `</span>return&#39;
  <span class="dt">Probable</span> fix<span class="fu">:</span> add a <span class="kw">type</span> signature that fixes these <span class="kw">type</span> variable(s)
  <span class="dt">In</span> the expression<span class="fu">:</span> return <span class="dv">1</span>
  <span class="dt">In</span> an equation for <span class="ot">`a&#39;: a = return 1</span></code></pre></div>
<p>å˜ã« return 1 ã§ã¯ä½•ã®ãƒ¢ãƒŠãƒ‰ãªã®ã‹ã‚ã‹ã‚‰ãªã„ã®ã§ã€å‹ã‚’ä¸ãˆã‚‹ï¼ ã„ã‚ã‚†ã‚‹æ–‡è„ˆã£ã¦ã‚„ã¤ã ã‚ˆã­ï¼Ÿï¼Ÿ</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="dt">Prelude</span><span class="fu">&gt;</span> <span class="kw">let</span> a <span class="fu">=</span> return <span class="dv">1</span><span class="ot"> ::</span> <span class="dt">Maybe</span> <span class="dt">Int</span>
<span class="dt">Prelude</span><span class="fu">&gt;</span> a
<span class="dt">Just</span> <span class="dv">1</span>

<span class="dt">Prelude</span><span class="fu">&gt;</span> <span class="kw">let</span> a <span class="fu">=</span> return <span class="dv">1</span><span class="ot"> ::</span> [<span class="dt">Int</span>]
<span class="dt">Prelude</span><span class="fu">&gt;</span> a
[<span class="dv">1</span>]</code></pre></div>
<p>( :: Maybe Int) ã¨ã„ã†ä¿®é£¾å­ã®ã¤ã‚‚ã‚Šã§ã€M ã¯å®šç¾©ã—ãŸï¼</p>
<p>ãã—ã¦ã€ã©ã®ã‚ˆã†ã«å®Ÿè¡Œã•ã‚Œã‚‹ã¹ãã‹ï¼ã“ã“ã‹ã‚‰ã¯Schemeã®ã‚³ãƒ¼ãƒ‰ã§æ›¸ãï¼ ä»¥ä¸‹ã¯å®Ÿéš›ã«goshã§å®Ÿé¨“ã—ãŸçµæœã ã‘ã©ã€ã¯ã˜ã‚ã«æƒ³å®šã—ã¦ã„ãŸé€šã‚Šã ï¼</p>
<div class="sourceCode"><pre class="sourceCode scheme"><code class="sourceCode scheme">gosh&gt; (return <span class="dv">1</span>)
#&lt;closure&gt;
gosh&gt; (M (return <span class="dv">1</span>))
<span class="dv">1</span>
gosh&gt; (M ( (return <span class="dv">1</span>) &gt;&gt;= (^x (return <span class="dv">2</span>)) ))
<span class="dv">2</span>
gosh&gt; (M ( (return <span class="dv">1</span>) &gt;&gt;= (^x (return <span class="dv">2</span>)) &gt;&gt;= (^x (return <span class="dv">3</span>)) ))
<span class="dv">3</span></code></pre></div>
<p>Så¼ã§ã€å¾‹å„€ã«æ›¸ãã®ãªã‚‰ã€bindã¯</p>
<div class="sourceCode"><pre class="sourceCode scheme"><code class="sourceCode scheme">(&gt;&gt;= (&gt;&gt;= (return <span class="dv">1</span>) (^x (return ...))) &gt;&gt;= (^x (return ...)))</code></pre></div>
<p>ã¨æ›¸ãã¹ãã ï¼ã¤ã¾ã‚Š</p>
<div class="sourceCode"><pre class="sourceCode scheme"><code class="sourceCode scheme">(<span class="kw">define</span><span class="fu"> </span>(&gt;&gt;= m f) ... )</code></pre></div>
<p>ã¨ã•ã‚Œã‚‹ã¹ãã§ å®Ÿéš›ã€ <a href="http://howm.sourceforge.jp/cgi-bin/hiki/hiki.cgi?Monad">howm wiki - ãƒ¢ãƒŠãƒ‰</a> ã“ã“ã§ã®å®Ÿè£…ã§ã¯ãã†ãªã£ã¦ãŸï¼</p>
<p>ã¯ã˜ã‚ã«ã‚‚æŒ™ã’ãŸæ–¹ã® <a href="http://d.hatena.ne.jp/kzk/20050902">Monad in Scheme (2) - moratorium</a> ã§ã¯ã€</p>
<pre><code>(m &gt;&gt;= f &gt;&gt;= g &gt;&gt;= h ...)</code></pre>
<p>ã¨ã„ã†æ›¸ãæ–¹ã‚’æƒ³å®šã—ã¦ãŠã‚Šã€ãªã‚“ã ã‹ã¨ã¦ã‚‚ã‹ã£ã“ã„ã„ï¼ ã‹ã£ã“ã‚ˆã™ãã¦ç§ã¯ãã®è¨˜äº‹ã§ã®ãƒ¢ãƒŠãƒ‰ã®å®Ÿè£…ã‚’ãƒãƒ¼ãƒˆã«æ›¸ãã¾ãã£ãŸï¼</p>
<p>äººé–“ã®ä½“ã¯å¤œãµã‹ã—ãŒã§ãã‚‹ã‚ˆã†ã«ãªã£ã¦ã„ã¦ã€ã¤ã¾ã‚Šã€ä¸€æ—¥ã®å‘¨æœŸãŒ24æ™‚é–“ã‚ˆã‚Šã‚‚é•·ã„ ã¨ã„ã†ã“ã¨ãŒã‚ˆãçŸ¥ã‚‰ã‚Œã¦ã„ã¦ã€ã ã‹ã‚‰å¾Œã‚ã¸ãšã‚‰ã™ã“ã¨ãŒå®¹æ˜“ãªã®ã§ã‚ã‚‹ï¼é€†ã« å‰ã«ãšã‚‰ã™ã“ã¨ã¯å‡ºæ¥ãªã„ã‘ã‚Œã©ï¼ç§ã¯ã“ã®ä¸€é€±é–“ã§ã‚ºãƒ©ã—ã¾ãã£ãŸçµæœã€æ˜¼ã®12æ™‚éãã« å¯ã¦å¤œä¸­ã®1æ™‚ã«èµ·ããŸï¼ç¡çœ æ™‚é–“ã ã‘ã¯ç›¸å¤‰ã‚ã‚‰ãšã§ã‚ã‚‹ï¼å¤–ã‚‚ãã‚ãã‚ç™½ã‚“ã§ãã¦ ãµã¨æ€ã„å‡ºã—ãŸã®ã§ã€ã‚ã®ãƒ¢ãƒŠãƒ‰ã®å®Ÿè£…ã‚’æ€ã„å‡ºã—ãªãŒã‚‰ã€æ€ã„å‡ºã›ãªã„éƒ¨åˆ†ã¯ ãªã‚“ã¨ã—ã¦ã‚‚è‡ªåˆ†ä¸€äººã®ç™ºæƒ³ã§è£œã£ã¦ã‚„ã‚ã†ã¨ã—ã¦æ›¸ã„ãŸã®ã ã£ãŸï¼</p>
<pre><code>(m &gt;&gt;= f &gt;&gt;= g)</code></pre>
<p>ã¾ã§ã§ãã‚Œã°ã€ãã£ã¨</p>
<pre><code>(m &gt;&gt;= f &gt;&gt;= g &gt;&gt;= h)</code></pre>
<p>ã¯è‡ªç„¶ã¨ã§ãã¦ã„ã‚‹ã ã‚ã†ï¼ã§ã‚‚å–ã‚Šæ•¢ãˆãšã¯ç°¡å˜ã«</p>
<pre><code>(m &gt;&gt;= f)</code></pre>
<p>ã‹ã‚‰è€ƒãˆã‚‹ã¹ãã ã£ãŸï¼åçœã ï¼ãŠã‹ã’ã§æ™‚é–“ãŒã‹ã‹ã£ãŸï¼</p>
<p>failã¯ä¸€ç•ªæœ€å¾Œã«å®Ÿè£…ã—ãŸï¼ã»ã‚“ã®å°‘ã—ã®ä¿®æ­£ã§ã™ã‚“ã ï¼failã¯ã“ã®ã‚ˆã†ã«å‹•ãã¹ãï¼</p>
<pre><code>gosh&gt; (M ( (return 1) &gt;&gt;= fail &gt;&gt;= (^x (return 3)) ))
Nothing</code></pre>
<p>ã¤ã¾ã‚Šã€failã®ã‚ã¨ã«å®Ÿè¡Œã•ã‚Œã‚‹ã‚‚ã®ã¯return ã®çµæœã«ã¯å½±éŸ¿ã‚’ä¸ãˆãªã„ï¼ å§‹ã‚ã®å¼•æ•°è©•ä¾¡ã®æ™‚ä»¥å¤–ã€è©•ä¾¡ã•ã‚Œã‚‹ã“ã¨ã‚‚ãªã„ï¼</p>
<h3 id="å®Ÿè£…-ã¾ã§ã®ã‚¹ã‚±ãƒƒãƒ">å®Ÿè£… ã¾ã§ã®ã‚¹ã‚±ãƒƒãƒ</h3>
<p>ç§ãŒæ€ã„å‡ºã™ãŸã‚ã«ã€è£ç´™ã«æ›¸ãã¾ãã£ãŸãƒ©ãƒ ãƒ€å¼ã‚’å†™ã™ã¨ã¨ã‚‚ã«ã€ç²¾ä¸€æ¯ ä½•ã‚’è€ƒãˆã¦ãŸã®ã‹ã‚’è¨€è‘‰ã«ã—ãŸï¼</p>
<div class="sourceCode"><pre class="sourceCode scheme"><code class="sourceCode scheme">(<span class="kw">define</span><span class="fu"> </span>(return x)</code></pre></div>
<p>xã‚’åŒ…ã‚“ã ã‚‚ã®ã‚’è¿”ã™ï¼ã‚ˆãã‚ã‚‹ã®ã¯ã€ãƒ­ãƒ¼ã‚«ãƒ«å¤‰æ•°ã¨ã—ã¦å®šç¾©ã—ã¦ã‚„ã‚‹ã“ã¨ï¼ã™ãªã‚ã¡</p>
<div class="sourceCode"><pre class="sourceCode scheme"><code class="sourceCode scheme">(<span class="kw">lambda</span> (f) (f x))</code></pre></div>
<p>ã“ã®ã‚ˆã†ãªãƒ©ãƒ ãƒ€å¼ã‚’returnã¯è¿”ã™ï¼</p>
<p>ä¼¼ãŸã‚‚ã®ã¨ã—ã¦</p>
<div class="sourceCode"><pre class="sourceCode scheme"><code class="sourceCode scheme">(<span class="kw">define</span><span class="fu"> </span>(my-cons x y)
    (<span class="kw">lambda</span> (f) (f x y)))</code></pre></div>
<p>ã¨ã„ã†ã®ãŒã‚ã£ãŸï¼ã“ã‚Œã¯å®šç•ªã ã‚ã†ï¼my-consã«å¯¾ã—ã¦my-car, my-cdr ã¯ç°¡å˜ã ï¼</p>
<p>cons ã«å¯¾ã—ã¦car, cdr ãŒã‚ã‚‹ã‚ˆã†ã«ã€ãã£ã¨ return ã«å¯¾ã—ã¦ã¯ M ã§ã‚ã‚ã†ï¼ Mã¯return ãŒåŒ…ã‚“ã ã‚‚ã®ã‚’ã²ã‚“å‰¥ãã‹ã‚‰ï¼</p>
<div class="sourceCode"><pre class="sourceCode scheme"><code class="sourceCode scheme">(<span class="kw">define</span><span class="fu"> </span>(M m) <span class="co">; m &lt;- (return 1)</span>
    (m (<span class="kw">lambda</span> (x) x)))</code></pre></div>
<p>ç°¡å˜ã ï¼</p>
<p>ãã—ãŸã‚‰ã€bindã•ãˆæ›¸ã‘ã‚Œã°ã€å®Ÿè³ªçµ‚ã‚ã‚Šï¼ ã„ããªã‚Šä½•ã‚’æ›¸ã„ãŸã‚‰ã„ã„ã®ã‹åˆ†ã‹ã‚‰ãªã„ã®ã§ã€ã“ã†ãªã‚‹ã¹ãã ã¨ã„ã†ãƒ™ãƒ¼ã‚¿ç°¡ç´„ã®æ§˜å­ ã‚’æ›¸ã„ãŸï¼</p>
<div class="sourceCode"><pre class="sourceCode scheme"><code class="sourceCode scheme">((return <span class="dv">1</span>) &gt;&gt;= (^x (return <span class="dv">2</span>)))
 -&gt; (&gt;&gt;= <span class="dv">1</span> (<span class="kw">list</span> (^x (return <span class="dv">2</span>))))
 -&gt; ((^x (return <span class="dv">2</span>)) <span class="dv">1</span>)
 -&gt; (return <span class="dv">2</span>)</code></pre></div>
<p>ã“ã®èª¿å­ã«ã€&gt;&gt;=ã‚’ã‚‚ã†ã²ã¨ã¤ä¸¦ã¹ã‚‹</p>
<div class="sourceCode"><pre class="sourceCode scheme"><code class="sourceCode scheme">(return <span class="dv">1</span>) &gt;&gt;= (^x (return <span class="dv">2</span>)) &gt;&gt;= (^x (return <span class="dv">3</span>))
 -&gt; (&gt;&gt;= <span class="dv">1</span> (<span class="kw">list</span> (^x (return <span class="dv">2</span>)) &gt;&gt;= (^x (return <span class="dv">3</span>))))
 -&gt; ((return <span class="dv">2</span>) &gt;&gt;= (^x (return <span class="dv">3</span>)))</code></pre></div>
<p><code>&gt;&gt;=</code> ã‚’ä¸­ç½®ã§è¨˜æ³•ã™ã‚‹ãŸã‚ã«</p>
<p><code>(return 1) &gt;&gt;= ..</code> ãŒ <code>(&gt;&gt;= 1 ..)</code></p>
<p>ã®ã‚ˆã†ã«ãªã£ã¦ã€ãã—ã¦</p>
<p><code>(&gt;&gt;= 1 ls)</code> ã¯ã€</p>
<div class="sourceCode"><pre class="sourceCode scheme"><code class="sourceCode scheme">(let1 op (<span class="kw">car</span> ls)
  (apply (op ls <span class="dv">1</span>) ls))</code></pre></div>
<p>ã¨ãªã£ã¦ã»ã—ã„ï¼returnã¯ä»Šã¾ã§1å¼•æ•°ã‚’å–ã‚‹ã‚ˆã†ãªãƒ©ãƒ ãƒ€å¼ã‚’è¿”ã™ã“ã¨ã«ã—ã¦ãŸã‘ã©ã€ ã“ã“ã§ (&gt;&gt;= ..)ã¨ã„ã†è¤‡æ•°ã®å€¤ã‚’æ¸¡ã™ã“ã¨ã§&gt;&gt;=ã‚’å®Ÿè¡Œã•ã›ã‚‹ã®ã§ã€æ›¸ãæ›ãˆãŒå¿…è¦ã ï¼</p>
<div class="sourceCode"><pre class="sourceCode scheme"><code class="sourceCode scheme">(<span class="kw">define</span><span class="fu"> </span>(return x)
    (<span class="kw">lambda</span> (f . rest) (f x rest)))</code></pre></div>
<p>ã“ã‚Œã§ã€ <code>((return 1) &gt;&gt;= (^x ...))</code> ã¯ <code>(&gt;&gt;= 1 ((^x ..)))</code> ã¨ãªã£ãŸï¼&gt;&gt;= ã¸ã®ç¬¬äºŒå¼•æ•°ã¯ãƒªã‚¹ãƒˆã§ã‚ã‚‹ã®ã«æ³¨æ„ï¼</p>
<div class="sourceCode"><pre class="sourceCode scheme"><code class="sourceCode scheme">(<span class="kw">define</span><span class="fu"> </span>(&gt;&gt;= x ls)
    (apply
        ((<span class="kw">car</span> ls) x)
        (<span class="kw">cdr</span> ls)))</code></pre></div>
<p>ã“ã‚Œã§ <code>(&gt;&gt;= 1 ((^x ..)))</code> ã¯ <code>(apply ((^x ..) 1) '())</code> ã¨ãªã‚‹ï¼ applyã¸ã®ç¬¬äºŒå¼•æ•°ã¯æ®‹ã‚Šã® <code>'(&gt;&gt;= (^x ...))</code> ãŒå…¥ã‚‹äºˆå®šã ã£ãŸãŒ&gt;&gt;= ä¸€ã¤ã ã‘ã® ä¸¦ã³ã ã¨ç©ºã«ãªã‚‹ï¼ã“ã®ã¨ãapplyã¯ã‚¨ãƒ©ãƒ¼ã‚’å‡ºã™ï¼null?ã§åˆ†å²ãŒå¿…è¦ã ã£ãŸï¼</p>
<p>ç§ã¨ã—ã¦ã¯ã€æ€ã„å‡ºã™ã¹ãã“ã¨ã¯ã€ã“ã‚Œã§ã²ã¨é€šã‚Šå…¨ã¦æ€ã„å‡ºã›ãŸï¼</p>
<p><code>(fail)</code> ã¯<code>(return 'Nothing)</code> ã¨ã™ã‚‹ã ã‘ã ã—ã€ è¿°èª <code>(define fail? (pa$ equal 'Nothing))</code> ã‚’ç”¨æ„ã—ã¦ã‚„ã‚Œã°ã€ &gt;&gt;= ã®ä¸­ã§ã€ã¾ãš <code>(&gt;&gt;= x ls)</code> ã® <code>x</code> ã«ã¤ã„ã¦ <code>fail?</code> ã—ã¦ <code>#t</code> ã ã£ãŸã‚‰ <code>(fail)</code> ã‚’ è¿”ã—ã¦ã‚„ã‚‹ï¼</p>
<p>ä»¥ä¸Šã§ã§ããŸã“ã¨ã«ãªã‚‹ï¼</p>
<h3 id="éŠã‚“ã§ã¿ã‚‹">éŠã‚“ã§ã¿ã‚‹</h3>
<div class="sourceCode"><pre class="sourceCode scheme"><code class="sourceCode scheme">gosh&gt; zero
#&lt;closure (return return)<span class="kw">&gt;</span>
gosh&gt; (M zero)
<span class="dv">0</span>
gosh&gt; (M one)
<span class="dv">1</span>
gosh&gt; succ
#&lt;closure succ&gt;
gosh&gt; pred
#&lt;closure pred&gt;
gosh&gt; (M (one &gt;&gt;= succ))
<span class="dv">2</span>
gosh&gt; (M (one &gt;&gt;= succ &gt;&gt;= succ))
<span class="dv">3</span>
gosh&gt; (M (one &gt;&gt;= succ &gt;&gt;= fail &gt;&gt;= succ))
Nothing

gosh&gt; (<span class="kw">define</span><span class="fu"> </span>(find x)
(let1 result (<span class="kw">assoc</span> x &#39;((<span class="dv">1</span> . minamike) (<span class="dv">3</span> . okaeri) (<span class="dv">4</span> . tadaima)))
(<span class="kw">if</span> result ($ return $ <span class="kw">cdr</span> result) (fail)) ))
find
gosh&gt; (M (one &gt;&gt;= find))
minamike
gosh&gt; (M (one &gt;&gt;= succ &gt;&gt;= find))
Nothing
gosh&gt; (M (one &gt;&gt;= succ &gt;&gt;= succ &gt;&gt;= find))
okaeri
gosh&gt; (M (one &gt;&gt;= succ &gt;&gt;= succ &gt;&gt;= pred &gt;&gt;= find))
Nothing</code></pre></div>
<p>ãƒ¢ãƒŠãƒ‰ã¯é€”ä¸­ã§å¤±æ•—ã™ã‚‹ã£ã¦ã„ã†äº‹ä¾‹ã‚’è¦‹ã›ã‚‹ãã‚‰ã„ã§ã—ã‹ æœ‰ç”¨æ€§ã‚’ç¤ºã›ãªã„ã‚ˆã­ï¼ãã‚Œã§ãŸã„ã¦ã„ã¿ã‚“ãªã‚¼ãƒ­ã§å‰²ã‚‹ã‚ˆã­ï¼</p>
</body>
</html>
