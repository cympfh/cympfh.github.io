<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="unidoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <title>大数の法則</title>
  <style type="text/css">code{white-space: pre;}</style>
  <link rel="stylesheet" href="https://cympfh.cc/resources/css/youtube.css" />
  <link href="https://unpkg.com/prismjs@1.x.0/themes/prism.css" rel="stylesheet" />
  <script id="MathJax-script" async src="https://unpkg.com/mathjax@3/es5/tex-svg-full.js"></script>
  <link href="../resources/css/c.css" rel="stylesheet" />
  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" />

</head>
<body>
<header class="page-header">
    <a href='index.html'><i class="fa fa-stumbleupon"></i></a>
</header>

<h1 class="title" id="1-大数の法則">大数の法則</h1>
<p><p class=date style='text-align: right'>2019-12-15 (Sun.), 2020-01-07 (Tue.)</p> <div class='is-pulled-right'> <a class='tag is-red' href=index.html#確率論>確率論</a> <a class='tag is-red' href=index.html#測度論>測度論</a> </div></p>
<p>\(\def\F{\mathcal{F}}\def\R{\mathbb{R}}\def\BR{\mathcal{B}(\mathbb{R})}\def\RX{\mathbb R_X}\)</p>
<h2 id="2-確率変数">確率変数</h2>
<p><a href="probability.html">確率空間</a> \((\Omega, \F, P)\) について, 関数 \(X \colon \Omega \to \R\) が可測であるとき, これを確率変数だという. 関数が可測であるとはすなわち, 任意の実数 \(a\) について,</p>
\[[X &gt; a] \equiv \{ \omega \in \Omega \mid X \omega &gt; a \}\]
<p>が \(\F\) に属する（つまり可測空間である）こと. ちなみに \([X &gt; a]\) の代わりに \([X \geq a]\) とか \([X &lt; a]\) とかを使っても同値である.</p>
<p>\(X\) の像 \(\{ X\omega \mid \omega \in \Omega \} (\subset \R)\) を \(\RX\) と書く.</p>
<h3 id="3-確率変数の分布">確率変数の分布</h3>
<p>確率変数 \(X\) に対してその分布を \(\mu_X\) と書くが, これは次のような関数 \(\RX \to \R\) .</p>
\[\mu_X(a) = P(X = a) = P \{ \omega \in \Omega \mid X \omega = a \}\]
<p>以下で確率空間は固定して考える.</p>
<h2 id="2-確率変数の独立性">確率変数の独立性</h2>
<p>加算無限個の確率変数</p>
\[X_1, X_2, \ldots\]
<p>について次が成り立つ時, これらは <strong>独立</strong> であるという.</p>
<p>実数の上のボレル集合族 \(\BR\) の任意の集合 （要は加算無限個の開区間を和積差で組み合わせて出来る集合）</p>
\[E_1, E_2, \ldots \in \BR\]
<p>に対して</p>
\[P(X_1 \in E_1, X_2 \in E_2, \ldots) = \prod_i P(X_i \in E_i)\]
<p>が成り立つ.</p>
<p>念の為に補足すると, 左辺は \(\{ \omega \in \Omega \mid X_1(\omega) \in E_1 \land X_2(\omega) \in E_2 \land \cdots \}\) の確率測度で, 右辺は個々 \(\{ \omega \in \Omega \mid X_i(\omega) \in E_i \}\) の確率測度の積.</p>
<h2 id="2-期待値、分散">期待値、分散</h2>
<p>確率変数 \(X\) の <strong>期待値</strong> を次で定義してそれを \(EX\) と書く.</p>
\[EX = \int_\Omega X \, dP\]
<p>特に \(P\) が離散であれば \(EX = \sum_{\omega \in \Omega} X \omega \times P(\omega)\) と書ける.</p>
<p>確率変数 \(X\) の <strong>分散</strong> を次で定義しそれを \(VX\) と書く.</p>
\[VX = E (X - EX)^2\]
<h3 id="3-性質">性質</h3>
<ul>
  <li>\(E(aX + b) = a EX + b \; (a, b \in \R)\)</li>
  <li>\(V(aX + b) = a^2 VX \; (a, b \in \R)\)</li>
  <li>\(VX = E(X^2) - (EX)^2\)</li>
</ul>
<p>独立であるが同じ分布を持つ（このことを iid と言う） \(X_1, X_2, \ldots, X_n\) を考える. これについて次が成り立つ.</p>
<ul>
  <li>\(E (\sum_i X_i) = \sum_i E X_i\)</li>
  <li>\(E (\prod X_i) = \prod_i E X_i\)</li>
  <li>\(V (\sum_i X_i) = \sum_i V X_i\)</li>
</ul>
<h2 id="2-マルコフの不等式">マルコフの不等式</h2>
<p>確率変数 \(X\) について次が成り立つ.</p>
\[\forall \epsilon &gt; 0, P(|X| &gt; \epsilon) \leq \frac{1}{\epsilon} E |X|\]
<h3 id="3-証明">証明</h3>
<p>\(A = [ |X| &gt; \epsilon ] \subset \Omega\) と置くと \(E |X| = \int_\Omega |X| \, dP \geq \int_A |X| \, dP \geq \int_A \epsilon \, dP = \epsilon \times P(A)\) より従う.</p>
<h2 id="2-チェビシェフの不等式">チェビシェフの不等式</h2>
\[\forall \epsilon &gt; 0, P(|X - EX| &gt; \epsilon ) \leq \frac{1}{\epsilon^2} VX\]
<h3 id="3-証明">証明</h3>
<p>マルコフの不等式と全く同様. \(A = \left[ |X-EX| &gt; \epsilon \right] \subset \Omega\) と置いて, \(VX = E(X-EX)^2 \geq \int_A (X-EX)^2 \, dP \geq \epsilon^2 \times P(A)\) から従う.</p>
<h2 id="2-確率変数の収束">確率変数の収束</h2>
<p>確率変数の列 \(\{ X_i \}_{i=1,2,\ldots}\) の収束を次の二通りで定義する.</p>
<h3 id="3-確率収束">確率収束</h3>
<p>次が成り立つとき, \(\{X_i\}\) は \(X\) に確率収束するという.</p>
\[\forall \epsilon &gt; 0, \lim_{n \to \infty} P(|X_n - X| &gt; \epsilon) = 0\]
<h3 id="3-概収束 (almost surely convergence)">概収束 (almost surely convergence)</h3>
<p>一般に、確率変数 \(X\) に関するある命題 \(\Phi(X)\) が成立する確率が 1 のとき, 「 <strong>ほとんど確実に</strong> \(\Phi(X)\) は成立する」と言い、「 \(\Phi(X)\) a.s.」と書く. ここで "a.s." は almost surely の略.</p>
<p><strong>ほとんど確実に</strong> 確率変数の列 \(X_i\) が \(X\) に収束すること</p>
\[P(\lim_i X_i = X) = 1\]
<p>を <strong>概収束</strong> という.</p>
<p>一般に「概収束 \(\implies\) 確率収束」は成り立つ. つまり概収束のほうが確率収束より強い.</p>
<h2 id="2-大数の法則">大数の法則</h2>
<p>iid な \(X_1, X_2, \ldots\) を考える. 分布が等しいので \(m=E X_i\) と置いておく. 期待値 \(m\) も分散 \(VX_i\) も（発散せず）値を定めるとする. \(n\) 個の平均</p>
\[Y_n = \frac{1}{n} \left( X_1 + X_2 + \cdots + X_n \right)\]
<p>は \(n \to \infty\) のとき \(m\) に収束する.</p>
<p>この収束の仕方として確率収束を言うのを「弱法則」、ほとんど確実収束を言うのを「強法則」という.</p>
<h3 id="3-弱法則の証明">弱法則の証明</h3>
<p>\(\lim_n P(Y_n &gt; \epsilon) = 0\) が成り立つことを言う.</p>
<p>まず先に確認することとして, \(EY_n = E(\frac{1}{n} \sum X_i) = m\) ,</p>
\[\begin{align*}
VY_n &amp; = E(Y_n)^2 - (EY_n)^2 \\
&amp; = \frac{1}{n^2} E(\sum_i X_i)^2 - m^2 \\
&amp; = \frac{1}{n^2} E(\sum_i X_i^2 + \sum_{i \ne j} X_i X_j) - m^2 \\
&amp; = \frac{1}{n^2} E(n X_i^2 + n(n-1) X_i X_j) - m^2 \\
&amp; = \frac{1}{n} E(X_i^2 - m^2) \\
&amp; = \frac{1}{n} VX_i \\
\end{align*}\]
<blockquote>\(i \ne j\) について \(E(X_i X_j) = m^2\) としたところに, 独立性を利用している</blockquote>
<p>チェビシェフの不等式によれば,</p>
\[\begin{align*}
P(|Y_n - m| &gt; \epsilon) &amp; \leq \frac{1}{\epsilon^2} VY_n \\
&amp; = \frac{1}{n\epsilon^2} VX_i \\
\end{align*}\]
<p>最後の右辺は \(n \to \infty\) のとき \(\to 0\) なので, \(\lim_n P(Y_n &gt; \epsilon) = 0\) が言えた.</p>
<h3 id="3-（条件付きの）強法則の証明">（条件付きの）強法則の証明</h3>
<p>\(E(X_i^4)\) の値（この値を4次モーメントという）が無限大に発散せずに値を定めると仮定したときに, \(P(\lim_n Y_n = m) = 1\) であることを示す.</p>
<blockquote>4次モーメントが存在しなくても実はこの法則は成り立つ. もとの \(X_i\) が iid であって期待値が存在しさえすれば本当はいいんだけど, 証明が難しい.</blockquote>
<p>\(E \left( \sum_i (X_i - m) \right)^4\) という値を考える. \(E\) の線形性から, 和について分解することを考える. このときに, \(E (X_i - m) (X_j - m)^3\) といった値は \(i \ne j\) とするとその独立性より \(E (X_i - m) \times E(X_j-m)^3\) に等しく, \(E (X_i-m)=0\) よりゼロである. 従って結局残るのは \(E(X_i-m)^4\) という項と, \(E(X_i-m)^2(X_j-m)^2\) という項だけ. このことに注目すると,</p>
\[\begin{align*}
E \left( \sum_i (X_i - m) \right)^4
&amp; = n E(X_i-m)^4 +
\left( \begin{array}{cc} 4 \\ 2\end{array} \right)
\left( \begin{array}{cc} n \\ 2\end{array} \right)
E(X_i-m)^2(X_j-m)^2 \\
&amp; = n E(X_i-m)^4 + 3n(n-1) (E(X_i-m)^2)^2
\end{align*}\]
<p>従って, \(E(Y_n^4) = \frac{1}{n^4} E(X_i-m)^n = o(n^{-2})\) . すなわちある定数 \(C\) があって, \(E(Y_n^4) \leq C&#x2F;n^2\) といえる.</p>
<p>次に列 \(Y_i\) の累積和を考えると, これは次のように収束する. \(E(\sum_{n=1}^\infty Y_n^4) = \sum E Y_n^4 \leq C \sum_i \frac{1}{i^2} &lt; \infty\)</p>
<p>さてここで次の補題を主張する.</p>
<h4 id="4-補題">補題</h4>
<p>iid な \(X_i\) について,</p>
\[\sum_i E|X_i| &lt; \infty \implies P(\sum_i |X_i| &lt; \infty) = 1.\]
<p>絶対値を取ってるのは単に、正の確率変数であることを約束させるために過ぎない. 甘んじて \(\sum_i E|X_i| = E(\sum_i |X_i|)\) であることまでは認めてもらうと, \(A = [ \sum_i |X_i| &lt; \infty ] \subset \Omega\) とおいて \(\sum_i E|X_i| = \int_A |X_i| \, dP + \int_{\Omega \setminus A} |X_i| \, dP
\geq \int_{\Omega \setminus A} |X_i| \, dP
= P(\Omega \setminus A) \times \infty\) なので, \(P(\Omega \setminus A)=0\) でなければならない. 従って \(P(A)=1\) .</p>
<p>この補題を \(|X_n| = Y_n^4\) として適用すると,</p>
\[P(\sum_n Y_n^4 &lt; \infty) = 1\]
<p>が言えた.</p>
<p>数列 \({Y_n^4}\) が非減少単調列でこれの累積和が概収束するので,</p>
\[P(\lim_n Y_n^4 = 0) = 1\]
<p>が言えた. 従って</p>
\[\lim_{n \to \infty} Y_n = 0 ~~~ a.s.\]
<p>であることも明らか.</p>

<!--

  以下を埋め込むと H2 タグを列挙してそれぞれへのリンクにする.
  ただし "INDEX" は除外する.

    <div id=toc></div>


  H2, H3 タグまでを列挙するには以下を埋め込む.

    <div id=toc-level-2></div>

-->
<script>
(function() {

  function naming(obj, name) {
      var PREF = document.createElement('a');
      PREF.name = name;
      obj.appendChild(PREF);
  }

  function level1() {

    var sections = document.getElementsByTagName('h2');
    var OL = document.createElement('ol');
    for (var i=0; i < sections.length; ++i) {
      var LI = document.createElement('li');
      var A = document.createElement('a');
      A.innerHTML = sections[i].innerHTML;
      if (A.innerHTML.toUpperCase() == 'INDEX') continue;
      A.href = '#' + i;
      LI.appendChild(A);
      OL.appendChild(LI);
      naming(sections[i], i);
      // var PREF = document.createElement('a');
      // PREF.name = i;
      // sections[i].appendChild(PREF);
    }

    return OL;
  }

  function level2() {

    var sections = document.querySelectorAll('h2,h3');
    var tree = [];
    for (var i = 0; i < sections.length; ++i) {
      if (sections[i].tagName == 'H2') {
        if (sections[i].innerHTML.toUpperCase() === 'INDEX') continue;
        tree.push([sections[i]]);
      } else {
        if (tree.length > 0) {
          tree[tree.length-1].push(sections[i]);
        } else {
          tree.push([sections[i]]);
        }
      }
    }

    var OL = document.createElement('ol');
    for (var i = 0; i < tree.length; ++i) {

      // h2-level
      var LI = document.createElement('li');
      var A = document.createElement('a');
      A.innerHTML = tree[i][0].innerHTML;
      A.href = '#' + i;
      naming(tree[i][0], i);
      LI.appendChild(A);

      // h3-level
      if (tree[i].length > 1) {
        var OL_sub = document.createElement('ol');
        for (var j = 1; j < tree[i].length; ++j) {
          var LI_sub = document.createElement('li');
          var A = document.createElement('a');
          A.innerHTML = tree[i][j].innerHTML;
          A.href = `#${i}-${j}`;
          naming(tree[i][j], `${i}-${j}`);
          LI_sub.appendChild(A);
          OL_sub.appendChild(LI_sub);
        }
        LI.appendChild(OL_sub);
      }

      OL.appendChild(LI);
    }

    return OL;
  }

  function append_toc() {
    if (document.getElementById('toc')) {
      document.getElementById('toc').appendChild(level1());
    }
    if (document.getElementById('toc-level-2')) {
      document.getElementById('toc-level-2').appendChild(level2());
    }
  }

  window.addEventListener('DOMContentLoaded', append_toc, false);
}());
</script>

  <script src="https://cympfh.cc/resources/js/youtube.js"></script>
  <script src="https://unpkg.com/prismjs@v1.x/components/prism-core.min.js"></script>
  <script src="https://unpkg.com/prismjs@v1.x/plugins/autoloader/prism-autoloader.min.js"></script>
</body>
</html>