% パターンマッチはNP完全 [D.Angluin 1979]

3-SAT から パターンマッチへの帰着を考える.
即ち、パターンマッチで 3-SAT を解く.

CNFで書かれた $\phi$ がn変数、m節だとする.
便宜上、変数を $x_1, x_2 .. x_n$ とリネームする.

$\phi$ から、文字列 $s$ とパターン $p$ を構築して $s \preceq p$ を解けば 3-SAT が解けるようにする.
登場する変数は

- $u_i, v_i$: $1 \leq i \leq n$
- $c_j, d_j$: $1 \leq j \leq m$

i番目の節から、次のようにしてパターン $p_i$ を作る:

i番目の節は $\{x_i\} \cup \{ \bar{x_i} \}$ の内の3つを or でつないだものである.
節中の $x_i$ を $u_i$ に、$\bar{x_i}$ を $v_i$ に置き換えて3つの変数をつないだものを $p_i$ とする.
(e.g. $(x_1 \lor \bar{x_3} \lor x_5) \Rightarrow u_1 v_3 u_5$).

パターンマッチする文字列$s$ と パターン $p$ を次のように定める.

$$s = (1110)^n \cdot (1^7 0)^m \cdot (1^4 0)^m$$
$$p = \prod_i (u_i v_i 0)^n \cdot \prod_j (p_j c_j 0) \cdot \prod_j (c_j d_j 0)$$

$s$にも$p$にも$0$がちょうど$n+2m$個だけ出現するので、変数には$1$からなる文字列しか入らない.
また、$p_j c_j$ ってのが4変数であることに註意すると、

$u_i, v_i$ は一方が$11$でもう一方が$1$.
$c_j$ は $1$ または $11$ または $111$.

- $u_i$ が $11$ のとき、$x_i = \rm true$,
- $u_i$ が $1$ のとき、$x_i = {\rm false}$.

だとみなして充足問題が解かれる.

全ての $p_j$ について、長さ $1^k (k \geq 4)$ が入れば、正しく充足される.

