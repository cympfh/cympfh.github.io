<!DOCTYPE html>
<html lang="ja">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="unidoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <title>代数 - 超数</title>
  <style type="text/css">code{white-space: pre;}</style>
  <link rel="stylesheet" href="https://cympfh.cc/resources/css/youtube.css" />
  <link href="https://unpkg.com/prismjs@1.x.0/themes/prism.css" rel="stylesheet" />
  <script id="MathJax-script" async src="https://unpkg.com/mathjax@3/es5/tex-chtml-full.js"></script>
<meta name="unibook-theme" content="light">
<style>/* Theme CSS Variables */

:root[data-theme="light"] {
  --bg-primary: #ffffff;
  --bg-secondary: #f4f4f4;
  --bg-hover: #e0e0e0;
  --bg-active: #d0d0d0;
  --text-primary: #333333;
  --text-secondary: #666666;
  --text-tertiary: #999999;
  --border-color: #dddddd;
  --link-color: #0066cc;
  --link-hover: #0052a3;
  --code-bg: #f5f5f5;
  --search-highlight: #ffd700;
}

:root[data-theme="dark"] {
  --bg-primary: #1e1e1e;
  --bg-secondary: #252525;
  --bg-hover: #2d2d2d;
  --bg-active: #383838;
  --text-primary: #e0e0e0;
  --text-secondary: #b0b0b0;
  --text-tertiary: #808080;
  --border-color: #404040;
  --link-color: #6ca0f6;
  --link-hover: #8ab4f8;
  --code-bg: #2d2d2d;
  --search-highlight: #ffa500;
}

:root[data-theme="solarized-light"] {
  --bg-primary: #fdf6e3;
  --bg-secondary: #eee8d5;
  --bg-hover: #e4ddc4;
  --bg-active: #d9d2ba;
  --text-primary: #657b83;
  --text-secondary: #839496;
  --text-tertiary: #93a1a1;
  --border-color: #d3cbb7;
  --link-color: #268bd2;
  --link-hover: #2aa198;
  --code-bg: #eee8d5;
  --search-highlight: #b58900;
}

:root[data-theme="solarized-dark"] {
  --bg-primary: #002b36;
  --bg-secondary: #073642;
  --bg-hover: #0e4853;
  --bg-active: #145561;
  --text-primary: #839496;
  --text-secondary: #93a1a1;
  --text-tertiary: #657b83;
  --border-color: #094451;
  --link-color: #268bd2;
  --link-hover: #2aa198;
  --code-bg: #073642;
  --search-highlight: #b58900;
}

:root[data-theme="kanagawa-light"] {
  --bg-primary: #f2ecbc;
  --bg-secondary: #e5ddb0;
  --bg-hover: #d8d0a0;
  --bg-active: #cbc396;
  --text-primary: #43434f;
  --text-secondary: #625e5a;
  --text-tertiary: #8a8980;
  --border-color: #d0c9a0;
  --link-color: #597b9e;
  --link-hover: #7e9cd8;
  --code-bg: #e5ddb0;
  --search-highlight: #ffa066;
}

:root[data-theme="kanagawa-dark"] {
  --bg-primary: #1f1f28;
  --bg-secondary: #2a2a37;
  --bg-hover: #363646;
  --bg-active: #43434f;
  --text-primary: #dcd7ba;
  --text-secondary: #c8c093;
  --text-tertiary: #a6a384;
  --border-color: #3c3c51;
  --link-color: #7e9cd8;
  --link-hover: #9cabca;
  --code-bg: #2a2a37;
  --search-highlight: #ffa066;
}
</style>
<style>.theme-switcher {
  position: relative;
  margin-bottom: 10px;
  z-index: 2000;
}

.theme-button {
  width: 100%;
  padding: 10px 12px;
  background: var(--bg-primary);
  border: 0px solid var(--border-color);
  border-radius: 5px;
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 14px;
  color: var(--text-secondary);
  transition: all 0.2s;
}

.theme-button:hover {
  background: var(--bg-hover);
  border-color: var(--text-secondary);
  color: var(--text-primary);
}

.theme-button svg {
  flex-shrink: 0;
}

.theme-menu {
  position: absolute;
  top: 100%;
  left: 0;
  right: 0;
  margin-top: 4px;
  background: var(--bg-primary);
  border: 1px solid var(--border-color);
  border-radius: 5px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  z-index: 2001;
  overflow: hidden;
}

.theme-option {
  width: 100%;
  padding: 10px 12px;
  background: none;
  border: none;
  text-align: left;
  cursor: pointer;
  color: var(--text-primary);
  font-size: 14px;
  transition: background 0.2s;
  border-bottom: 1px solid var(--border-color);
}

.theme-option:last-child {
  border-bottom: none;
}

.theme-option:hover {
  background: var(--bg-hover);
}

.theme-option.active {
  background: var(--bg-active);
  font-weight: bold;
}
</style>
<style>.toc-toggle {
  float: left;
  width: 40px;
  height: 40px;
  padding: 10px;
  margin-right: 8px;
  background: var(--bg-primary);
  border: 0px solid var(--border-color);
  border-radius: 5px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--text-secondary);
  transition: all 0.2s;
}

.toc-toggle:hover {
  background: var(--bg-hover);
  border-color: var(--text-secondary);
  color: var(--text-primary);
}

.toc-toggle svg {
  flex-shrink: 0;
}

/* Position theme-switcher next to toc-toggle */
#theme-switcher {
  float: left;
  margin-bottom: 10px;
}

/* Page controls container */
.page-controls {
  margin-bottom: 20px;
}

.page-controls::after {
  content: "";
  display: table;
  clear: both;
}

/* Sidebar hide/show animation */
body.sidebar-hidden #toc-sidebar {
  transform: translateX(-250px);
}

body.sidebar-hidden #content-wrapper {
  margin-left: 0;
}

#toc-sidebar {
  transition: transform 0.3s ease;
}

#content-wrapper {
  transition: margin-left 0.3s ease;
}
</style>
<style>/* Code Copy Button Styling */

.code-block-wrapper {
    position: relative;
    margin: 1em 0;
}

.code-block-wrapper pre {
    margin: 0;
}

.code-copy-button {
    position: absolute;
    top: 8px;
    right: 8px;
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 6px 10px;
    background-color: var(--bg-secondary);
    border: 1px solid var(--border-color);
    border-radius: 4px;
    color: var(--text-secondary);
    font-size: 12px;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica', 'Arial', sans-serif;
    cursor: pointer;
    transition: all 0.2s ease;
    opacity: 0;
    pointer-events: none;
}

.code-block-wrapper:hover .code-copy-button {
    opacity: 1;
    pointer-events: auto;
}

.code-copy-button:hover {
    background-color: var(--bg-hover);
    color: var(--text-primary);
    border-color: var(--text-tertiary);
}

.code-copy-button:active {
    background-color: var(--bg-active);
    transform: scale(0.95);
}

.code-copy-button.success {
    background-color: #10b981;
    border-color: #059669;
    color: #ffffff;
    opacity: 1;
}

.code-copy-button.error {
    background-color: #ef4444;
    border-color: #dc2626;
    color: #ffffff;
    opacity: 1;
}

.code-copy-button svg {
    flex-shrink: 0;
}

.copy-text {
    white-space: nowrap;
}

/* Mobile: Always show the button */
@media (max-width: 768px) {
    .code-copy-button {
        opacity: 0.7;
        pointer-events: auto;
    }

    .code-block-wrapper:hover .code-copy-button {
        opacity: 1;
    }
}
</style>
<style>
body {
  margin: 0;
  padding: 0;
  display: flex;
  background: var(--bg-primary);
  color: var(--text-primary);
  transition: background-color 0.3s, color 0.3s;
}

#toc-sidebar {
  width: 250px;
  position: fixed;
  left: 0;
  top: 0;
  height: 100vh;
  overflow-y: auto;
  background: var(--bg-secondary);
  padding: 20px;
  border-right: 1px solid var(--border-color);
  box-sizing: border-box;
  transition: transform 0.3s ease;
}

#content-wrapper {
  margin-left: 250px;
  padding: 20px 40px;
  max-width: 900px;
  width: 100%;
  box-sizing: border-box;
  background: var(--bg-primary);
  transition: margin-left 0.3s ease;
}

.toc-header h2 {
  margin-top: 0;
  font-size: 1.5em;
  color: var(--text-primary);
}

.search-button {
  width: 100%;
  padding: 10px 12px;
  margin-bottom: 20px;
  background: var(--bg-primary);
  border: 1px solid var(--border-color);
  border-radius: 5px;
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 14px;
  color: var(--text-secondary);
  transition: all 0.2s;
}

.search-button:hover {
  background: var(--bg-hover);
  border-color: var(--text-secondary);
  color: var(--text-primary);
}

.search-button svg {
  flex-shrink: 0;
}

.toc-list {
  list-style: none;
  padding: 0;
  margin: 0;
}

.toc-list li {
  margin: 5px 0;
}

.toc-list > li > a {
  display: block;
  padding: 8px 12px;
  text-decoration: none;
  color: var(--text-primary);
  border-radius: 4px;
  font-weight: 500;
  transition: background 0.2s;
}

.toc-list a:hover {
  background: var(--bg-hover);
}

.toc-list a.current {
  background: var(--bg-active);
  font-weight: bold;
  color: var(--text-primary);
}

/* Part (separator/heading) styling */
.toc-part {
  margin: 20px 0 8px 0;
  padding: 8px 12px;
  font-weight: bold;
  font-size: 0.9em;
  color: var(--bg-primary);
  background: var(--text-primary);
  text-transform: uppercase;
  letter-spacing: 0.5px;
  border-radius: 4px;
}

/* Level 2: 中見出し (Chapter) - opacity 0.8 */
.toc-part-level-2 {
  opacity: 0.8;
}

/* Level 3: 小見出し (Section) - opacity 0.6 */
.toc-part-level-3 {
  opacity: 0.6;
}

/* Child page indentation */
.toc-page-child {
  font-size: 0.95em;
}

.toc-page-indent-1 {
  padding-left: 16px !important;
}

.toc-page-indent-2 {
  padding-left: 24px !important;
}

.toc-page-indent-3 {
  padding-left: 32px !important;
}

/* Section (H2) styling */
.toc-sections {
  list-style: none;
  padding: 0;
  margin: 4px 0 0 0;
}

.toc-sections li {
  margin: 2px 0;
}

.toc-sections a {
  display: block;
  padding: 6px 12px 6px 24px;
  text-decoration: none;
  color: var(--text-secondary);
  border-radius: 4px;
  font-size: 0.9em;
  transition: background 0.2s;
}

.toc-sections a:hover {
  background: var(--bg-hover);
  color: var(--text-primary);
}

/* Additional indentation for sections under child pages */
.toc-sections-indent-1 a {
  padding-left: 40px;
}

.toc-sections-indent-2 a {
  padding-left: 48px;
}

.toc-sections-indent-3 a {
  padding-left: 56px;
}

/* Table styling */
table {
  border-collapse: collapse;
  width: 100%;
  margin: 1em 0;
  border: 1px solid var(--border-color);
}

table th,
table td {
  padding: 8px 12px;
  text-align: left;
  border: 1px solid var(--border-color);
}

table thead th {
  background: var(--bg-active);
  color: var(--text-primary);
  font-weight: bold;
}

table tbody tr:nth-child(even) {
  background: var(--bg-secondary);
}

table tbody tr:nth-child(odd) {
  background: var(--bg-primary);
}

table tbody tr:hover {
  background: var(--bg-hover);
}

@media (max-width: 768px) {
  #toc-sidebar {
    position: static;
    width: 100%;
    height: auto;
    border-right: none;
    border-bottom: 1px solid #ddd;
  }

  #content-wrapper {
    margin-left: 0;
  }
}
</style>
<style>.search-modal {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  z-index: 9999;
  display: flex;
  align-items: flex-start;
  justify-content: center;
  padding-top: 10vh;
}

.search-backdrop {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.7);
}

.search-container {
  position: relative;
  width: 600px;
  max-width: 90%;
  background: var(--bg-primary);
  border-radius: 8px;
  box-shadow: 0 10px 50px rgba(0, 0, 0, 0.3);
  max-height: 70vh;
  display: flex;
  flex-direction: column;
  border: 1px solid var(--border-color);
}

.search-header {
  display: flex;
  align-items: center;
  padding: 16px;
  border-bottom: 1px solid var(--border-color);
}

#search-input {
  flex: 1;
  border: none;
  outline: none;
  font-size: 16px;
  padding: 8px;
  background: var(--bg-primary);
  color: var(--text-primary);
}

.search-close {
  border: none;
  background: none;
  font-size: 28px;
  cursor: pointer;
  color: var(--text-secondary);
  padding: 0 8px;
  line-height: 1;
}

.search-close:hover {
  color: var(--text-primary);
}

.search-results {
  overflow-y: auto;
  max-height: calc(70vh - 60px);
}

.search-hint {
  padding: 40px 20px;
  text-align: center;
  color: var(--text-tertiary);
}

.search-result {
  padding: 12px 16px;
  border-bottom: 1px solid var(--border-color);
  cursor: pointer;
  transition: background 0.15s;
}

.search-result:hover,
.search-result.selected {
  background: var(--bg-hover);
}

.search-result-title {
  font-weight: bold;
  color: var(--text-primary);
  margin-bottom: 4px;
}

.search-result-preview {
  font-size: 14px;
  color: var(--text-secondary);
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.search-highlight {
  background: var(--search-highlight);
  font-weight: bold;
}

.no-results {
  padding: 40px 20px;
  text-align: center;
  color: var(--text-tertiary);
}

@media (max-width: 768px) {
  .search-container {
    width: 95%;
  }
}
</style>

</head>
<body>
<nav id="toc-sidebar">
  <div class="toc-header"><h2>procon/</h2></div>
  <button id="search-button" class="search-button" title="Search (Ctrl+K)">
    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
      <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/>
    </svg>
    Search
  </button>
  <ul class="toc-list">
    <li class="toc-part toc-part-level-1">代数</li>
    <li class="toc-part toc-part-level-2">モノイド</li>
    <li>
      <a href="/procon/algebra.monoid.html" class="toc-page-child toc-page-indent-2">モノイドの定義</a>
    </li>
    <li>
      <a href="/procon/algebra.monoid.minmax.html" class="toc-page-child toc-page-indent-2">Min/Max モノイド</a>
    </li>
    <li>
      <a href="/procon/algebra.monoid.sum.html" class="toc-page-child toc-page-indent-2">Sum モノイド</a>
    </li>
    <li>
      <a href="/procon/algebra.group.html">(乗法)群と加法群</a>
    </li>
    <li>
      <a href="/procon/algebra.ring.html">環</a>
    </li>
    <li>
      <a href="/procon/algebra.field.html">体</a>
    </li>
    <li>
      <a href="/procon/algebra.module.html">加群</a>
    </li>
    <li>
      <a href="/procon/algebra.ratio.html">有理数</a>
    </li>
    <li>
      <a href="/procon/algebra.complex.html">虚数</a>
    </li>
    <li>
      <a href="/procon/algebra.matrix.html">行列</a>
    </li>
    <li>
      <a href="/procon/algebra.hyper.html" class="current">超数</a>
    </li>
    <li>
      <a href="/procon/algebra.float.html">Float</a>
    </li>
    <li>
      <a href="/procon/algebra.modint.html">ModInt</a>
    </li>
    <li class="toc-part toc-part-level-1">作用</li>
    <li>
      <a href="/procon/algebra.act.html" class="toc-page-child toc-page-indent-1">(モノイド)作用の定義</a>
    </li>
    <li>
      <a href="/procon/algebra.act.add.html" class="toc-page-child toc-page-indent-1">加算作用</a>
    </li>
    <li>
      <a href="/procon/algebra.act.assign.html" class="toc-page-child toc-page-indent-1">代入作用</a>
    </li>
  </ul>
</nav>
<div id="content-wrapper">
<div class="page-controls">
<button id="toc-toggle" class="toc-toggle" title="Toggle sidebar">
  <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
    <path d="M2 3h12a1 1 0 0 1 0 2H2a1 1 0 0 1 0-2zm0 4h12a1 1 0 0 1 0 2H2a1 1 0 0 1 0-2zm0 4h12a1 1 0 0 1 0 2H2a1 1 0 0 1 0-2z"/>
  </svg>
</button>
<div id="theme-switcher" class="theme-switcher">
  <button id="theme-button" class="theme-button" title="Change theme">
    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
      <path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"/>
    </svg>
    Theme
  </button>
  <div id="theme-menu" class="theme-menu" style="display: none;">
    <button class="theme-option" data-theme="light">Light</button>
    <button class="theme-option" data-theme="dark">Dark</button>
    <button class="theme-option" data-theme="solarized-light">Solarized Light</button>
    <button class="theme-option" data-theme="solarized-dark">Solarized Dark</button>
    <button class="theme-option" data-theme="kanagawa-light">Kanagawa Light</button>
    <button class="theme-option" data-theme="kanagawa-dark">Kanagawa Dark</button>
  </div>
</div>
</div>
<div id="search-modal" class="search-modal" style="display: none;">
  <div class="search-backdrop"></div>
  <div class="search-container">
    <div class="search-header">
      <input type="text" id="search-input" placeholder="Search documentation..." autocomplete="off">
      <button id="search-close" class="search-close">&times;</button>
    </div>
    <div id="search-results" class="search-results">
      <div class="search-hint">Start typing to search...</div>
    </div>
  </div>
</div>

<h1 class="title" id="1-%E4%BB%A3%E6%95%B0%20-%20%E8%B6%85%E6%95%B0">代数 - 超数</h1>
<p>全順序付き群（整数など）に \(\pm \infty\) を付加した数. 台数 <code>X</code> がモノイド/加法群/環の場合, <code>Hyper&lt;X&gt;</code> もそのように定義でき, 自動で演算を定義する.</p>
<pre><code class="code language-rust">&#x2F;&#x2F;&#x2F; Algebra - Hyper Numbers (numbers with infinity)
use crate::agroup; &#x2F;&#x2F; IGNORE
use crate::algebra::group_additive::*;
use crate::algebra::monoid::*;
use crate::algebra::ring::*;
use crate::monoid; &#x2F;&#x2F; IGNORE

#[derive(Debug, Clone, Copy, PartialEq, Eq, PartialOrd, Ord)]
pub enum Hyper&lt;X&gt; {
    NegInf,
    Real(X),
    Inf,
}
use Hyper::{Inf, NegInf, Real};
impl&lt;X&gt; Hyper&lt;X&gt; {
    pub fn unwrap(self) -&gt; X {
        if let Hyper::Real(x) = self {
            x
        } else {
            panic!(&quot;Could not unwrap Hyper&quot;)
        }
    }
}
agroup! {
    Hyper&lt;X&gt; where [X: AGroup];
    zero = Real(X::zero());
    add(self, other) = {
        match (self, other) {
            (Real(x), Real(y)) =&gt; Real(x + y),
            (Inf, _) =&gt; Inf,
            (_, Inf) =&gt; Inf,
            _ =&gt; NegInf,
        }
    };
    neg(self) = {
        match self {
            Inf =&gt; NegInf,
            NegInf =&gt; Inf,
            Real(x) =&gt; Real(-x),
        }
    };
}
monoid! {
    Hyper&lt;X&gt; where [X: Monoid];
    one = Real(X::one());
    mul(self, other) = {
        match (self, other) {
            (Real(x), Real(y)) =&gt; Real(x * y),
            (Inf, Inf) | (NegInf, NegInf) =&gt; Inf,
            _ =&gt; NegInf,
        }
    };
}
impl&lt;X: AGroup + Monoid&gt; Ring for Hyper&lt;X&gt; {}
impl&lt;X: std::ops::Add&lt;Output = X&gt;&gt; std::ops::Add&lt;X&gt; for Hyper&lt;X&gt; {
    type Output = Self;
    fn add(self, y: X) -&gt; Hyper&lt;X&gt; {
        match (self, y) {
            (Real(x), y) =&gt; Real(x + y),
            (Inf, _) =&gt; Inf,
            _ =&gt; NegInf,
        }
    }
}
impl&lt;X: Clone + AGroup&gt; std::ops::AddAssign&lt;X&gt; for Hyper&lt;X&gt; {
    fn add_assign(&amp;mut self, y: X) {
        *self = (*self).clone() + Real(y);
    }
}

#[cfg(test)]
mod test_hyper {
    use crate::algebra::hyper::*;
    #[test]
    fn it_works() {
        assert_eq!(Hyper::&lt;i64&gt;::zero(), Hyper::Real(0));
        assert_eq!(Hyper::Real(42).unwrap(), 42);
        assert!(Hyper::Real(0_i64) &lt; Hyper::Real(1));
        assert!(Hyper::NegInf &lt; Hyper::Real(1));
        assert!(Hyper::Real(0) &lt; Hyper::Inf);
        assert!(Hyper::&lt;i64&gt;::NegInf &lt; Hyper::Inf);
        assert_eq!(Hyper::Real(1) + 3, Hyper::Real(4));
    }
    #[test]
    fn assign_op() {
        {
            let mut a = Hyper::Real(0_i64);
            a += Hyper::Real(3);
            assert_eq!(a, Hyper::Real(3));
            a -= Hyper::Real(6);
            assert_eq!(a, Hyper::Real(-3));
            a += Hyper::Inf;
            assert_eq!(a, Hyper::Inf);
            a -= Hyper::Inf;
            assert_eq!(a, Hyper::Inf);
        }
    }

    #[test]
    #[should_panic]
    fn test_inf_cannot_unwrap() {
        Hyper::&lt;i64&gt;::Inf.unwrap();
    }

    #[test]
    #[should_panic]
    fn test_neginf_cannot_unwrap() {
        Hyper::&lt;i64&gt;::NegInf.unwrap();
    }
}
</code></pre>

<script>(function() {
  'use strict';

  const THEME_KEY = 'unibook-theme';
  let defaultTheme = 'light'; // Will be set from config

  // Get current theme (user preference or default)
  function getCurrentTheme() {
    return localStorage.getItem(THEME_KEY) || defaultTheme;
  }

  // Set theme
  function setTheme(theme) {
    document.documentElement.setAttribute('data-theme', theme);
    localStorage.setItem(THEME_KEY, theme);
    updateActiveButton(theme);
  }

  // Update active button styling
  function updateActiveButton(theme) {
    document.querySelectorAll('.theme-option').forEach(btn => {
      if (btn.dataset.theme === theme) {
        btn.classList.add('active');
      } else {
        btn.classList.remove('active');
      }
    });
  }

  // Initialize theme on page load
  function initTheme() {
    // Read default theme from meta tag (set by unibook config)
    const metaTheme = document.querySelector('meta[name="unibook-theme"]');
    if (metaTheme) {
      defaultTheme = metaTheme.content;
    }

    const theme = getCurrentTheme();
    setTheme(theme);
  }

  // Toggle theme menu
  function toggleThemeMenu() {
    const menu = document.getElementById('theme-menu');
    if (menu.style.display === 'none' || menu.style.display === '') {
      menu.style.display = 'block';
    } else {
      menu.style.display = 'none';
    }
  }

  // Close theme menu when clicking outside
  function handleOutsideClick(event) {
    const switcher = document.getElementById('theme-switcher');
    const menu = document.getElementById('theme-menu');

    if (switcher && !switcher.contains(event.target)) {
      menu.style.display = 'none';
    }
  }

  // Initialize on DOM ready
  document.addEventListener('DOMContentLoaded', function() {
    initTheme();

    // Theme button click handler
    const themeButton = document.getElementById('theme-button');
    if (themeButton) {
      themeButton.addEventListener('click', function(e) {
        e.stopPropagation();
        toggleThemeMenu();
      });
    }

    // Theme option click handlers
    document.querySelectorAll('.theme-option').forEach(button => {
      button.addEventListener('click', function() {
        const theme = this.dataset.theme;
        setTheme(theme);
        document.getElementById('theme-menu').style.display = 'none';
      });
    });

    // Close menu when clicking outside
    document.addEventListener('click', handleOutsideClick);
  });
})();
</script>
<script>(function() {
  'use strict';

  let searchIndex = null;
  let selectedIndex = -1;

  // Load search index
  async function loadSearchIndex() {
    if (searchIndex) return searchIndex;

    try {
      const response = await fetch('search-index.json');
      searchIndex = await response.json();
      return searchIndex;
    } catch (error) {
      console.error('Failed to load search index:', error);
      return null;
    }
  }

  // Open search modal
  function openSearch() {
    const modal = document.getElementById('search-modal');
    const input = document.getElementById('search-input');

    modal.style.display = 'flex';
    input.focus();
    input.value = '';
    selectedIndex = -1;
    showHint();

    // Load index if not already loaded
    loadSearchIndex();
  }

  // Close search modal
  function closeSearch() {
    const modal = document.getElementById('search-modal');
    modal.style.display = 'none';
  }

  // Show hint message
  function showHint() {
    const results = document.getElementById('search-results');
    results.innerHTML = '<div class="search-hint">Start typing to search...</div>';
  }

  // Perform search
  function performSearch(query) {
    if (!query || query.length < 2) {
      showHint();
      return;
    }

    if (!searchIndex) {
      const results = document.getElementById('search-results');
      results.innerHTML = '<div class="search-hint">Loading search index...</div>';
      return;
    }

    const lowerQuery = query.toLowerCase();
    const results = [];

    for (const page of searchIndex.pages) {
      const titleMatch = page.title.toLowerCase().includes(lowerQuery);
      const contentMatch = page.content.toLowerCase().includes(lowerQuery);

      if (titleMatch || contentMatch) {
        // Find context snippet
        const preview = extractPreview(page.content, lowerQuery);
        results.push({
          title: page.title,
          url: page.url,
          preview: preview,
        });
      }
    }

    displayResults(results, query);
  }

  // Extract preview snippet around search term
  function extractPreview(content, query) {
    const index = content.toLowerCase().indexOf(query.toLowerCase());
    if (index === -1) return content.substring(0, 100) + '...';

    const start = Math.max(0, index - 40);
    const end = Math.min(content.length, index + query.length + 60);

    let preview = content.substring(start, end);
    if (start > 0) preview = '...' + preview;
    if (end < content.length) preview = preview + '...';

    return preview;
  }

  // Highlight search terms in text
  function highlightText(text, query) {
    const regex = new RegExp('(' + escapeRegex(query) + ')', 'gi');
    return text.replace(regex, '<span class="search-highlight">$1</span>');
  }

  function escapeRegex(str) {
    return str.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
  }

  // Display search results
  function displayResults(results, query) {
    const container = document.getElementById('search-results');
    selectedIndex = -1;

    if (results.length === 0) {
      container.innerHTML = '<div class="no-results">No results found</div>';
      return;
    }

    const html = results.map((result, index) => `
      <div class="search-result" data-index="${index}" data-url="${result.url}">
        <div class="search-result-title">${highlightText(result.title, query)}</div>
        <div class="search-result-preview">${highlightText(result.preview, query)}</div>
      </div>
    `).join('');

    container.innerHTML = html;

    // Add click handlers
    const resultElements = container.querySelectorAll('.search-result');
    resultElements.forEach((el) => {
      el.addEventListener('click', () => {
        window.location.href = el.dataset.url;
      });
    });
  }

  // Handle keyboard navigation
  function handleKeyDown(event) {
    const results = document.querySelectorAll('.search-result');

    if (event.key === 'ArrowDown') {
      event.preventDefault();
      selectedIndex = Math.min(selectedIndex + 1, results.length - 1);
      updateSelection(results);
    } else if (event.key === 'ArrowUp') {
      event.preventDefault();
      selectedIndex = Math.max(selectedIndex - 1, -1);
      updateSelection(results);
    } else if (event.key === 'Enter' && selectedIndex >= 0 && results[selectedIndex]) {
      event.preventDefault();
      window.location.href = results[selectedIndex].dataset.url;
    } else if (event.key === 'Escape') {
      event.preventDefault();
      closeSearch();
    }
  }

  // Update visual selection
  function updateSelection(results) {
    results.forEach((el, index) => {
      if (index === selectedIndex) {
        el.classList.add('selected');
        el.scrollIntoView({ block: 'nearest', behavior: 'smooth' });
      } else {
        el.classList.remove('selected');
      }
    });
  }

  // Initialize search functionality
  document.addEventListener('DOMContentLoaded', function() {
    // Global keyboard shortcut
    document.addEventListener('keydown', function(event) {
      // Ctrl+K or Cmd+K
      if ((event.ctrlKey || event.metaKey) && event.key === 'k') {
        event.preventDefault();
        openSearch();
      }
    });

    // Search button in sidebar
    const searchButton = document.getElementById('search-button');
    if (searchButton) {
      searchButton.addEventListener('click', function() {
        openSearch();
      });
    }

    // Search input handler
    const searchInput = document.getElementById('search-input');
    if (searchInput) {
      searchInput.addEventListener('input', function(event) {
        performSearch(event.target.value);
      });

      searchInput.addEventListener('keydown', handleKeyDown);
    }

    // Close button
    const closeButton = document.getElementById('search-close');
    if (closeButton) {
      closeButton.addEventListener('click', closeSearch);
    }

    // Close on backdrop click
    const backdrop = document.querySelector('.search-backdrop');
    if (backdrop) {
      backdrop.addEventListener('click', closeSearch);
    }
  });
})();
</script>
<script>(function() {
  'use strict';

  const toggleButton = document.getElementById('toc-toggle');
  const STORAGE_KEY = 'unibook-sidebar-hidden';

  // Initialize sidebar state from localStorage
  function initializeSidebar() {
    const isHidden = localStorage.getItem(STORAGE_KEY) === 'true';
    if (isHidden) {
      document.body.classList.add('sidebar-hidden');
    }
  }

  // Toggle sidebar visibility
  function toggleSidebar() {
    const isHidden = document.body.classList.toggle('sidebar-hidden');
    localStorage.setItem(STORAGE_KEY, isHidden.toString());
  }

  // Set up event listener
  if (toggleButton) {
    toggleButton.addEventListener('click', toggleSidebar);
  }

  // Initialize on page load
  initializeSidebar();
})();
</script>
<script>// Add copy buttons to all code blocks
document.addEventListener('DOMContentLoaded', () => {
    // Find all pre > code blocks
    const codeBlocks = document.querySelectorAll('pre > code');

    codeBlocks.forEach((codeBlock) => {
        const pre = codeBlock.parentElement;

        // Create wrapper div
        const wrapper = document.createElement('div');
        wrapper.className = 'code-block-wrapper';

        // Create copy button
        const copyButton = document.createElement('button');
        copyButton.className = 'code-copy-button';
        copyButton.innerHTML = `
            <svg class="copy-icon" width="16" height="16" viewBox="0 0 16 16" fill="none">
                <path d="M4 2h8a2 2 0 0 1 2 2v8M4 6H2a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-2"
                      stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
            </svg>
            <span class="copy-text">Copy</span>
        `;
        copyButton.title = 'Copy code to clipboard';

        // Add click handler
        copyButton.addEventListener('click', async () => {
            const code = codeBlock.textContent;

            try {
                await navigator.clipboard.writeText(code);

                // Show success feedback
                copyButton.classList.add('success');
                copyButton.innerHTML = `
                    <svg class="check-icon" width="16" height="16" viewBox="0 0 16 16" fill="none">
                        <path d="M3 8l3 3 7-7" stroke="currentColor" stroke-width="2"
                              stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <span class="copy-text">Copied!</span>
                `;

                // Reset after 2 seconds
                setTimeout(() => {
                    copyButton.classList.remove('success');
                    copyButton.innerHTML = `
                        <svg class="copy-icon" width="16" height="16" viewBox="0 0 16 16" fill="none">
                            <path d="M4 2h8a2 2 0 0 1 2 2v8M4 6H2a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-2"
                                  stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                        </svg>
                        <span class="copy-text">Copy</span>
                    `;
                }, 2000);
            } catch (err) {
                // Show error feedback
                copyButton.classList.add('error');
                copyButton.innerHTML = `
                    <svg class="error-icon" width="16" height="16" viewBox="0 0 16 16" fill="none">
                        <path d="M8 1l7 14H1L8 1z" stroke="currentColor" stroke-width="1.5"
                              stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M8 6v4M8 12v.5" stroke="currentColor" stroke-width="1.5"
                              stroke-linecap="round"/>
                    </svg>
                    <span class="copy-text">Failed</span>
                `;

                // Reset after 2 seconds
                setTimeout(() => {
                    copyButton.classList.remove('error');
                    copyButton.innerHTML = `
                        <svg class="copy-icon" width="16" height="16" viewBox="0 0 16 16" fill="none">
                            <path d="M4 2h8a2 2 0 0 1 2 2v8M4 6H2a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-2"
                                  stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                        </svg>
                        <span class="copy-text">Copy</span>
                    `;
                }, 2000);
            }
        });

        // Wrap the pre element
        pre.parentNode.insertBefore(wrapper, pre);
        wrapper.appendChild(pre);
        wrapper.appendChild(copyButton);
    });
});
</script>
<script>// Prism highlight retry script
// Fixes timing issues by re-running highlight after all resources are loaded
// This script is placed before Prism loads, so we use 'load' event instead of 'DOMContentLoaded'
window.addEventListener('load', () => {
    // Wait 100ms after page load to ensure Prism has initialized and all elements are ready
    setTimeout(() => {
        if (typeof Prism !== 'undefined') {
            Prism.highlightAll();
        }
    }, 100);
});
</script>
</div> <!-- content-wrapper -->

  <script src="https://cympfh.cc/resources/js/youtube.js"></script>
  <script src="https://unpkg.com/prismjs@v1.x/components/prism-core.min.js"></script>
  <script src="https://unpkg.com/prismjs@v1.x/plugins/autoloader/prism-autoloader.min.js"></script>
</body>
</html>