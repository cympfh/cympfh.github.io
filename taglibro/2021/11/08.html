<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ja" xml:lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="description" content="Para 圏" />
  <meta name="og:url" content="http://cympfh.cc/taglibro">
  <meta name="og:title" content="Mon Nov 08 2021" />
  <meta name="og:description" content="Para 圏" />
  <meta name="og:image" content="http://cympfh.cc/resources/img/identicon.png" />
  <meta property="og:url" content="http://cympfh.cc/taglibro">
  <meta property="og:title" content="Mon Nov 08 2021" />
  <meta property="og:description" content="Para 圏" />
  <meta property="og:image" content="http://cympfh.cc/resources/img/identicon.png" />
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@cympfh" />
  <meta name="generator" content="unidoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Mon Nov 08 2021</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
  </style>
  <link rel="stylesheet" href="../../resources/css/c.css" />
  <link rel="stylesheet" href="../../../resources/css/c.css" />
  <link rel="stylesheet" href="../../../resources/css/youtube.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css" />
  <link href="https://unpkg.com/prismjs@1.x.0/themes/prism.css" rel="stylesheet" />
  <script id="MathJax-script" async src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>
  <div class="taglibro">
    <header class="page-header"><a href='../../index.html'><i class="fas fa-fast-backward"></i></a></header>
<h1 class="title">Mon Nov 08 2021</h1>
\[
\require{amscd}
\]
<p>参考文献;</p>
<ul>
  <li><a href="https://arxiv.org/abs/2106.07032">Category Theory in Machine Learning</a></li>
  <li><a href="https://arxiv.org/abs/2103.01931">Categorical Foundations of Gradient-Based Learning</a></li>
</ul>
<h2>Para 圏</h2>
<p>機械学習における予測器のようなものは一種の写像と見なせて, 「画像分類器」なら, 画像の集合 \(A\) からラベルの集合 \(B\) への写像</p>
\[f \colon A \to B\]
<p>と思える. これを射とする圏を \(\mathcal C\) とする. ただし適当な \((I, \otimes)\) によってモノイダル圏になってるとする.</p>
<p>さて, 機械学習においては直接扱うのはパラメータも入力とする</p>
\[f \colon P \otimes A \to B\]
<p>という形式であることが普通だ. 例えば線形回帰なら（簡単のためにバイアスを除いてるが）,</p>
\[f \colon P \times A \to B ~~ \text{ where } P=A=\mathbb R^n, B=\mathbb R\]
\[f \colon (\theta, x) = \langle \theta, x \rangle\]
<p>と記述される（右辺は内積）. モデルを「学習する」とは都合の良い \(\theta\) を見つける操作のことであり, これを固定した「学習済み」の予測器になって初めて,</p>
\[f_\theta \colon A \to B\]
<p>と書くことが出来る.</p>
<p>圏 \(\mathcal C\) における対象 \(A,B,\ldots\) をそのまま対象として, 圏 \(\mathcal C\) における射（写像） \(f \colon P \otimes A \to B\) に対応して, \((P,f) \colon A \to B\) を射として持つような圏を, \(\mathcal C\) をパラメタライズした圏 \(Para(\mathcal C)\) と呼ぶ.</p>
<h3>合成</h3>
<p>Para 圏での2つの射 \((P,f) \colon A \to B\) と \((Q,g) \colon B \to C\) の合成を考える. 元の圏に戻すと,</p>
\[f \colon P \otimes A \to B ,~ g \colon Q \otimes B \to C\]
<p>ここから</p>
\[\_ \otimes A \to C\]
<p>を作りたい. 適当に型を合わせれば自然に決まって,</p>
\[1_Q \otimes f ~\colon~ Q \otimes P \otimes A \to Q \otimes B\]
<p>これに \(g\) を合成して,</p>
\[(1_Q \otimes f) ; g ~\colon~ Q \otimes P \otimes A \to C\]
<p>が元の圏で得られる. これは Para 圏では,</p>
\[(Q \otimes P, (1_Q \otimes f) ; g) ~\colon~ A \to C\]
<p>となる. というわけで,</p>
\[(P,f) ; (Q,g) := (Q \otimes P, (1_Q \otimes f) ; g)\]
<p>とすればよい.</p>
<p><img src="https://i.imgur.com/SnfVHpZ.png" alt="" /></p>
<h3>自然変換</h3>
<p>2つの射</p>
<ul>
  <li>\((P, f) \colon A \to B\)</li>
  <li>\((P&#x27;, f) \colon A&#x27; \to B\)</li>
</ul>
<p>があるときにこの間の自然変換とは, もとの圏での射</p>
\[r \colon P \to P&#x27;\]
<p>であって,</p>
\[f = f&#x27; ; (r \otimes 1_A)\]
<p>となるようなもの.</p>
\[
\begin{CD}
P \times A @&gt;r \times 1&gt;&gt; P&#x27; \times A \\
@VVV @VVV \\
B @= B
\end{CD}
\]
<p>この \(r\) をパラメータ変換 (re-parameterization) と呼ぶ.</p>

    <footer>
      <p class="is-pulled-right">@cympfh / mail@cympfh.cc</p>
    </footer>
  </div>
  <script src="../../../resources/js/youtube.js"></script>
  <script src="https://unpkg.com/prismjs@v1.x/components/prism-core.min.js"></script>
  <script src="https://unpkg.com/prismjs@v1.x/plugins/autoloader/prism-autoloader.min.js"></script>
  <script src="../../../resources/js/toc.js"></script>
</body>
</html>
